2022-05-16 22:43:59 - utils.py[line:263] - INFO: distributed init (rank 0): env://
2022-05-16 22:43:59 - utils.py[line:269] - INFO: Start init
2022-05-16 22:43:59 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2022-05-16 22:43:59 - utils.py[line:279] - INFO: initialized host heming-ng1 as rank 0
single-machine distributed training is initialized.
2022-05-16 22:44:01 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../ofa_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 8, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 2000, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 8, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 2, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [2e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5', 'restore_file': '../../checkpoints/ofa_base.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'cider', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': None}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='ofa_moe_base', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, alternate_ffn_embed_dim=0, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='ofa_moe_base', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=8, batch_size_valid=8, best_checkpoint_metric='cider', bf16=False, block_wise=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=0.0, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_moe_cross_entropy', cross_self_attention=False, curriculum=0, data='../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_moe_freq=0, decoder_normalize_before=True, decoder_output_dim=768, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=1, distributed_port=-1, distributed_rank=0, distributed_world_size=1, drop_worst_after=2500, drop_worst_ratio=0.2, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_moe_freq=6, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_args='{"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', eval_bleu=False, eval_cider=True, eval_cider_cached_tokens='../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=True, freeze_encoder_embedding=True, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, log_nvidia_smi=False, lr=[2e-05], lr_scheduler='polynomial_decay', max_epoch=2, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=20, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, moe_eval_capacity_token_fraction=0.25, moe_expert_count=4, moe_expert_ffn_dim=0, moe_freq=0, moe_gate_loss_combine_method='average', moe_gate_loss_transform='none', moe_gate_loss_wt=1.0, moe_gating_use_fp32=True, moe_normalize_expert_grad='', moe_normalize_gate_prob_before_dropping=True, moe_second_expert_policy='all', moe_top1_expert=True, no_best_checkpoints=False, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_save_optimizer_state_on_training_finished=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=1, num_bins=1000, num_shards=1, num_workers=0, num_workers_valid=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patch_image_size=480, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, resnet_type='resnet101', restore_file='../../checkpoints/ofa_base.pt', s3_upload_path=None, sample_patch_num=196, save_dir='./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5', save_interval=1, save_interval_updates=2000, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,4,2', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, symlink_best_and_last_checkpoints=False, sync_bn=False, task='caption', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_moe_pad_mask=True, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../ofa_module', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=2000, wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'caption', 'data': '../../dataset/caption_data/caption_stage1_train.tsv,../../dataset/caption_data/caption_val.tsv', 'selected_cols': '0,4,2', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 20, 'code_dict_size': 8192, 'patch_image_size': 480, 'num_bins': 1000, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_bleu': False, 'eval_cider': True, 'eval_args': '{"beam":1,"max_len_b":16,"no_repeat_ngram_size":3}', 'eval_print_samples': False, 'eval_cider_cached_tokens': '../../dataset/caption_data/cider_cached_tokens/coco-valid-words.p', 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_moe_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.2, 'drop_worst_after': 2500, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None, 'moe_gate_loss_wt': 1.0, 'moe_gate_loss_combine_method': 'average', 'moe_gate_loss_transform': 'none'}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [2e-05], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [2e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2022-05-16 22:44:01 - ofa_task.py[line:103] - INFO: source dictionary: 59457 types
2022-05-16 22:44:01 - ofa_task.py[line:104] - INFO: target dictionary: 59457 types
2022-05-16 22:44:03 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2022-05-16 22:44:03 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:3 to store for rank: 0
2022-05-16 22:44:03 - distributed_c10d.py[line:187] - INFO: Added key: store_based_barrier_key:4 to store for rank: 0
2022-05-16 22:44:06 - train.py[line:108] - INFO: OFAModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): ResNet(
      (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
      (layer1): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer2): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
      (layer3): Sequential(
        (0): Bottleneck(
          (conv1): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (downsample): Sequential(
            (0): Conv2d(512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
          (drop_path): Identity()
        )
        (1): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (2): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (3): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (4): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (5): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (6): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (7): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (8): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (9): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (10): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (11): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (12): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (13): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (14): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (15): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (16): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (17): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (18): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (19): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (20): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (21): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
        (22): Bottleneck(
          (conv1): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (conv3): Conv2d(256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (bn3): BatchNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (drop_path): Identity()
        )
      )
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (moe_layer): MOELayer(
          (gate): Top1Gate(
            (wg): Linear(in_features=768, out_features=4, bias=False)
          )
          (experts): ModuleList(
            (0): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (1): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (2): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
            (3): FeedForwardNetwork(
              (activation_dropout_module): FairseqDropout()
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (dropout_module): FairseqDropout()
            )
          )
        )
        (attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(59457, 768, padding_idx=1)
    (layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): FusedLayerNorm(torch.Size([3072]), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=768, out_features=59457, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2022-05-16 22:44:06 - train.py[line:109] - INFO: task: CaptionTask
2022-05-16 22:44:06 - train.py[line:110] - INFO: model: OFAModel
2022-05-16 22:44:06 - train.py[line:111] - INFO: criterion: AdjustLabelSmoothedMOECrossEntropyCriterion
2022-05-16 22:44:06 - train.py[line:112] - INFO: num. shared model params: 177,519,176 (num. trained: 131,856,200)
2022-05-16 22:44:06 - train.py[line:119] - INFO: num. expert model params: 18889728 (num. trained: 18889728)
local datafile ../../dataset/caption_data/caption_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_val.tsv slice_id 0 row count 5000 total row count 5000
/opt/conda/lib/python3.8/site-packages/torchvision/transforms/transforms.py:257: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.output_projection.weight
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.0.downsample.0.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.1.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer1.2.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.0.downsample.0.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.1.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.2.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer2.3.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.0.downsample.0.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.1.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.2.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.3.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.4.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.5.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.6.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.7.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.8.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.9.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.10.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.11.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.12.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.13.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.14.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.15.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.16.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.17.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.18.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.19.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.20.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.21.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv1.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv2.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.embed_images.layer3.22.conv3.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- encoder.layers.5.moe_layer.gate.wg.bias
2022-05-16 22:44:08 - trainer.py[line:129] - INFO: detected shared parameter: encoder.embed_images.conv1.bias <- decoder.output_projection.bias
2022-05-16 22:44:08 - utils.py[line:779] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-05-16 22:44:08 - utils.py[line:781] - INFO: rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2022-05-16 22:44:08 - utils.py[line:787] - INFO: ***********************CUDA enviroments for all 1 workers***********************
2022-05-16 22:44:08 - train.py[line:150] - INFO: training on 1 devices (GPUs/TPUs)
2022-05-16 22:44:08 - train.py[line:155] - INFO: max tokens per device = None and max sentences per device = 8
2022-05-16 22:44:08 - trainer.py[line:477] - INFO: Preparing to load checkpoint ../../checkpoints/ofa_base.pt
2022-05-16 22:44:10 - adam.py[line:70] - INFO: using FusedAdam
2022-05-16 22:44:10 - trainer.py[line:636] - INFO: Loaded checkpoint ../../checkpoints/ofa_base.pt (epoch 48 @ 0 updates)
2022-05-16 22:44:10 - trainer.py[line:658] - INFO: loading train data for epoch 1
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
slice_id 0 seek offset 0
Total steps 17712, warmup steps 1062, warmup_factor 0.0009416195856873823
2022-05-16 22:44:36 - trainer.py[line:722] - INFO: begin training epoch 1
2022-05-16 22:44:36 - train.py[line:303] - INFO: Start iterating over samples
2022-05-16 22:44:48 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-16 22:44:52 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-16 22:44:56 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-16 22:45:37 - progress_bar.py[line:272] - INFO: epoch 001:     13 / 8856 loss=5.132, loss_v1=0, loss_v2=0, nll_loss=1.961, ntokens=763.4, nsentences=64, sample_size=763.4, inner_loss=4.069, moe_gate_loss=1.063, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=53.59, expert1_balance_bottom=7.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=187.1, ups=0.25, wpb=763.4, bsz=64, num_updates=10, lr=1.88324e-07, gnorm=9.578, loss_scale=16, train_wall=52, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=90
2022-05-16 22:46:35 - progress_bar.py[line:272] - INFO: epoch 001:     23 / 8856 loss=5.167, loss_v1=0, loss_v2=0, nll_loss=2.022, ntokens=748.7, nsentences=64, sample_size=748.7, inner_loss=4.111, moe_gate_loss=1.056, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=52.666, expert1_balance_bottom=8.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.06, wps=130.4, ups=0.17, wpb=748.7, bsz=64, num_updates=20, lr=3.76648e-07, gnorm=11.109, loss_scale=16, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=147
2022-05-16 22:47:58 - progress_bar.py[line:272] - INFO: epoch 001:     33 / 8856 loss=5.103, loss_v1=0, loss_v2=0, nll_loss=1.931, ntokens=775.1, nsentences=64, sample_size=775.1, inner_loss=4.043, moe_gate_loss=1.06, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=52.774, expert1_balance_bottom=7.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=93.4, ups=0.12, wpb=775.1, bsz=64, num_updates=30, lr=5.64972e-07, gnorm=9.276, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=230
2022-05-16 22:49:21 - progress_bar.py[line:272] - INFO: epoch 001:     43 / 8856 loss=5.197, loss_v1=0, loss_v2=0, nll_loss=2.063, ntokens=757.5, nsentences=64, sample_size=757.5, inner_loss=4.144, moe_gate_loss=1.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=50.641, expert1_balance_bottom=8.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.18, wps=90.4, ups=0.12, wpb=757.5, bsz=64, num_updates=40, lr=7.53296e-07, gnorm=9.293, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=314
2022-05-16 22:50:47 - progress_bar.py[line:272] - INFO: epoch 001:     53 / 8856 loss=5.045, loss_v1=0, loss_v2=0, nll_loss=1.891, ntokens=766.6, nsentences=64, sample_size=766.6, inner_loss=3.988, moe_gate_loss=1.058, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.374, expert1_balance_top=52.349, expert1_balance_bottom=7.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=89.1, ups=0.12, wpb=766.6, bsz=64, num_updates=50, lr=9.4162e-07, gnorm=8.899, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=400
2022-05-16 22:52:14 - progress_bar.py[line:272] - INFO: epoch 001:     63 / 8856 loss=5.118, loss_v1=0, loss_v2=0, nll_loss=2.004, ntokens=776.9, nsentences=64, sample_size=776.9, inner_loss=4.066, moe_gate_loss=1.052, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=51.569, expert1_balance_bottom=8.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.01, wps=89.7, ups=0.12, wpb=776.9, bsz=64, num_updates=60, lr=1.12994e-06, gnorm=9.56, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=487
2022-05-16 22:53:40 - progress_bar.py[line:272] - INFO: epoch 001:     73 / 8856 loss=5.004, loss_v1=0, loss_v2=0, nll_loss=1.913, ntokens=767.9, nsentences=64, sample_size=767.9, inner_loss=3.959, moe_gate_loss=1.046, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.375, expert1_balance_top=48.87, expert1_balance_bottom=10.091, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=89.4, ups=0.12, wpb=767.9, bsz=64, num_updates=70, lr=1.31827e-06, gnorm=7.736, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=572
2022-05-16 22:55:05 - progress_bar.py[line:272] - INFO: epoch 001:     83 / 8856 loss=4.923, loss_v1=0, loss_v2=0, nll_loss=1.879, ntokens=752.5, nsentences=64, sample_size=752.5, inner_loss=3.887, moe_gate_loss=1.036, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=46.015, expert1_balance_bottom=10.644, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=88.2, ups=0.12, wpb=752.5, bsz=64, num_updates=80, lr=1.50659e-06, gnorm=8.618, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=658
2022-05-16 22:56:21 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2022-05-16 22:56:39 - progress_bar.py[line:272] - INFO: epoch 001:     94 / 8856 loss=4.898, loss_v1=0, loss_v2=0, nll_loss=1.889, ntokens=761.6, nsentences=64, sample_size=761.6, inner_loss=3.866, moe_gate_loss=1.032, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=44.381, expert1_balance_bottom=11.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=81.6, ups=0.11, wpb=761.6, bsz=64, num_updates=90, lr=1.69492e-06, gnorm=7.777, loss_scale=8, train_wall=39, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=751
2022-05-16 22:58:05 - progress_bar.py[line:272] - INFO: epoch 001:    104 / 8856 loss=4.863, loss_v1=0, loss_v2=0, nll_loss=1.887, ntokens=762.5, nsentences=64, sample_size=762.5, inner_loss=3.836, moe_gate_loss=1.027, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.376, expert1_balance_top=42.84, expert1_balance_bottom=12.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=88.8, ups=0.12, wpb=762.5, bsz=64, num_updates=100, lr=1.88324e-06, gnorm=6.855, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=837
2022-05-16 22:59:31 - progress_bar.py[line:272] - INFO: epoch 001:    114 / 8856 loss=4.757, loss_v1=0, loss_v2=0, nll_loss=1.823, ntokens=759.2, nsentences=64, sample_size=759.2, inner_loss=3.736, moe_gate_loss=1.021, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=40.172, expert1_balance_bottom=13.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.54, wps=87.7, ups=0.12, wpb=759.2, bsz=64, num_updates=110, lr=2.07156e-06, gnorm=8.148, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=924
2022-05-16 23:00:56 - progress_bar.py[line:272] - INFO: epoch 001:    124 / 8856 loss=4.718, loss_v1=0, loss_v2=0, nll_loss=1.825, ntokens=771, nsentences=64, sample_size=771, inner_loss=3.698, moe_gate_loss=1.02, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=40.544, expert1_balance_bottom=13.883, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.54, wps=90.5, ups=0.12, wpb=771, bsz=64, num_updates=120, lr=2.25989e-06, gnorm=5.89, loss_scale=8, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=1009
2022-05-16 23:02:22 - progress_bar.py[line:272] - INFO: epoch 001:    134 / 8856 loss=4.771, loss_v1=0, loss_v2=0, nll_loss=1.947, ntokens=760.2, nsentences=64, sample_size=760.2, inner_loss=3.758, moe_gate_loss=1.014, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.456, expert1_balance_bottom=15.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=88.7, ups=0.12, wpb=760.2, bsz=64, num_updates=130, lr=2.44821e-06, gnorm=5.698, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1095
2022-05-16 23:03:46 - progress_bar.py[line:272] - INFO: epoch 001:    144 / 8856 loss=4.744, loss_v1=0, loss_v2=0, nll_loss=1.953, ntokens=753.3, nsentences=64, sample_size=753.3, inner_loss=3.731, moe_gate_loss=1.013, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.423, expert1_balance_bottom=14.913, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=89.7, ups=0.12, wpb=753.3, bsz=64, num_updates=140, lr=2.63653e-06, gnorm=5.508, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1179
2022-05-16 23:05:12 - progress_bar.py[line:272] - INFO: epoch 001:    154 / 8856 loss=4.709, loss_v1=0, loss_v2=0, nll_loss=1.966, ntokens=765.5, nsentences=64, sample_size=765.5, inner_loss=3.697, moe_gate_loss=1.012, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=36.701, expert1_balance_bottom=15.902, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=89.4, ups=0.12, wpb=765.5, bsz=64, num_updates=150, lr=2.82486e-06, gnorm=5.257, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1264
2022-05-16 23:06:37 - progress_bar.py[line:272] - INFO: epoch 001:    164 / 8856 loss=4.641, loss_v1=0, loss_v2=0, nll_loss=1.948, ntokens=773.8, nsentences=64, sample_size=773.8, inner_loss=3.633, moe_gate_loss=1.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=34.382, expert1_balance_bottom=16.63, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=90.4, ups=0.12, wpb=773.8, bsz=64, num_updates=160, lr=3.01318e-06, gnorm=4.555, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1350
2022-05-16 23:08:01 - progress_bar.py[line:272] - INFO: epoch 001:    174 / 8856 loss=4.609, loss_v1=0, loss_v2=0, nll_loss=1.957, ntokens=763, nsentences=64, sample_size=763, inner_loss=3.602, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.384, expert1_balance_bottom=17.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=91.2, ups=0.12, wpb=763, bsz=64, num_updates=170, lr=3.20151e-06, gnorm=4.53, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1433
2022-05-16 23:09:28 - progress_bar.py[line:272] - INFO: epoch 001:    184 / 8856 loss=4.512, loss_v1=0, loss_v2=0, nll_loss=1.895, ntokens=764.3, nsentences=64, sample_size=764.3, inner_loss=3.505, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.348, expert1_balance_bottom=17.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=88.2, ups=0.12, wpb=764.3, bsz=64, num_updates=180, lr=3.38983e-06, gnorm=3.794, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1520
2022-05-16 23:10:55 - progress_bar.py[line:272] - INFO: epoch 001:    194 / 8856 loss=4.502, loss_v1=0, loss_v2=0, nll_loss=1.921, ntokens=759.2, nsentences=64, sample_size=759.2, inner_loss=3.493, moe_gate_loss=1.009, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.377, expert1_balance_top=34.524, expert1_balance_bottom=16.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=87.3, ups=0.12, wpb=759.2, bsz=64, num_updates=190, lr=3.57815e-06, gnorm=3.793, loss_scale=8, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1607
2022-05-16 23:12:19 - progress_bar.py[line:272] - INFO: epoch 001:    204 / 8856 loss=4.524, loss_v1=0, loss_v2=0, nll_loss=1.996, ntokens=761.9, nsentences=64, sample_size=761.9, inner_loss=3.517, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33, expert1_balance_bottom=17.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=90.7, ups=0.12, wpb=761.9, bsz=64, num_updates=200, lr=3.76648e-06, gnorm=3.53, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1691
2022-05-16 23:13:44 - progress_bar.py[line:272] - INFO: epoch 001:    214 / 8856 loss=4.439, loss_v1=0, loss_v2=0, nll_loss=1.92, ntokens=768.6, nsentences=64, sample_size=768.6, inner_loss=3.431, moe_gate_loss=1.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=34.541, expert1_balance_bottom=17.06, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=89.7, ups=0.12, wpb=768.6, bsz=64, num_updates=210, lr=3.9548e-06, gnorm=4.775, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1777
2022-05-16 23:15:08 - progress_bar.py[line:272] - INFO: epoch 001:    224 / 8856 loss=4.435, loss_v1=0, loss_v2=0, nll_loss=1.949, ntokens=758.5, nsentences=64, sample_size=758.5, inner_loss=3.427, moe_gate_loss=1.008, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.657, expert1_balance_bottom=17.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=90.3, ups=0.12, wpb=758.5, bsz=64, num_updates=220, lr=4.14313e-06, gnorm=3.47, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1861
2022-05-16 23:16:33 - progress_bar.py[line:272] - INFO: epoch 001:    234 / 8856 loss=4.405, loss_v1=0, loss_v2=0, nll_loss=1.948, ntokens=773.9, nsentences=64, sample_size=773.9, inner_loss=3.4, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.722, expert1_balance_bottom=17.826, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=91.4, ups=0.12, wpb=773.9, bsz=64, num_updates=230, lr=4.33145e-06, gnorm=3.582, loss_scale=8, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=1945
2022-05-16 23:17:59 - progress_bar.py[line:272] - INFO: epoch 001:    244 / 8856 loss=4.414, loss_v1=0, loss_v2=0, nll_loss=1.973, ntokens=776.5, nsentences=64, sample_size=776.5, inner_loss=3.407, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.407, expert1_balance_bottom=17.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=90.4, ups=0.12, wpb=776.5, bsz=64, num_updates=240, lr=4.51977e-06, gnorm=4.517, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2031
2022-05-16 23:19:24 - progress_bar.py[line:272] - INFO: epoch 001:    254 / 8856 loss=4.428, loss_v1=0, loss_v2=0, nll_loss=2.007, ntokens=767.9, nsentences=64, sample_size=767.9, inner_loss=3.421, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.923, expert1_balance_bottom=17.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.02, wps=89.8, ups=0.12, wpb=767.9, bsz=64, num_updates=250, lr=4.7081e-06, gnorm=3.648, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2117
2022-05-16 23:20:50 - progress_bar.py[line:272] - INFO: epoch 001:    264 / 8856 loss=4.401, loss_v1=0, loss_v2=0, nll_loss=1.998, ntokens=751.1, nsentences=64, sample_size=751.1, inner_loss=3.394, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.163, expert1_balance_bottom=17.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.99, wps=87.7, ups=0.12, wpb=751.1, bsz=64, num_updates=260, lr=4.89642e-06, gnorm=4.509, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2202
2022-05-16 23:22:15 - progress_bar.py[line:272] - INFO: epoch 001:    274 / 8856 loss=4.38, loss_v1=0, loss_v2=0, nll_loss=2, ntokens=766.3, nsentences=64, sample_size=766.3, inner_loss=3.373, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.197, expert1_balance_bottom=17.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4, wps=90.2, ups=0.12, wpb=766.3, bsz=64, num_updates=270, lr=5.08475e-06, gnorm=3.076, loss_scale=8, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2287
2022-05-16 23:23:40 - progress_bar.py[line:272] - INFO: epoch 001:    284 / 8856 loss=4.352, loss_v1=0, loss_v2=0, nll_loss=1.978, ntokens=758, nsentences=64, sample_size=758, inner_loss=3.346, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.549, expert1_balance_bottom=17.937, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=89, ups=0.12, wpb=758, bsz=64, num_updates=280, lr=5.27307e-06, gnorm=5.75, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2373
2022-05-16 23:25:05 - progress_bar.py[line:272] - INFO: epoch 001:    294 / 8856 loss=4.35, loss_v1=0, loss_v2=0, nll_loss=1.983, ntokens=765.9, nsentences=64, sample_size=765.9, inner_loss=3.345, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.844, expert1_balance_bottom=17.801, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.95, wps=90, ups=0.12, wpb=765.9, bsz=64, num_updates=290, lr=5.46139e-06, gnorm=3.324, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2458
2022-05-16 23:26:30 - progress_bar.py[line:272] - INFO: epoch 001:    304 / 8856 loss=4.329, loss_v1=0, loss_v2=0, nll_loss=1.979, ntokens=762.8, nsentences=64, sample_size=762.8, inner_loss=3.323, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.841, expert1_balance_bottom=17.835, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=89.5, ups=0.12, wpb=762.8, bsz=64, num_updates=300, lr=5.64972e-06, gnorm=3.477, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2543
2022-05-16 23:27:56 - progress_bar.py[line:272] - INFO: epoch 001:    314 / 8856 loss=4.285, loss_v1=0, loss_v2=0, nll_loss=1.94, ntokens=768.4, nsentences=64, sample_size=768.4, inner_loss=3.279, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.151, expert1_balance_bottom=17.876, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=89.6, ups=0.12, wpb=768.4, bsz=64, num_updates=310, lr=5.83804e-06, gnorm=3.887, loss_scale=8, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=2629
2022-05-16 23:29:22 - progress_bar.py[line:272] - INFO: epoch 001:    324 / 8856 loss=4.311, loss_v1=0, loss_v2=0, nll_loss=1.978, ntokens=769.8, nsentences=64, sample_size=769.8, inner_loss=3.305, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.517, expert1_balance_bottom=18.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=89.6, ups=0.12, wpb=769.8, bsz=64, num_updates=320, lr=6.02637e-06, gnorm=3.35, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2715
2022-05-16 23:30:48 - progress_bar.py[line:272] - INFO: epoch 001:    334 / 8856 loss=4.28, loss_v1=0, loss_v2=0, nll_loss=1.94, ntokens=766.7, nsentences=64, sample_size=766.7, inner_loss=3.275, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.655, expert1_balance_bottom=18.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=89.4, ups=0.12, wpb=766.7, bsz=64, num_updates=330, lr=6.21469e-06, gnorm=3.336, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2800
2022-05-16 23:32:12 - progress_bar.py[line:272] - INFO: epoch 001:    344 / 8856 loss=4.245, loss_v1=0, loss_v2=0, nll_loss=1.91, ntokens=769.4, nsentences=64, sample_size=769.4, inner_loss=3.24, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.144, expert1_balance_bottom=18.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=91.2, ups=0.12, wpb=769.4, bsz=64, num_updates=340, lr=6.40301e-06, gnorm=3.152, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2885
2022-05-16 23:33:38 - progress_bar.py[line:272] - INFO: epoch 001:    354 / 8856 loss=4.321, loss_v1=0, loss_v2=0, nll_loss=1.999, ntokens=778.4, nsentences=64, sample_size=778.4, inner_loss=3.316, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.058, expert1_balance_bottom=18.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4, wps=91.1, ups=0.12, wpb=778.4, bsz=64, num_updates=350, lr=6.59134e-06, gnorm=5.36, loss_scale=8, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=2970
2022-05-16 23:35:03 - progress_bar.py[line:272] - INFO: epoch 001:    364 / 8856 loss=4.322, loss_v1=0, loss_v2=0, nll_loss=2.004, ntokens=774.8, nsentences=64, sample_size=774.8, inner_loss=3.315, moe_gate_loss=1.007, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.026, expert1_balance_bottom=17.629, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.01, wps=91.4, ups=0.12, wpb=774.8, bsz=64, num_updates=360, lr=6.77966e-06, gnorm=3.653, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3055
2022-05-16 23:36:27 - progress_bar.py[line:272] - INFO: epoch 001:    374 / 8856 loss=4.282, loss_v1=0, loss_v2=0, nll_loss=1.961, ntokens=770.1, nsentences=64, sample_size=770.1, inner_loss=3.276, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.6, expert1_balance_bottom=18.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=90.8, ups=0.12, wpb=770.1, bsz=64, num_updates=370, lr=6.96798e-06, gnorm=3.571, loss_scale=8, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3140
2022-05-16 23:37:53 - progress_bar.py[line:272] - INFO: epoch 001:    384 / 8856 loss=4.298, loss_v1=0, loss_v2=0, nll_loss=1.982, ntokens=769.2, nsentences=64, sample_size=769.2, inner_loss=3.292, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.348, expert1_balance_bottom=18.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.95, wps=90.1, ups=0.12, wpb=769.2, bsz=64, num_updates=380, lr=7.15631e-06, gnorm=3.052, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3225
2022-05-16 23:39:19 - progress_bar.py[line:272] - INFO: epoch 001:    394 / 8856 loss=4.316, loss_v1=0, loss_v2=0, nll_loss=2.004, ntokens=761.5, nsentences=64, sample_size=761.5, inner_loss=3.31, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.678, expert1_balance_bottom=17.7, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.01, wps=88.8, ups=0.12, wpb=761.5, bsz=64, num_updates=390, lr=7.34463e-06, gnorm=3.756, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3311
2022-05-16 23:40:44 - progress_bar.py[line:272] - INFO: epoch 001:    404 / 8856 loss=4.296, loss_v1=0, loss_v2=0, nll_loss=1.989, ntokens=764.5, nsentences=64, sample_size=764.5, inner_loss=3.291, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.779, expert1_balance_bottom=18.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.97, wps=89.7, ups=0.12, wpb=764.5, bsz=64, num_updates=400, lr=7.53296e-06, gnorm=2.993, loss_scale=8, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=3396
2022-05-16 23:42:09 - progress_bar.py[line:272] - INFO: epoch 001:    414 / 8856 loss=4.243, loss_v1=0, loss_v2=0, nll_loss=1.926, ntokens=773.7, nsentences=64, sample_size=773.7, inner_loss=3.239, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.99, expert1_balance_bottom=18.871, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=90.4, ups=0.12, wpb=773.7, bsz=64, num_updates=410, lr=7.72128e-06, gnorm=3.332, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3482
2022-05-16 23:43:35 - progress_bar.py[line:272] - INFO: epoch 001:    424 / 8856 loss=4.244, loss_v1=0, loss_v2=0, nll_loss=1.935, ntokens=779, nsentences=64, sample_size=779, inner_loss=3.239, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=33.374, expert1_balance_bottom=18.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=91.2, ups=0.12, wpb=779, bsz=64, num_updates=420, lr=7.9096e-06, gnorm=2.835, loss_scale=8, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=3567
2022-05-16 23:45:00 - progress_bar.py[line:272] - INFO: epoch 001:    434 / 8856 loss=4.181, loss_v1=0, loss_v2=0, nll_loss=1.858, ntokens=764.9, nsentences=64, sample_size=764.9, inner_loss=3.176, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.603, expert1_balance_bottom=18.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=89.2, ups=0.12, wpb=764.9, bsz=64, num_updates=430, lr=8.09793e-06, gnorm=3.16, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3653
2022-05-16 23:46:26 - progress_bar.py[line:272] - INFO: epoch 001:    444 / 8856 loss=4.306, loss_v1=0, loss_v2=0, nll_loss=2.007, ntokens=774.4, nsentences=64, sample_size=774.4, inner_loss=3.3, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.636, expert1_balance_bottom=17.566, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.02, wps=90.6, ups=0.12, wpb=774.4, bsz=64, num_updates=440, lr=8.28625e-06, gnorm=3.175, loss_scale=8, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3738
2022-05-16 23:47:50 - progress_bar.py[line:272] - INFO: epoch 001:    454 / 8856 loss=4.267, loss_v1=0, loss_v2=0, nll_loss=1.963, ntokens=774.9, nsentences=64, sample_size=774.9, inner_loss=3.262, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.41, expert1_balance_bottom=19.125, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.9, wps=91.9, ups=0.12, wpb=774.9, bsz=64, num_updates=450, lr=8.47458e-06, gnorm=3.118, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3823
2022-05-16 23:49:15 - progress_bar.py[line:272] - INFO: epoch 001:    464 / 8856 loss=4.244, loss_v1=0, loss_v2=0, nll_loss=1.942, ntokens=749.8, nsentences=64, sample_size=749.8, inner_loss=3.239, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.469, expert1_balance_bottom=18.624, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=88.3, ups=0.12, wpb=749.8, bsz=64, num_updates=460, lr=8.6629e-06, gnorm=3.116, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=3908
2022-05-16 23:50:40 - progress_bar.py[line:272] - INFO: epoch 001:    474 / 8856 loss=4.247, loss_v1=0, loss_v2=0, nll_loss=1.936, ntokens=758.3, nsentences=64, sample_size=758.3, inner_loss=3.241, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.651, expert1_balance_bottom=18.241, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=89.3, ups=0.12, wpb=758.3, bsz=64, num_updates=470, lr=8.85122e-06, gnorm=3.624, loss_scale=8, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=3993
2022-05-16 23:52:04 - progress_bar.py[line:272] - INFO: epoch 001:    484 / 8856 loss=4.22, loss_v1=0, loss_v2=0, nll_loss=1.918, ntokens=775.2, nsentences=64, sample_size=775.2, inner_loss=3.216, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.552, expert1_balance_bottom=18.372, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=91.9, ups=0.12, wpb=775.2, bsz=64, num_updates=480, lr=9.03955e-06, gnorm=3.339, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4077
2022-05-16 23:53:29 - progress_bar.py[line:272] - INFO: epoch 001:    494 / 8856 loss=4.163, loss_v1=0, loss_v2=0, nll_loss=1.862, ntokens=777.5, nsentences=64, sample_size=777.5, inner_loss=3.157, moe_gate_loss=1.006, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.424, expert1_balance_bottom=18.198, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=92.5, ups=0.12, wpb=777.5, bsz=64, num_updates=490, lr=9.22787e-06, gnorm=3.095, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4161
2022-05-16 23:54:52 - progress_bar.py[line:272] - INFO: epoch 001:    504 / 8856 loss=4.272, loss_v1=0, loss_v2=0, nll_loss=1.978, ntokens=759.3, nsentences=64, sample_size=759.3, inner_loss=3.267, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.302, expert1_balance_bottom=18.229, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=91.4, ups=0.12, wpb=759.3, bsz=64, num_updates=500, lr=9.4162e-06, gnorm=2.993, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4244
2022-05-16 23:56:17 - progress_bar.py[line:272] - INFO: epoch 001:    514 / 8856 loss=4.212, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=753.5, nsentences=64, sample_size=753.5, inner_loss=3.207, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.503, expert1_balance_bottom=18.511, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=88.3, ups=0.12, wpb=753.5, bsz=64, num_updates=510, lr=9.60452e-06, gnorm=3.175, loss_scale=8, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=4329
2022-05-16 23:57:41 - progress_bar.py[line:272] - INFO: epoch 001:    524 / 8856 loss=4.22, loss_v1=0, loss_v2=0, nll_loss=1.932, ntokens=759.9, nsentences=64, sample_size=759.9, inner_loss=3.215, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.833, expert1_balance_bottom=18.391, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=90.1, ups=0.12, wpb=759.9, bsz=64, num_updates=520, lr=9.79284e-06, gnorm=3.016, loss_scale=8, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4414
2022-05-16 23:59:09 - progress_bar.py[line:272] - INFO: epoch 001:    534 / 8856 loss=4.295, loss_v1=0, loss_v2=0, nll_loss=2.006, ntokens=770.9, nsentences=64, sample_size=770.9, inner_loss=3.29, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.685, expert1_balance_bottom=18.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=4.02, wps=88.1, ups=0.11, wpb=770.9, bsz=64, num_updates=530, lr=9.98117e-06, gnorm=2.773, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4501
2022-05-17 00:00:33 - progress_bar.py[line:272] - INFO: epoch 001:    544 / 8856 loss=4.219, loss_v1=0, loss_v2=0, nll_loss=1.928, ntokens=757.1, nsentences=64, sample_size=757.1, inner_loss=3.215, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.552, expert1_balance_bottom=18.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=89.5, ups=0.12, wpb=757.1, bsz=64, num_updates=540, lr=1.01695e-05, gnorm=3.595, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4586
2022-05-17 00:01:57 - progress_bar.py[line:272] - INFO: epoch 001:    554 / 8856 loss=4.237, loss_v1=0, loss_v2=0, nll_loss=1.951, ntokens=770.5, nsentences=64, sample_size=770.5, inner_loss=3.232, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.375, expert1_balance_bottom=18.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=92.7, ups=0.12, wpb=770.5, bsz=64, num_updates=550, lr=1.03578e-05, gnorm=3.054, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4669
2022-05-17 00:03:23 - progress_bar.py[line:272] - INFO: epoch 001:    564 / 8856 loss=4.21, loss_v1=0, loss_v2=0, nll_loss=1.917, ntokens=757.5, nsentences=64, sample_size=757.5, inner_loss=3.205, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.871, expert1_balance_bottom=18.658, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=88.1, ups=0.12, wpb=757.5, bsz=64, num_updates=560, lr=1.05461e-05, gnorm=3.241, loss_scale=8, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4755
2022-05-17 00:04:47 - progress_bar.py[line:272] - INFO: epoch 001:    574 / 8856 loss=4.21, loss_v1=0, loss_v2=0, nll_loss=1.923, ntokens=779.9, nsentences=64, sample_size=779.9, inner_loss=3.206, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.802, expert1_balance_bottom=19.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=91.9, ups=0.12, wpb=779.9, bsz=64, num_updates=570, lr=1.07345e-05, gnorm=3.433, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4840
2022-05-17 00:06:12 - progress_bar.py[line:272] - INFO: epoch 001:    584 / 8856 loss=4.153, loss_v1=0, loss_v2=0, nll_loss=1.858, ntokens=772.2, nsentences=64, sample_size=772.2, inner_loss=3.149, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.742, expert1_balance_bottom=18.565, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=90.9, ups=0.12, wpb=772.2, bsz=64, num_updates=580, lr=1.09228e-05, gnorm=3.238, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=4925
2022-05-17 00:07:36 - progress_bar.py[line:272] - INFO: epoch 001:    594 / 8856 loss=4.213, loss_v1=0, loss_v2=0, nll_loss=1.92, ntokens=767.1, nsentences=64, sample_size=767.1, inner_loss=3.209, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.824, expert1_balance_bottom=18.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=91.9, ups=0.12, wpb=767.1, bsz=64, num_updates=590, lr=1.11111e-05, gnorm=3.153, loss_scale=8, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5008
2022-05-17 00:09:00 - progress_bar.py[line:272] - INFO: epoch 001:    604 / 8856 loss=4.211, loss_v1=0, loss_v2=0, nll_loss=1.927, ntokens=756.4, nsentences=64, sample_size=756.4, inner_loss=3.206, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.384, expert1_balance_bottom=18.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=89.7, ups=0.12, wpb=756.4, bsz=64, num_updates=600, lr=1.12994e-05, gnorm=3.032, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5093
2022-05-17 00:10:25 - progress_bar.py[line:272] - INFO: epoch 001:    614 / 8856 loss=4.242, loss_v1=0, loss_v2=0, nll_loss=1.958, ntokens=769.9, nsentences=64, sample_size=769.9, inner_loss=3.237, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.734, expert1_balance_bottom=18.346, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=90.4, ups=0.12, wpb=769.9, bsz=64, num_updates=610, lr=1.14878e-05, gnorm=3.082, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5178
2022-05-17 00:11:51 - progress_bar.py[line:272] - INFO: epoch 001:    624 / 8856 loss=4.25, loss_v1=0, loss_v2=0, nll_loss=1.973, ntokens=779.7, nsentences=64, sample_size=779.7, inner_loss=3.246, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.059, expert1_balance_bottom=18.497, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.93, wps=91.4, ups=0.12, wpb=779.7, bsz=64, num_updates=620, lr=1.16761e-05, gnorm=3.324, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5263
2022-05-17 00:13:15 - progress_bar.py[line:272] - INFO: epoch 001:    634 / 8856 loss=4.191, loss_v1=0, loss_v2=0, nll_loss=1.907, ntokens=774.6, nsentences=64, sample_size=774.6, inner_loss=3.186, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=32.522, expert1_balance_bottom=18.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=91.7, ups=0.12, wpb=774.6, bsz=64, num_updates=630, lr=1.18644e-05, gnorm=3.127, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=5347
2022-05-17 00:14:38 - progress_bar.py[line:272] - INFO: epoch 001:    644 / 8856 loss=4.1, loss_v1=0, loss_v2=0, nll_loss=1.804, ntokens=776.1, nsentences=64, sample_size=776.1, inner_loss=3.097, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.609, expert1_balance_bottom=19.36, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.49, wps=93.7, ups=0.12, wpb=776.1, bsz=64, num_updates=640, lr=1.20527e-05, gnorm=3.042, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5430
2022-05-17 00:16:01 - progress_bar.py[line:272] - INFO: epoch 001:    654 / 8856 loss=4.203, loss_v1=0, loss_v2=0, nll_loss=1.924, ntokens=746.8, nsentences=64, sample_size=746.8, inner_loss=3.199, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.851, expert1_balance_bottom=18.745, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=90.3, ups=0.12, wpb=746.8, bsz=64, num_updates=650, lr=1.22411e-05, gnorm=3.384, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5513
2022-05-17 00:17:25 - progress_bar.py[line:272] - INFO: epoch 001:    664 / 8856 loss=4.142, loss_v1=0, loss_v2=0, nll_loss=1.854, ntokens=752.4, nsentences=64, sample_size=752.4, inner_loss=3.137, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.378, expert1_balance_top=31.673, expert1_balance_bottom=18.717, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=89.4, ups=0.12, wpb=752.4, bsz=64, num_updates=660, lr=1.24294e-05, gnorm=3.204, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5597
2022-05-17 00:18:49 - progress_bar.py[line:272] - INFO: epoch 001:    674 / 8856 loss=4.163, loss_v1=0, loss_v2=0, nll_loss=1.88, ntokens=760.8, nsentences=64, sample_size=760.8, inner_loss=3.159, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.463, expert1_balance_bottom=19.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=89.9, ups=0.12, wpb=760.8, bsz=64, num_updates=670, lr=1.26177e-05, gnorm=2.814, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5682
2022-05-17 00:20:13 - progress_bar.py[line:272] - INFO: epoch 001:    684 / 8856 loss=4.239, loss_v1=0, loss_v2=0, nll_loss=1.97, ntokens=769.3, nsentences=64, sample_size=769.3, inner_loss=3.234, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.819, expert1_balance_bottom=18.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.92, wps=91.8, ups=0.12, wpb=769.3, bsz=64, num_updates=680, lr=1.2806e-05, gnorm=3.008, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5766
2022-05-17 00:21:37 - progress_bar.py[line:272] - INFO: epoch 001:    694 / 8856 loss=4.192, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=771.4, nsentences=64, sample_size=771.4, inner_loss=3.188, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.867, expert1_balance_bottom=18.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=91.7, ups=0.12, wpb=771.4, bsz=64, num_updates=690, lr=1.29944e-05, gnorm=3.185, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5850
2022-05-17 00:23:01 - progress_bar.py[line:272] - INFO: epoch 001:    704 / 8856 loss=4.176, loss_v1=0, loss_v2=0, nll_loss=1.901, ntokens=756.1, nsentences=64, sample_size=756.1, inner_loss=3.173, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.193, expert1_balance_bottom=19.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=90, ups=0.12, wpb=756.1, bsz=64, num_updates=700, lr=1.31827e-05, gnorm=2.755, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=5934
2022-05-17 00:24:26 - progress_bar.py[line:272] - INFO: epoch 001:    714 / 8856 loss=4.204, loss_v1=0, loss_v2=0, nll_loss=1.922, ntokens=774.3, nsentences=64, sample_size=774.3, inner_loss=3.199, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=32.081, expert1_balance_bottom=18.641, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=91.7, ups=0.12, wpb=774.3, bsz=64, num_updates=710, lr=1.3371e-05, gnorm=3.024, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6018
2022-05-17 00:25:48 - progress_bar.py[line:272] - INFO: epoch 001:    724 / 8856 loss=4.177, loss_v1=0, loss_v2=0, nll_loss=1.907, ntokens=774.4, nsentences=64, sample_size=774.4, inner_loss=3.173, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.742, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=94.3, ups=0.12, wpb=774.4, bsz=64, num_updates=720, lr=1.35593e-05, gnorm=2.749, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6100
2022-05-17 00:27:12 - progress_bar.py[line:272] - INFO: epoch 001:    734 / 8856 loss=4.212, loss_v1=0, loss_v2=0, nll_loss=1.938, ntokens=778.9, nsentences=64, sample_size=778.9, inner_loss=3.207, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.927, expert1_balance_bottom=19.151, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=92.7, ups=0.12, wpb=778.9, bsz=64, num_updates=730, lr=1.37476e-05, gnorm=2.991, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6184
2022-05-17 00:28:35 - progress_bar.py[line:272] - INFO: epoch 001:    744 / 8856 loss=4.155, loss_v1=0, loss_v2=0, nll_loss=1.874, ntokens=765.9, nsentences=64, sample_size=765.9, inner_loss=3.151, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.89, expert1_balance_bottom=19.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=91.6, ups=0.12, wpb=765.9, bsz=64, num_updates=740, lr=1.3936e-05, gnorm=2.919, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6268
2022-05-17 00:29:58 - progress_bar.py[line:272] - INFO: epoch 001:    754 / 8856 loss=4.194, loss_v1=0, loss_v2=0, nll_loss=1.921, ntokens=772.8, nsentences=64, sample_size=772.8, inner_loss=3.189, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=32.235, expert1_balance_bottom=18.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=93.2, ups=0.12, wpb=772.8, bsz=64, num_updates=750, lr=1.41243e-05, gnorm=2.979, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6351
2022-05-17 00:31:23 - progress_bar.py[line:272] - INFO: epoch 001:    764 / 8856 loss=4.193, loss_v1=0, loss_v2=0, nll_loss=1.921, ntokens=762.6, nsentences=64, sample_size=762.6, inner_loss=3.189, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.453, expert1_balance_bottom=19.442, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=89.8, ups=0.12, wpb=762.6, bsz=64, num_updates=760, lr=1.43126e-05, gnorm=3.219, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6436
2022-05-17 00:32:47 - progress_bar.py[line:272] - INFO: epoch 001:    774 / 8856 loss=4.15, loss_v1=0, loss_v2=0, nll_loss=1.868, ntokens=759.6, nsentences=64, sample_size=759.6, inner_loss=3.145, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.652, expert1_balance_bottom=19.078, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=90.2, ups=0.12, wpb=759.6, bsz=64, num_updates=770, lr=1.45009e-05, gnorm=2.838, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6520
2022-05-17 00:34:11 - progress_bar.py[line:272] - INFO: epoch 001:    784 / 8856 loss=4.203, loss_v1=0, loss_v2=0, nll_loss=1.93, ntokens=764.1, nsentences=64, sample_size=764.1, inner_loss=3.198, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=32.127, expert1_balance_bottom=18.465, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=91.8, ups=0.12, wpb=764.1, bsz=64, num_updates=780, lr=1.46893e-05, gnorm=2.919, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6603
2022-05-17 00:35:35 - progress_bar.py[line:272] - INFO: epoch 001:    794 / 8856 loss=4.176, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=779.1, nsentences=64, sample_size=779.1, inner_loss=3.172, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.434, expert1_balance_bottom=19.219, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=92.6, ups=0.12, wpb=779.1, bsz=64, num_updates=790, lr=1.48776e-05, gnorm=2.929, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=6687
2022-05-17 00:36:59 - progress_bar.py[line:272] - INFO: epoch 001:    804 / 8856 loss=4.152, loss_v1=0, loss_v2=0, nll_loss=1.878, ntokens=764.3, nsentences=64, sample_size=764.3, inner_loss=3.148, moe_gate_loss=1.005, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.955, expert1_balance_bottom=18.806, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=90.9, ups=0.12, wpb=764.3, bsz=64, num_updates=800, lr=1.50659e-05, gnorm=3.429, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6771
2022-05-17 00:38:22 - progress_bar.py[line:272] - INFO: epoch 001:    814 / 8856 loss=4.141, loss_v1=0, loss_v2=0, nll_loss=1.859, ntokens=765.7, nsentences=64, sample_size=765.7, inner_loss=3.137, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.004, expert1_balance_bottom=19.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=91.8, ups=0.12, wpb=765.7, bsz=64, num_updates=810, lr=1.52542e-05, gnorm=2.935, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6855
2022-05-17 00:39:46 - progress_bar.py[line:272] - INFO: epoch 001:    824 / 8856 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=1.864, ntokens=758.6, nsentences=64, sample_size=758.6, inner_loss=3.129, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.702, expert1_balance_bottom=19.786, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=90.4, ups=0.12, wpb=758.6, bsz=64, num_updates=820, lr=1.54426e-05, gnorm=2.996, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=6939
2022-05-17 00:41:11 - progress_bar.py[line:272] - INFO: epoch 001:    834 / 8856 loss=4.174, loss_v1=0, loss_v2=0, nll_loss=1.901, ntokens=766.3, nsentences=64, sample_size=766.3, inner_loss=3.171, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.642, expert1_balance_bottom=19.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=90, ups=0.12, wpb=766.3, bsz=64, num_updates=830, lr=1.56309e-05, gnorm=3.046, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7024
2022-05-17 00:42:36 - progress_bar.py[line:272] - INFO: epoch 001:    844 / 8856 loss=4.237, loss_v1=0, loss_v2=0, nll_loss=1.979, ntokens=769.4, nsentences=64, sample_size=769.4, inner_loss=3.233, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.604, expert1_balance_bottom=18.966, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=91.3, ups=0.12, wpb=769.4, bsz=64, num_updates=840, lr=1.58192e-05, gnorm=3.309, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7108
2022-05-17 00:44:00 - progress_bar.py[line:272] - INFO: epoch 001:    854 / 8856 loss=4.222, loss_v1=0, loss_v2=0, nll_loss=1.957, ntokens=770.1, nsentences=64, sample_size=770.1, inner_loss=3.218, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.463, expert1_balance_bottom=19.114, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=91.5, ups=0.12, wpb=770.1, bsz=64, num_updates=850, lr=1.60075e-05, gnorm=3.491, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7192
2022-05-17 00:45:22 - progress_bar.py[line:272] - INFO: epoch 001:    864 / 8856 loss=4.197, loss_v1=0, loss_v2=0, nll_loss=1.93, ntokens=772.1, nsentences=64, sample_size=772.1, inner_loss=3.193, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.713, expert1_balance_bottom=19.035, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=94.1, ups=0.12, wpb=772.1, bsz=64, num_updates=860, lr=1.61959e-05, gnorm=2.784, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7274
2022-05-17 00:46:48 - progress_bar.py[line:272] - INFO: epoch 001:    874 / 8856 loss=4.208, loss_v1=0, loss_v2=0, nll_loss=1.947, ntokens=767.5, nsentences=64, sample_size=767.5, inner_loss=3.205, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.867, expert1_balance_bottom=19.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=88.8, ups=0.12, wpb=767.5, bsz=64, num_updates=870, lr=1.63842e-05, gnorm=2.775, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7361
2022-05-17 00:48:13 - progress_bar.py[line:272] - INFO: epoch 001:    884 / 8856 loss=4.138, loss_v1=0, loss_v2=0, nll_loss=1.866, ntokens=762.7, nsentences=64, sample_size=762.7, inner_loss=3.134, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.098, expert1_balance_bottom=19.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=89.9, ups=0.12, wpb=762.7, bsz=64, num_updates=880, lr=1.65725e-05, gnorm=2.745, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=7446
2022-05-17 00:49:37 - progress_bar.py[line:272] - INFO: epoch 001:    894 / 8856 loss=4.151, loss_v1=0, loss_v2=0, nll_loss=1.885, ntokens=775.5, nsentences=64, sample_size=775.5, inner_loss=3.148, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.008, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=92.8, ups=0.12, wpb=775.5, bsz=64, num_updates=890, lr=1.67608e-05, gnorm=2.811, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7529
2022-05-17 00:51:02 - progress_bar.py[line:272] - INFO: epoch 001:    904 / 8856 loss=4.107, loss_v1=0, loss_v2=0, nll_loss=1.829, ntokens=760.1, nsentences=64, sample_size=760.1, inner_loss=3.103, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.529, expert1_balance_bottom=19.432, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=89.6, ups=0.12, wpb=760.1, bsz=64, num_updates=900, lr=1.69492e-05, gnorm=2.889, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7614
2022-05-17 00:52:25 - progress_bar.py[line:272] - INFO: epoch 001:    914 / 8856 loss=4.219, loss_v1=0, loss_v2=0, nll_loss=1.959, ntokens=775.8, nsentences=64, sample_size=775.8, inner_loss=3.216, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.173, expert1_balance_bottom=19.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=93.2, ups=0.12, wpb=775.8, bsz=64, num_updates=910, lr=1.71375e-05, gnorm=3.087, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7697
2022-05-17 00:53:48 - progress_bar.py[line:272] - INFO: epoch 001:    924 / 8856 loss=4.141, loss_v1=0, loss_v2=0, nll_loss=1.872, ntokens=760.5, nsentences=64, sample_size=760.5, inner_loss=3.138, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.929, expert1_balance_bottom=19.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=91.4, ups=0.12, wpb=760.5, bsz=64, num_updates=920, lr=1.73258e-05, gnorm=2.836, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=7780
2022-05-17 00:55:12 - progress_bar.py[line:272] - INFO: epoch 001:    934 / 8856 loss=4.128, loss_v1=0, loss_v2=0, nll_loss=1.861, ntokens=759.3, nsentences=64, sample_size=759.3, inner_loss=3.125, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.056, expert1_balance_bottom=19.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=90.6, ups=0.12, wpb=759.3, bsz=64, num_updates=930, lr=1.75141e-05, gnorm=2.743, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7864
2022-05-17 00:56:35 - progress_bar.py[line:272] - INFO: epoch 001:    944 / 8856 loss=4.166, loss_v1=0, loss_v2=0, nll_loss=1.903, ntokens=773.1, nsentences=64, sample_size=773.1, inner_loss=3.163, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.239, expert1_balance_bottom=19.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=93.3, ups=0.12, wpb=773.1, bsz=64, num_updates=940, lr=1.77024e-05, gnorm=2.818, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=7947
2022-05-17 00:57:59 - progress_bar.py[line:272] - INFO: epoch 001:    954 / 8856 loss=4.164, loss_v1=0, loss_v2=0, nll_loss=1.907, ntokens=772.1, nsentences=64, sample_size=772.1, inner_loss=3.161, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.427, expert1_balance_bottom=19.968, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=91.7, ups=0.12, wpb=772.1, bsz=64, num_updates=950, lr=1.78908e-05, gnorm=2.954, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8031
2022-05-17 00:59:23 - progress_bar.py[line:272] - INFO: epoch 001:    964 / 8856 loss=4.169, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=759, nsentences=64, sample_size=759, inner_loss=3.165, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.989, expert1_balance_bottom=19.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=90.6, ups=0.12, wpb=759, bsz=64, num_updates=960, lr=1.80791e-05, gnorm=2.66, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8115
2022-05-17 01:00:46 - progress_bar.py[line:272] - INFO: epoch 001:    974 / 8856 loss=4.141, loss_v1=0, loss_v2=0, nll_loss=1.878, ntokens=765.8, nsentences=64, sample_size=765.8, inner_loss=3.137, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.518, expert1_balance_bottom=19.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=92, ups=0.12, wpb=765.8, bsz=64, num_updates=970, lr=1.82674e-05, gnorm=2.585, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=8198
2022-05-17 01:02:09 - progress_bar.py[line:272] - INFO: epoch 001:    984 / 8856 loss=4.15, loss_v1=0, loss_v2=0, nll_loss=1.886, ntokens=768.1, nsentences=64, sample_size=768.1, inner_loss=3.147, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.123, expert1_balance_bottom=19.677, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=92, ups=0.12, wpb=768.1, bsz=64, num_updates=980, lr=1.84557e-05, gnorm=3.334, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=8282
2022-05-17 01:03:32 - progress_bar.py[line:272] - INFO: epoch 001:    994 / 8856 loss=4.171, loss_v1=0, loss_v2=0, nll_loss=1.91, ntokens=763.6, nsentences=64, sample_size=763.6, inner_loss=3.168, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.748, expert1_balance_bottom=19.533, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=92.3, ups=0.12, wpb=763.6, bsz=64, num_updates=990, lr=1.86441e-05, gnorm=2.935, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8365
2022-05-17 01:04:57 - progress_bar.py[line:272] - INFO: epoch 001:   1004 / 8856 loss=4.127, loss_v1=0, loss_v2=0, nll_loss=1.861, ntokens=766.3, nsentences=64, sample_size=766.3, inner_loss=3.124, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.768, expert1_balance_bottom=19.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=90, ups=0.12, wpb=766.3, bsz=64, num_updates=1000, lr=1.88324e-05, gnorm=2.966, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8450
2022-05-17 01:06:21 - progress_bar.py[line:272] - INFO: epoch 001:   1014 / 8856 loss=4.119, loss_v1=0, loss_v2=0, nll_loss=1.85, ntokens=771.2, nsentences=64, sample_size=771.2, inner_loss=3.116, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.631, expert1_balance_bottom=19.374, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.6, wps=92.5, ups=0.12, wpb=771.2, bsz=64, num_updates=1010, lr=1.90207e-05, gnorm=2.874, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8533
2022-05-17 01:07:43 - progress_bar.py[line:272] - INFO: epoch 001:   1024 / 8856 loss=4.152, loss_v1=0, loss_v2=0, nll_loss=1.893, ntokens=765, nsentences=64, sample_size=765, inner_loss=3.148, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.07, expert1_balance_bottom=19.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=92.4, ups=0.12, wpb=765, bsz=64, num_updates=1020, lr=1.9209e-05, gnorm=2.637, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8616
2022-05-17 01:09:08 - progress_bar.py[line:272] - INFO: epoch 001:   1034 / 8856 loss=4.192, loss_v1=0, loss_v2=0, nll_loss=1.929, ntokens=757.3, nsentences=64, sample_size=757.3, inner_loss=3.189, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.762, expert1_balance_bottom=19.111, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=89.2, ups=0.12, wpb=757.3, bsz=64, num_updates=1030, lr=1.93974e-05, gnorm=3.024, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8701
2022-05-17 01:10:32 - progress_bar.py[line:272] - INFO: epoch 001:   1044 / 8856 loss=4.215, loss_v1=0, loss_v2=0, nll_loss=1.96, ntokens=767.4, nsentences=64, sample_size=767.4, inner_loss=3.211, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.88, expert1_balance_bottom=19.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=91.2, ups=0.12, wpb=767.4, bsz=64, num_updates=1040, lr=1.95857e-05, gnorm=3.414, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8785
2022-05-17 01:11:57 - progress_bar.py[line:272] - INFO: epoch 001:   1054 / 8856 loss=4.073, loss_v1=0, loss_v2=0, nll_loss=1.804, ntokens=779.9, nsentences=64, sample_size=779.9, inner_loss=3.069, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.241, expert1_balance_bottom=19.643, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.49, wps=92.1, ups=0.12, wpb=779.9, bsz=64, num_updates=1050, lr=1.9774e-05, gnorm=4.364, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=8870
2022-05-17 01:13:23 - progress_bar.py[line:272] - INFO: epoch 001:   1064 / 8856 loss=4.152, loss_v1=0, loss_v2=0, nll_loss=1.89, ntokens=765.6, nsentences=64, sample_size=765.6, inner_loss=3.149, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.414, expert1_balance_bottom=19.135, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=89.6, ups=0.12, wpb=765.6, bsz=64, num_updates=1060, lr=1.99623e-05, gnorm=3.162, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=8955
2022-05-17 01:14:46 - progress_bar.py[line:272] - INFO: epoch 001:   1074 / 8856 loss=4.206, loss_v1=0, loss_v2=0, nll_loss=1.956, ntokens=767.8, nsentences=64, sample_size=767.8, inner_loss=3.203, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=29.995, expert1_balance_bottom=20.039, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=92.1, ups=0.12, wpb=767.8, bsz=64, num_updates=1070, lr=1.99904e-05, gnorm=2.953, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9038
2022-05-17 01:16:10 - progress_bar.py[line:272] - INFO: epoch 001:   1084 / 8856 loss=4.142, loss_v1=0, loss_v2=0, nll_loss=1.876, ntokens=774.1, nsentences=64, sample_size=774.1, inner_loss=3.138, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.988, expert1_balance_bottom=19.006, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.67, wps=91.6, ups=0.12, wpb=774.1, bsz=64, num_updates=1080, lr=1.99784e-05, gnorm=3.134, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9123
2022-05-17 01:17:34 - progress_bar.py[line:272] - INFO: epoch 001:   1094 / 8856 loss=4.128, loss_v1=0, loss_v2=0, nll_loss=1.868, ntokens=763.4, nsentences=64, sample_size=763.4, inner_loss=3.124, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.163, expert1_balance_bottom=19.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=91.3, ups=0.12, wpb=763.4, bsz=64, num_updates=1090, lr=1.99664e-05, gnorm=2.684, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9206
2022-05-17 01:18:57 - progress_bar.py[line:272] - INFO: epoch 001:   1104 / 8856 loss=4.154, loss_v1=0, loss_v2=0, nll_loss=1.904, ntokens=763.5, nsentences=64, sample_size=763.5, inner_loss=3.151, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.654, expert1_balance_bottom=19.75, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=92.1, ups=0.12, wpb=763.5, bsz=64, num_updates=1100, lr=1.99544e-05, gnorm=3.195, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9289
2022-05-17 01:20:21 - progress_bar.py[line:272] - INFO: epoch 001:   1114 / 8856 loss=4.179, loss_v1=0, loss_v2=0, nll_loss=1.923, ntokens=752.6, nsentences=64, sample_size=752.6, inner_loss=3.175, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.613, expert1_balance_bottom=19.68, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=89.3, ups=0.12, wpb=752.6, bsz=64, num_updates=1110, lr=1.99423e-05, gnorm=2.684, loss_scale=16, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9374
2022-05-17 01:21:44 - progress_bar.py[line:272] - INFO: epoch 001:   1124 / 8856 loss=4.109, loss_v1=0, loss_v2=0, nll_loss=1.846, ntokens=761.9, nsentences=64, sample_size=761.9, inner_loss=3.106, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.963, expert1_balance_bottom=19.433, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.59, wps=91.9, ups=0.12, wpb=761.9, bsz=64, num_updates=1120, lr=1.99303e-05, gnorm=2.868, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=9457
2022-05-17 01:22:44 - progress_bar.py[line:272] - INFO: epoch 001:   1134 / 8856 loss=4.149, loss_v1=0, loss_v2=0, nll_loss=1.895, ntokens=767, nsentences=64, sample_size=767, inner_loss=3.146, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.462, expert1_balance_bottom=19.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=127.8, ups=0.17, wpb=767, bsz=64, num_updates=1130, lr=1.99183e-05, gnorm=2.882, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9517
2022-05-17 01:23:23 - progress_bar.py[line:272] - INFO: epoch 001:   1144 / 8856 loss=4.149, loss_v1=0, loss_v2=0, nll_loss=1.891, ntokens=773.9, nsentences=64, sample_size=773.9, inner_loss=3.146, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.666, expert1_balance_bottom=19.593, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=196.7, ups=0.25, wpb=773.9, bsz=64, num_updates=1140, lr=1.99063e-05, gnorm=3.244, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9556
2022-05-17 01:24:02 - progress_bar.py[line:272] - INFO: epoch 001:   1154 / 8856 loss=4.155, loss_v1=0, loss_v2=0, nll_loss=1.904, ntokens=765.3, nsentences=64, sample_size=765.3, inner_loss=3.152, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.738, expert1_balance_bottom=19.654, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=200.6, ups=0.26, wpb=765.3, bsz=64, num_updates=1150, lr=1.98943e-05, gnorm=2.929, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9594
2022-05-17 01:24:39 - progress_bar.py[line:272] - INFO: epoch 001:   1164 / 8856 loss=4.193, loss_v1=0, loss_v2=0, nll_loss=1.941, ntokens=773.9, nsentences=64, sample_size=773.9, inner_loss=3.19, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.834, expert1_balance_bottom=19.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.84, wps=208.3, ups=0.27, wpb=773.9, bsz=64, num_updates=1160, lr=1.98823e-05, gnorm=2.77, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9631
2022-05-17 01:25:16 - progress_bar.py[line:272] - INFO: epoch 001:   1174 / 8856 loss=4.119, loss_v1=0, loss_v2=0, nll_loss=1.86, ntokens=764.6, nsentences=64, sample_size=764.6, inner_loss=3.116, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.97, expert1_balance_bottom=19.269, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=203.2, ups=0.27, wpb=764.6, bsz=64, num_updates=1170, lr=1.98703e-05, gnorm=3.198, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9669
2022-05-17 01:25:55 - progress_bar.py[line:272] - INFO: epoch 001:   1184 / 8856 loss=4.143, loss_v1=0, loss_v2=0, nll_loss=1.883, ntokens=764.7, nsentences=64, sample_size=764.7, inner_loss=3.14, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.544, expert1_balance_bottom=19.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=196.2, ups=0.26, wpb=764.7, bsz=64, num_updates=1180, lr=1.98583e-05, gnorm=2.851, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9708
2022-05-17 01:26:33 - progress_bar.py[line:272] - INFO: epoch 001:   1194 / 8856 loss=4.163, loss_v1=0, loss_v2=0, nll_loss=1.91, ntokens=781, nsentences=64, sample_size=781, inner_loss=3.16, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.085, expert1_balance_bottom=19.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=205.9, ups=0.26, wpb=781, bsz=64, num_updates=1190, lr=1.98462e-05, gnorm=2.743, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9746
2022-05-17 01:27:10 - progress_bar.py[line:272] - INFO: epoch 001:   1204 / 8856 loss=4.128, loss_v1=0, loss_v2=0, nll_loss=1.875, ntokens=766.1, nsentences=64, sample_size=766.1, inner_loss=3.125, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.571, expert1_balance_bottom=19.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.67, wps=206.6, ups=0.27, wpb=766.1, bsz=64, num_updates=1200, lr=1.98342e-05, gnorm=3.339, loss_scale=32, train_wall=30, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9783
2022-05-17 01:27:47 - progress_bar.py[line:272] - INFO: epoch 001:   1214 / 8856 loss=4.096, loss_v1=0, loss_v2=0, nll_loss=1.829, ntokens=750.3, nsentences=64, sample_size=750.3, inner_loss=3.093, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.176, expert1_balance_bottom=19.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=202.8, ups=0.27, wpb=750.3, bsz=64, num_updates=1210, lr=1.98222e-05, gnorm=3.325, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9820
2022-05-17 01:28:27 - progress_bar.py[line:272] - INFO: epoch 001:   1224 / 8856 loss=4.186, loss_v1=0, loss_v2=0, nll_loss=1.939, ntokens=763.8, nsentences=64, sample_size=763.8, inner_loss=3.183, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.745, expert1_balance_bottom=19.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=195, ups=0.26, wpb=763.8, bsz=64, num_updates=1220, lr=1.98102e-05, gnorm=2.715, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9859
2022-05-17 01:29:03 - progress_bar.py[line:272] - INFO: epoch 001:   1234 / 8856 loss=4.129, loss_v1=0, loss_v2=0, nll_loss=1.871, ntokens=757.3, nsentences=64, sample_size=757.3, inner_loss=3.125, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.865, expert1_balance_bottom=19.65, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=206.5, ups=0.27, wpb=757.3, bsz=64, num_updates=1230, lr=1.97982e-05, gnorm=2.833, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9896
2022-05-17 01:29:41 - progress_bar.py[line:272] - INFO: epoch 001:   1244 / 8856 loss=4.153, loss_v1=0, loss_v2=0, nll_loss=1.906, ntokens=767, nsentences=64, sample_size=767, inner_loss=3.151, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.919, expert1_balance_bottom=19.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=202.8, ups=0.26, wpb=767, bsz=64, num_updates=1240, lr=1.97862e-05, gnorm=3.074, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9934
2022-05-17 01:30:32 - progress_bar.py[line:272] - INFO: epoch 001:   1254 / 8856 loss=4.162, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=771.1, nsentences=64, sample_size=771.1, inner_loss=3.159, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.52, expert1_balance_bottom=19.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=151.5, ups=0.2, wpb=771.1, bsz=64, num_updates=1250, lr=1.97742e-05, gnorm=3.073, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=9984
2022-05-17 01:31:54 - progress_bar.py[line:272] - INFO: epoch 001:   1264 / 8856 loss=4.129, loss_v1=0, loss_v2=0, nll_loss=1.875, ntokens=766.6, nsentences=64, sample_size=766.6, inner_loss=3.126, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.912, expert1_balance_bottom=19.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.67, wps=92.9, ups=0.12, wpb=766.6, bsz=64, num_updates=1260, lr=1.97622e-05, gnorm=2.606, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10067
2022-05-17 01:33:17 - progress_bar.py[line:272] - INFO: epoch 001:   1274 / 8856 loss=4.214, loss_v1=0, loss_v2=0, nll_loss=1.967, ntokens=762.4, nsentences=64, sample_size=762.4, inner_loss=3.211, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.932, expert1_balance_bottom=19.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=92.2, ups=0.12, wpb=762.4, bsz=64, num_updates=1270, lr=1.97502e-05, gnorm=2.682, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10150
2022-05-17 01:34:40 - progress_bar.py[line:272] - INFO: epoch 001:   1284 / 8856 loss=4.189, loss_v1=0, loss_v2=0, nll_loss=1.943, ntokens=762, nsentences=64, sample_size=762, inner_loss=3.186, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.024, expert1_balance_bottom=19.991, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=91.6, ups=0.12, wpb=762, bsz=64, num_updates=1280, lr=1.97381e-05, gnorm=2.614, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10233
2022-05-17 01:35:50 - progress_bar.py[line:272] - INFO: epoch 001:   1294 / 8856 loss=4.142, loss_v1=0, loss_v2=0, nll_loss=1.888, ntokens=771.4, nsentences=64, sample_size=771.4, inner_loss=3.139, moe_gate_loss=1.004, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=31.301, expert1_balance_bottom=19.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=110.2, ups=0.14, wpb=771.4, bsz=64, num_updates=1290, lr=1.97261e-05, gnorm=2.532, loss_scale=32, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10303
2022-05-17 01:36:28 - progress_bar.py[line:272] - INFO: epoch 001:   1304 / 8856 loss=4.115, loss_v1=0, loss_v2=0, nll_loss=1.861, ntokens=768.6, nsentences=64, sample_size=768.6, inner_loss=3.113, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.659, expert1_balance_bottom=19.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=204.8, ups=0.27, wpb=768.6, bsz=64, num_updates=1300, lr=1.97141e-05, gnorm=2.666, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10340
2022-05-17 01:37:06 - progress_bar.py[line:272] - INFO: epoch 001:   1314 / 8856 loss=4.22, loss_v1=0, loss_v2=0, nll_loss=1.977, ntokens=778.1, nsentences=64, sample_size=778.1, inner_loss=3.217, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.433, expert1_balance_bottom=20.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=206.4, ups=0.27, wpb=778.1, bsz=64, num_updates=1310, lr=1.97021e-05, gnorm=3.053, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10378
2022-05-17 01:37:43 - progress_bar.py[line:272] - INFO: epoch 001:   1324 / 8856 loss=4.137, loss_v1=0, loss_v2=0, nll_loss=1.888, ntokens=760.8, nsentences=64, sample_size=760.8, inner_loss=3.135, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.619, expert1_balance_bottom=19.755, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=204.8, ups=0.27, wpb=760.8, bsz=64, num_updates=1320, lr=1.96901e-05, gnorm=2.615, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10415
2022-05-17 01:38:20 - progress_bar.py[line:272] - INFO: epoch 001:   1334 / 8856 loss=4.129, loss_v1=0, loss_v2=0, nll_loss=1.872, ntokens=771.3, nsentences=64, sample_size=771.3, inner_loss=3.126, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.573, expert1_balance_bottom=19.895, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=206.9, ups=0.27, wpb=771.3, bsz=64, num_updates=1330, lr=1.96781e-05, gnorm=2.663, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10452
2022-05-17 01:38:56 - progress_bar.py[line:272] - INFO: epoch 001:   1344 / 8856 loss=4.146, loss_v1=0, loss_v2=0, nll_loss=1.899, ntokens=758.3, nsentences=64, sample_size=758.3, inner_loss=3.143, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.726, expert1_balance_bottom=20.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=209.3, ups=0.28, wpb=758.3, bsz=64, num_updates=1340, lr=1.96661e-05, gnorm=2.793, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10489
2022-05-17 01:39:35 - progress_bar.py[line:272] - INFO: epoch 001:   1354 / 8856 loss=4.121, loss_v1=0, loss_v2=0, nll_loss=1.87, ntokens=759.9, nsentences=64, sample_size=759.9, inner_loss=3.119, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.344, expert1_balance_bottom=20.231, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=198.4, ups=0.26, wpb=759.9, bsz=64, num_updates=1350, lr=1.96541e-05, gnorm=2.979, loss_scale=32, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=10527
2022-05-17 01:40:12 - progress_bar.py[line:272] - INFO: epoch 001:   1364 / 8856 loss=4.139, loss_v1=0, loss_v2=0, nll_loss=1.889, ntokens=758.3, nsentences=64, sample_size=758.3, inner_loss=3.136, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.469, expert1_balance_bottom=19.862, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=204.3, ups=0.27, wpb=758.3, bsz=64, num_updates=1360, lr=1.9642e-05, gnorm=2.675, loss_scale=32, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=10564
2022-05-17 01:40:52 - progress_bar.py[line:272] - INFO: epoch 001:   1374 / 8856 loss=4.129, loss_v1=0, loss_v2=0, nll_loss=1.878, ntokens=775.1, nsentences=64, sample_size=775.1, inner_loss=3.126, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.475, expert1_balance_bottom=19.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=193.8, ups=0.25, wpb=775.1, bsz=64, num_updates=1370, lr=1.963e-05, gnorm=3.225, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10604
2022-05-17 01:41:28 - progress_bar.py[line:272] - INFO: epoch 001:   1384 / 8856 loss=4.131, loss_v1=0, loss_v2=0, nll_loss=1.88, ntokens=763.7, nsentences=64, sample_size=763.7, inner_loss=3.128, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.082, expert1_balance_bottom=20.242, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=209.4, ups=0.27, wpb=763.7, bsz=64, num_updates=1380, lr=1.9618e-05, gnorm=3.179, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10641
2022-05-17 01:42:05 - progress_bar.py[line:272] - INFO: epoch 001:   1394 / 8856 loss=4.121, loss_v1=0, loss_v2=0, nll_loss=1.871, ntokens=770, nsentences=64, sample_size=770, inner_loss=3.118, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.781, expert1_balance_bottom=19.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=207.1, ups=0.27, wpb=770, bsz=64, num_updates=1390, lr=1.9606e-05, gnorm=2.698, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10678
2022-05-17 01:42:43 - progress_bar.py[line:272] - INFO: epoch 001:   1404 / 8856 loss=4.111, loss_v1=0, loss_v2=0, nll_loss=1.859, ntokens=759.6, nsentences=64, sample_size=759.6, inner_loss=3.108, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.44, expert1_balance_bottom=19.802, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=201.9, ups=0.27, wpb=759.6, bsz=64, num_updates=1400, lr=1.9594e-05, gnorm=2.904, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10715
2022-05-17 01:43:20 - progress_bar.py[line:272] - INFO: epoch 001:   1414 / 8856 loss=4.152, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=761.9, nsentences=64, sample_size=761.9, inner_loss=3.15, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.29, expert1_balance_bottom=19.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=203.9, ups=0.27, wpb=761.9, bsz=64, num_updates=1410, lr=1.9582e-05, gnorm=2.629, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10753
2022-05-17 01:43:56 - progress_bar.py[line:272] - INFO: epoch 001:   1424 / 8856 loss=4.155, loss_v1=0, loss_v2=0, nll_loss=1.907, ntokens=763.2, nsentences=64, sample_size=763.2, inner_loss=3.152, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.774, expert1_balance_bottom=20.126, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=211.2, ups=0.28, wpb=763.2, bsz=64, num_updates=1420, lr=1.957e-05, gnorm=2.683, loss_scale=32, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=10789
2022-05-17 01:45:06 - progress_bar.py[line:272] - INFO: epoch 001:   1434 / 8856 loss=4.118, loss_v1=0, loss_v2=0, nll_loss=1.865, ntokens=766.3, nsentences=64, sample_size=766.3, inner_loss=3.116, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.142, expert1_balance_bottom=19.878, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=110.1, ups=0.14, wpb=766.3, bsz=64, num_updates=1430, lr=1.9558e-05, gnorm=2.924, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10858
2022-05-17 01:46:29 - progress_bar.py[line:272] - INFO: epoch 001:   1444 / 8856 loss=4.125, loss_v1=0, loss_v2=0, nll_loss=1.877, ntokens=768.7, nsentences=64, sample_size=768.7, inner_loss=3.122, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.724, expert1_balance_bottom=19.81, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.67, wps=92.8, ups=0.12, wpb=768.7, bsz=64, num_updates=1440, lr=1.95459e-05, gnorm=2.72, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=10941
2022-05-17 01:47:52 - progress_bar.py[line:272] - INFO: epoch 001:   1454 / 8856 loss=4.119, loss_v1=0, loss_v2=0, nll_loss=1.865, ntokens=776.7, nsentences=64, sample_size=776.7, inner_loss=3.116, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.606, expert1_balance_bottom=20.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=93, ups=0.12, wpb=776.7, bsz=64, num_updates=1450, lr=1.95339e-05, gnorm=2.46, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11025
2022-05-17 01:49:16 - progress_bar.py[line:272] - INFO: epoch 001:   1464 / 8856 loss=4.134, loss_v1=0, loss_v2=0, nll_loss=1.883, ntokens=766.5, nsentences=64, sample_size=766.5, inner_loss=3.132, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.58, expert1_balance_bottom=20.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=91.3, ups=0.12, wpb=766.5, bsz=64, num_updates=1460, lr=1.95219e-05, gnorm=3.012, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11109
2022-05-17 01:50:41 - progress_bar.py[line:272] - INFO: epoch 001:   1474 / 8856 loss=4.167, loss_v1=0, loss_v2=0, nll_loss=1.926, ntokens=784.3, nsentences=64, sample_size=784.3, inner_loss=3.165, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.904, expert1_balance_bottom=20.065, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=92.6, ups=0.12, wpb=784.3, bsz=64, num_updates=1470, lr=1.95099e-05, gnorm=2.723, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11193
2022-05-17 01:52:04 - progress_bar.py[line:272] - INFO: epoch 001:   1484 / 8856 loss=4.127, loss_v1=0, loss_v2=0, nll_loss=1.88, ntokens=755.7, nsentences=64, sample_size=755.7, inner_loss=3.125, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=29.898, expert1_balance_bottom=20.515, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=91.1, ups=0.12, wpb=755.7, bsz=64, num_updates=1480, lr=1.94979e-05, gnorm=2.676, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11276
2022-05-17 01:53:28 - progress_bar.py[line:272] - INFO: epoch 001:   1494 / 8856 loss=4.107, loss_v1=0, loss_v2=0, nll_loss=1.856, ntokens=773.4, nsentences=64, sample_size=773.4, inner_loss=3.104, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.067, expert1_balance_bottom=20.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=91.9, ups=0.12, wpb=773.4, bsz=64, num_updates=1490, lr=1.94859e-05, gnorm=2.663, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11360
2022-05-17 01:54:53 - progress_bar.py[line:272] - INFO: epoch 001:   1504 / 8856 loss=4.108, loss_v1=0, loss_v2=0, nll_loss=1.859, ntokens=771.5, nsentences=64, sample_size=771.5, inner_loss=3.105, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.178, expert1_balance_bottom=19.978, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=91.2, ups=0.12, wpb=771.5, bsz=64, num_updates=1500, lr=1.94739e-05, gnorm=2.917, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11445
2022-05-17 01:56:16 - progress_bar.py[line:272] - INFO: epoch 001:   1514 / 8856 loss=4.145, loss_v1=0, loss_v2=0, nll_loss=1.899, ntokens=762.1, nsentences=64, sample_size=762.1, inner_loss=3.143, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.606, expert1_balance_bottom=19.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=91.2, ups=0.12, wpb=762.1, bsz=64, num_updates=1510, lr=1.94619e-05, gnorm=2.858, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11529
2022-05-17 01:57:40 - progress_bar.py[line:272] - INFO: epoch 001:   1524 / 8856 loss=4.116, loss_v1=0, loss_v2=0, nll_loss=1.866, ntokens=755.2, nsentences=64, sample_size=755.2, inner_loss=3.113, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.515, expert1_balance_bottom=20.393, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=89.8, ups=0.12, wpb=755.2, bsz=64, num_updates=1520, lr=1.94498e-05, gnorm=2.658, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=11613
2022-05-17 01:59:04 - progress_bar.py[line:272] - INFO: epoch 001:   1534 / 8856 loss=4.113, loss_v1=0, loss_v2=0, nll_loss=1.862, ntokens=768.3, nsentences=64, sample_size=768.3, inner_loss=3.11, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.333, expert1_balance_bottom=19.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=91.7, ups=0.12, wpb=768.3, bsz=64, num_updates=1530, lr=1.94378e-05, gnorm=2.712, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11697
2022-05-17 02:00:28 - progress_bar.py[line:272] - INFO: epoch 001:   1544 / 8856 loss=4.133, loss_v1=0, loss_v2=0, nll_loss=1.885, ntokens=761.1, nsentences=64, sample_size=761.1, inner_loss=3.131, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.627, expert1_balance_bottom=19.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=90.5, ups=0.12, wpb=761.1, bsz=64, num_updates=1540, lr=1.94258e-05, gnorm=2.97, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11781
2022-05-17 02:01:53 - progress_bar.py[line:272] - INFO: epoch 001:   1554 / 8856 loss=4.121, loss_v1=0, loss_v2=0, nll_loss=1.872, ntokens=771.6, nsentences=64, sample_size=771.6, inner_loss=3.118, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.328, expert1_balance_bottom=19.957, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=91.2, ups=0.12, wpb=771.6, bsz=64, num_updates=1550, lr=1.94138e-05, gnorm=2.517, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=11865
2022-05-17 02:03:17 - progress_bar.py[line:272] - INFO: epoch 001:   1564 / 8856 loss=4.144, loss_v1=0, loss_v2=0, nll_loss=1.898, ntokens=761.7, nsentences=64, sample_size=761.7, inner_loss=3.142, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.171, expert1_balance_bottom=20.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=90.5, ups=0.12, wpb=761.7, bsz=64, num_updates=1560, lr=1.94018e-05, gnorm=2.795, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=11949
2022-05-17 02:04:40 - progress_bar.py[line:272] - INFO: epoch 001:   1574 / 8856 loss=4.187, loss_v1=0, loss_v2=0, nll_loss=1.951, ntokens=760.5, nsentences=64, sample_size=760.5, inner_loss=3.185, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=29.917, expert1_balance_bottom=20.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.87, wps=91.5, ups=0.12, wpb=760.5, bsz=64, num_updates=1570, lr=1.93898e-05, gnorm=2.88, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12033
2022-05-17 02:06:04 - progress_bar.py[line:272] - INFO: epoch 001:   1584 / 8856 loss=4.133, loss_v1=0, loss_v2=0, nll_loss=1.886, ntokens=769.2, nsentences=64, sample_size=769.2, inner_loss=3.131, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.25, expert1_balance_bottom=20.719, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=91.3, ups=0.12, wpb=769.2, bsz=64, num_updates=1580, lr=1.93778e-05, gnorm=2.987, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12117
2022-05-17 02:07:28 - progress_bar.py[line:272] - INFO: epoch 001:   1594 / 8856 loss=4.189, loss_v1=0, loss_v2=0, nll_loss=1.946, ntokens=770.7, nsentences=64, sample_size=770.7, inner_loss=3.187, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.028, expert1_balance_bottom=20.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=92, ups=0.12, wpb=770.7, bsz=64, num_updates=1590, lr=1.93658e-05, gnorm=2.96, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12201
2022-05-17 02:08:51 - progress_bar.py[line:272] - INFO: epoch 001:   1604 / 8856 loss=4.167, loss_v1=0, loss_v2=0, nll_loss=1.927, ntokens=753.6, nsentences=64, sample_size=753.6, inner_loss=3.165, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.096, expert1_balance_bottom=20.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.8, wps=91.2, ups=0.12, wpb=753.6, bsz=64, num_updates=1600, lr=1.93538e-05, gnorm=2.755, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12283
2022-05-17 02:10:15 - progress_bar.py[line:272] - INFO: epoch 001:   1614 / 8856 loss=4.106, loss_v1=0, loss_v2=0, nll_loss=1.858, ntokens=757.4, nsentences=64, sample_size=757.4, inner_loss=3.104, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=29.797, expert1_balance_bottom=20.058, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=89.8, ups=0.12, wpb=757.4, bsz=64, num_updates=1610, lr=1.93417e-05, gnorm=2.975, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12367
2022-05-17 02:11:39 - progress_bar.py[line:272] - INFO: epoch 001:   1624 / 8856 loss=4.114, loss_v1=0, loss_v2=0, nll_loss=1.865, ntokens=760.3, nsentences=64, sample_size=760.3, inner_loss=3.112, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.356, expert1_balance_bottom=19.949, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=90.8, ups=0.12, wpb=760.3, bsz=64, num_updates=1620, lr=1.93297e-05, gnorm=2.347, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12451
2022-05-17 02:13:01 - progress_bar.py[line:272] - INFO: epoch 001:   1634 / 8856 loss=4.158, loss_v1=0, loss_v2=0, nll_loss=1.916, ntokens=761.3, nsentences=64, sample_size=761.3, inner_loss=3.155, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.305, expert1_balance_bottom=19.967, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=92, ups=0.12, wpb=761.3, bsz=64, num_updates=1630, lr=1.93177e-05, gnorm=2.689, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12534
2022-05-17 02:14:25 - progress_bar.py[line:272] - INFO: epoch 001:   1644 / 8856 loss=4.181, loss_v1=0, loss_v2=0, nll_loss=1.945, ntokens=760.8, nsentences=64, sample_size=760.8, inner_loss=3.179, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=29.775, expert1_balance_bottom=20.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.85, wps=91.3, ups=0.12, wpb=760.8, bsz=64, num_updates=1640, lr=1.93057e-05, gnorm=2.88, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=12617
2022-05-17 02:15:49 - progress_bar.py[line:272] - INFO: epoch 001:   1654 / 8856 loss=4.112, loss_v1=0, loss_v2=0, nll_loss=1.861, ntokens=765, nsentences=64, sample_size=765, inner_loss=3.11, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.14, expert1_balance_bottom=20.266, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=91.1, ups=0.12, wpb=765, bsz=64, num_updates=1650, lr=1.92937e-05, gnorm=2.891, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12701
2022-05-17 02:17:13 - progress_bar.py[line:272] - INFO: epoch 001:   1664 / 8856 loss=4.106, loss_v1=0, loss_v2=0, nll_loss=1.856, ntokens=765.6, nsentences=64, sample_size=765.6, inner_loss=3.104, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.281, expert1_balance_bottom=20.289, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=90.4, ups=0.12, wpb=765.6, bsz=64, num_updates=1660, lr=1.92817e-05, gnorm=2.538, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12786
2022-05-17 02:18:37 - progress_bar.py[line:272] - INFO: epoch 001:   1674 / 8856 loss=4.14, loss_v1=0, loss_v2=0, nll_loss=1.893, ntokens=771.7, nsentences=64, sample_size=771.7, inner_loss=3.137, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.577, expert1_balance_bottom=19.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=91.9, ups=0.12, wpb=771.7, bsz=64, num_updates=1670, lr=1.92697e-05, gnorm=2.498, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=12870
2022-05-17 02:20:01 - progress_bar.py[line:272] - INFO: epoch 001:   1684 / 8856 loss=4.163, loss_v1=0, loss_v2=0, nll_loss=1.919, ntokens=757.3, nsentences=64, sample_size=757.3, inner_loss=3.161, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.156, expert1_balance_bottom=19.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=90.1, ups=0.12, wpb=757.3, bsz=64, num_updates=1680, lr=1.92577e-05, gnorm=2.906, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=12954
2022-05-17 02:21:25 - progress_bar.py[line:272] - INFO: epoch 001:   1694 / 8856 loss=4.137, loss_v1=0, loss_v2=0, nll_loss=1.899, ntokens=753.8, nsentences=64, sample_size=753.8, inner_loss=3.135, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.017, expert1_balance_bottom=20.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=89.8, ups=0.12, wpb=753.8, bsz=64, num_updates=1690, lr=1.92456e-05, gnorm=2.744, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13038
2022-05-17 02:22:50 - progress_bar.py[line:272] - INFO: epoch 001:   1704 / 8856 loss=4.117, loss_v1=0, loss_v2=0, nll_loss=1.868, ntokens=765.5, nsentences=64, sample_size=765.5, inner_loss=3.115, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=29.853, expert1_balance_bottom=20.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=90.5, ups=0.12, wpb=765.5, bsz=64, num_updates=1700, lr=1.92336e-05, gnorm=2.51, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=13122
2022-05-17 02:24:13 - progress_bar.py[line:272] - INFO: epoch 001:   1714 / 8856 loss=4.19, loss_v1=0, loss_v2=0, nll_loss=1.956, ntokens=770.7, nsentences=64, sample_size=770.7, inner_loss=3.188, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.244, expert1_balance_bottom=20.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.88, wps=92.8, ups=0.12, wpb=770.7, bsz=64, num_updates=1710, lr=1.92216e-05, gnorm=2.894, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13205
2022-05-17 02:25:36 - progress_bar.py[line:272] - INFO: epoch 001:   1724 / 8856 loss=4.131, loss_v1=0, loss_v2=0, nll_loss=1.885, ntokens=765.6, nsentences=64, sample_size=765.6, inner_loss=3.129, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.237, expert1_balance_bottom=20.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=92.5, ups=0.12, wpb=765.6, bsz=64, num_updates=1720, lr=1.92096e-05, gnorm=2.633, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13288
2022-05-17 02:27:00 - progress_bar.py[line:272] - INFO: epoch 001:   1734 / 8856 loss=4.142, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=766.4, nsentences=64, sample_size=766.4, inner_loss=3.14, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.625, expert1_balance_bottom=20.825, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=91.2, ups=0.12, wpb=766.4, bsz=64, num_updates=1730, lr=1.91976e-05, gnorm=2.574, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13372
2022-05-17 02:28:22 - progress_bar.py[line:272] - INFO: epoch 001:   1744 / 8856 loss=4.133, loss_v1=0, loss_v2=0, nll_loss=1.887, ntokens=762.3, nsentences=64, sample_size=762.3, inner_loss=3.13, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.397, expert1_balance_bottom=20.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=92.1, ups=0.12, wpb=762.3, bsz=64, num_updates=1740, lr=1.91856e-05, gnorm=3.053, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13455
2022-05-17 02:29:47 - progress_bar.py[line:272] - INFO: epoch 001:   1754 / 8856 loss=4.204, loss_v1=0, loss_v2=0, nll_loss=1.966, ntokens=764.9, nsentences=64, sample_size=764.9, inner_loss=3.202, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.017, expert1_balance_bottom=20.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.91, wps=90.5, ups=0.12, wpb=764.9, bsz=64, num_updates=1750, lr=1.91736e-05, gnorm=2.876, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13540
2022-05-17 02:31:11 - progress_bar.py[line:272] - INFO: epoch 001:   1764 / 8856 loss=4.148, loss_v1=0, loss_v2=0, nll_loss=1.911, ntokens=762.3, nsentences=64, sample_size=762.3, inner_loss=3.146, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.335, expert1_balance_bottom=20.438, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=91, ups=0.12, wpb=762.3, bsz=64, num_updates=1760, lr=1.91616e-05, gnorm=2.949, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13623
2022-05-17 02:32:35 - progress_bar.py[line:272] - INFO: epoch 001:   1774 / 8856 loss=4.147, loss_v1=0, loss_v2=0, nll_loss=1.901, ntokens=751.1, nsentences=64, sample_size=751.1, inner_loss=3.144, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.248, expert1_balance_bottom=20.322, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=89.1, ups=0.12, wpb=751.1, bsz=64, num_updates=1770, lr=1.91495e-05, gnorm=2.81, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13708
2022-05-17 02:34:00 - progress_bar.py[line:272] - INFO: epoch 001:   1784 / 8856 loss=4.156, loss_v1=0, loss_v2=0, nll_loss=1.922, ntokens=760.1, nsentences=64, sample_size=760.1, inner_loss=3.154, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.835, expert1_balance_bottom=20.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.79, wps=89.1, ups=0.12, wpb=760.1, bsz=64, num_updates=1780, lr=1.91375e-05, gnorm=2.551, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13793
2022-05-17 02:35:25 - progress_bar.py[line:272] - INFO: epoch 001:   1794 / 8856 loss=4.108, loss_v1=0, loss_v2=0, nll_loss=1.857, ntokens=766.4, nsentences=64, sample_size=766.4, inner_loss=3.105, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.256, expert1_balance_bottom=20.27, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=90.5, ups=0.12, wpb=766.4, bsz=64, num_updates=1790, lr=1.91255e-05, gnorm=2.684, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13878
2022-05-17 02:36:48 - progress_bar.py[line:272] - INFO: epoch 001:   1804 / 8856 loss=4.144, loss_v1=0, loss_v2=0, nll_loss=1.908, ntokens=757.4, nsentences=64, sample_size=757.4, inner_loss=3.142, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.037, expert1_balance_bottom=20.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=91.2, ups=0.12, wpb=757.4, bsz=64, num_updates=1800, lr=1.91135e-05, gnorm=2.361, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=13961
2022-05-17 02:38:12 - progress_bar.py[line:272] - INFO: epoch 001:   1814 / 8856 loss=4.131, loss_v1=0, loss_v2=0, nll_loss=1.892, ntokens=747.8, nsentences=64, sample_size=747.8, inner_loss=3.129, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.193, expert1_balance_bottom=20.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=88.9, ups=0.12, wpb=747.8, bsz=64, num_updates=1810, lr=1.91015e-05, gnorm=2.617, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14045
2022-05-17 02:39:36 - progress_bar.py[line:272] - INFO: epoch 001:   1824 / 8856 loss=4.118, loss_v1=0, loss_v2=0, nll_loss=1.873, ntokens=761, nsentences=64, sample_size=761, inner_loss=3.116, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.178, expert1_balance_bottom=20.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=91.2, ups=0.12, wpb=761, bsz=64, num_updates=1820, lr=1.90895e-05, gnorm=2.685, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=14128
2022-05-17 02:41:01 - progress_bar.py[line:272] - INFO: epoch 001:   1834 / 8856 loss=4.116, loss_v1=0, loss_v2=0, nll_loss=1.872, ntokens=778.7, nsentences=64, sample_size=778.7, inner_loss=3.114, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.258, expert1_balance_bottom=20.201, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=91.5, ups=0.12, wpb=778.7, bsz=64, num_updates=1830, lr=1.90775e-05, gnorm=2.651, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14213
2022-05-17 02:42:24 - progress_bar.py[line:272] - INFO: epoch 001:   1844 / 8856 loss=4.191, loss_v1=0, loss_v2=0, nll_loss=1.958, ntokens=763.9, nsentences=64, sample_size=763.9, inner_loss=3.189, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.895, expert1_balance_bottom=20.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.89, wps=92.1, ups=0.12, wpb=763.9, bsz=64, num_updates=1840, lr=1.90655e-05, gnorm=2.747, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14296
2022-05-17 02:43:47 - progress_bar.py[line:272] - INFO: epoch 001:   1854 / 8856 loss=4.093, loss_v1=0, loss_v2=0, nll_loss=1.85, ntokens=757.7, nsentences=64, sample_size=757.7, inner_loss=3.091, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.512, expert1_balance_bottom=20.719, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=90.8, ups=0.12, wpb=757.7, bsz=64, num_updates=1850, lr=1.90535e-05, gnorm=2.517, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14380
2022-05-17 02:45:10 - progress_bar.py[line:272] - INFO: epoch 001:   1864 / 8856 loss=4.101, loss_v1=0, loss_v2=0, nll_loss=1.855, ntokens=765.6, nsentences=64, sample_size=765.6, inner_loss=3.098, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.239, expert1_balance_bottom=20.076, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=91.9, ups=0.12, wpb=765.6, bsz=64, num_updates=1860, lr=1.90414e-05, gnorm=2.548, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14463
2022-05-17 02:46:35 - progress_bar.py[line:272] - INFO: epoch 001:   1874 / 8856 loss=4.089, loss_v1=0, loss_v2=0, nll_loss=1.842, ntokens=763.6, nsentences=64, sample_size=763.6, inner_loss=3.087, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.478, expert1_balance_bottom=19.82, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.59, wps=90.2, ups=0.12, wpb=763.6, bsz=64, num_updates=1870, lr=1.90294e-05, gnorm=2.868, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14548
2022-05-17 02:47:18 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-17 02:48:09 - progress_bar.py[line:272] - INFO: epoch 001:   1885 / 8856 loss=4.107, loss_v1=0, loss_v2=0, nll_loss=1.864, ntokens=766, nsentences=64, sample_size=766, inner_loss=3.105, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.018, expert1_balance_bottom=20.427, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=81.9, ups=0.11, wpb=766, bsz=64, num_updates=1880, lr=1.90174e-05, gnorm=2.399, loss_scale=32, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14641
2022-05-17 02:49:31 - progress_bar.py[line:272] - INFO: epoch 001:   1895 / 8856 loss=4.092, loss_v1=0, loss_v2=0, nll_loss=1.848, ntokens=774.9, nsentences=64, sample_size=774.9, inner_loss=3.09, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.465, expert1_balance_bottom=20.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.6, wps=93.6, ups=0.12, wpb=774.9, bsz=64, num_updates=1890, lr=1.90054e-05, gnorm=2.629, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=14724
2022-05-17 02:50:55 - progress_bar.py[line:272] - INFO: epoch 001:   1905 / 8856 loss=4.104, loss_v1=0, loss_v2=0, nll_loss=1.857, ntokens=768.3, nsentences=64, sample_size=768.3, inner_loss=3.102, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.651, expert1_balance_bottom=20.089, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.62, wps=91.8, ups=0.12, wpb=768.3, bsz=64, num_updates=1900, lr=1.89934e-05, gnorm=2.784, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14808
2022-05-17 02:52:19 - progress_bar.py[line:272] - INFO: epoch 001:   1915 / 8856 loss=4.156, loss_v1=0, loss_v2=0, nll_loss=1.916, ntokens=768, nsentences=64, sample_size=768, inner_loss=3.154, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.931, expert1_balance_bottom=20.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=91.1, ups=0.12, wpb=768, bsz=64, num_updates=1910, lr=1.89814e-05, gnorm=2.894, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14892
2022-05-17 02:53:44 - progress_bar.py[line:272] - INFO: epoch 001:   1925 / 8856 loss=4.169, loss_v1=0, loss_v2=0, nll_loss=1.936, ntokens=764.3, nsentences=64, sample_size=764.3, inner_loss=3.167, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.803, expert1_balance_bottom=20.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.83, wps=90.6, ups=0.12, wpb=764.3, bsz=64, num_updates=1920, lr=1.89694e-05, gnorm=2.65, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=14976
2022-05-17 02:55:07 - progress_bar.py[line:272] - INFO: epoch 001:   1935 / 8856 loss=4.074, loss_v1=0, loss_v2=0, nll_loss=1.825, ntokens=748, nsentences=64, sample_size=748, inner_loss=3.072, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.098, expert1_balance_bottom=20.556, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.54, wps=89.5, ups=0.12, wpb=748, bsz=64, num_updates=1930, lr=1.89574e-05, gnorm=2.424, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15060
2022-05-17 02:56:31 - progress_bar.py[line:272] - INFO: epoch 001:   1945 / 8856 loss=4.056, loss_v1=0, loss_v2=0, nll_loss=1.806, ntokens=763.1, nsentences=64, sample_size=763.1, inner_loss=3.053, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.21, expert1_balance_bottom=20.399, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.5, wps=91, ups=0.12, wpb=763.1, bsz=64, num_updates=1940, lr=1.89453e-05, gnorm=2.354, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15144
2022-05-17 02:57:54 - progress_bar.py[line:272] - INFO: epoch 001:   1955 / 8856 loss=4.153, loss_v1=0, loss_v2=0, nll_loss=1.919, ntokens=765.2, nsentences=64, sample_size=765.2, inner_loss=3.151, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.379, expert1_balance_top=30.043, expert1_balance_bottom=20.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=92, ups=0.12, wpb=765.2, bsz=64, num_updates=1950, lr=1.89333e-05, gnorm=2.771, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15227
2022-05-17 02:59:18 - progress_bar.py[line:272] - INFO: epoch 001:   1965 / 8856 loss=4.149, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=753.8, nsentences=64, sample_size=753.8, inner_loss=3.147, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.877, expert1_balance_bottom=20.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=90.3, ups=0.12, wpb=753.8, bsz=64, num_updates=1960, lr=1.89213e-05, gnorm=2.737, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15310
2022-05-17 03:00:42 - progress_bar.py[line:272] - INFO: epoch 001:   1975 / 8856 loss=4.126, loss_v1=0, loss_v2=0, nll_loss=1.893, ntokens=756.2, nsentences=64, sample_size=756.2, inner_loss=3.124, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.884, expert1_balance_bottom=20.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=89.9, ups=0.12, wpb=756.2, bsz=64, num_updates=1970, lr=1.89093e-05, gnorm=2.537, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15394
2022-05-17 03:02:06 - progress_bar.py[line:272] - INFO: epoch 001:   1985 / 8856 loss=4.072, loss_v1=0, loss_v2=0, nll_loss=1.827, ntokens=768.3, nsentences=64, sample_size=768.3, inner_loss=3.071, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.621, expert1_balance_bottom=20.945, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=91.6, ups=0.12, wpb=768.3, bsz=64, num_updates=1980, lr=1.88973e-05, gnorm=3.036, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15478
2022-05-17 03:03:30 - progress_bar.py[line:272] - INFO: epoch 001:   1995 / 8856 loss=4.105, loss_v1=0, loss_v2=0, nll_loss=1.863, ntokens=766.7, nsentences=64, sample_size=766.7, inner_loss=3.103, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.164, expert1_balance_bottom=20.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=91.6, ups=0.12, wpb=766.7, bsz=64, num_updates=1990, lr=1.88853e-05, gnorm=2.67, loss_scale=32, train_wall=33, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=15562
2022-05-17 03:04:55 - progress_bar.py[line:272] - INFO: epoch 001:   2005 / 8856 loss=4.097, loss_v1=0, loss_v2=0, nll_loss=1.853, ntokens=764.3, nsentences=64, sample_size=764.3, inner_loss=3.095, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.378, expert1_balance_bottom=21.162, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=90, ups=0.12, wpb=764.3, bsz=64, num_updates=2000, lr=1.88733e-05, gnorm=2.61, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=15647
2022-05-17 03:04:55 - train.py[line:456] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-17 03:04:56 - train.py[line:466] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-17 03:04:56 - train.py[line:494] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-17 03:11:42 - train.py[line:503] - INFO: valid_step finished
2022-05-17 03:11:42 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 10.815 | loss_v1 0 | loss_v2 0 | nll_loss 8.986 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | inner_loss 9.814 | moe_gate_loss 1.001 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.38 | expert1_balance_top 28.255 | expert1_balance_bottom 21.742 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 506.93 | cider 1.26 | wps 743.9 | wpb 481.7 | bsz 8 | num_updates 2000
2022-05-17 03:11:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 2000 updates
2022-05-17 03:11:42 - trainer.py[line:450] - INFO: Saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_2000.pt
2022-05-17 03:11:48 - trainer.py[line:460] - INFO: Finished saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_2000.pt
2022-05-17 03:11:53 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_2000.pt (epoch 1 @ 2000 updates, score 1.26) (writing took 11.839153229258955 seconds)
2022-05-17 03:13:10 - progress_bar.py[line:272] - INFO: epoch 001:   2015 / 8856 loss=4.135, loss_v1=0, loss_v2=0, nll_loss=1.897, ntokens=774.7, nsentences=64, sample_size=774.7, inner_loss=3.133, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.12, expert1_balance_bottom=20.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=15.6, ups=0.02, wpb=774.7, bsz=64, num_updates=2010, lr=1.88613e-05, gnorm=2.788, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16143
2022-05-17 03:14:34 - progress_bar.py[line:272] - INFO: epoch 001:   2025 / 8856 loss=4.21, loss_v1=0, loss_v2=0, nll_loss=1.977, ntokens=773.6, nsentences=64, sample_size=773.6, inner_loss=3.208, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.767, expert1_balance_bottom=20.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.94, wps=92.3, ups=0.12, wpb=773.6, bsz=64, num_updates=2020, lr=1.88492e-05, gnorm=2.306, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16227
2022-05-17 03:15:59 - progress_bar.py[line:272] - INFO: epoch 001:   2035 / 8856 loss=4.106, loss_v1=0, loss_v2=0, nll_loss=1.869, ntokens=757.9, nsentences=64, sample_size=757.9, inner_loss=3.104, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.947, expert1_balance_bottom=20.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=89.6, ups=0.12, wpb=757.9, bsz=64, num_updates=2030, lr=1.88372e-05, gnorm=2.554, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16311
2022-05-17 03:17:22 - progress_bar.py[line:272] - INFO: epoch 001:   2045 / 8856 loss=4.109, loss_v1=0, loss_v2=0, nll_loss=1.864, ntokens=785.7, nsentences=64, sample_size=785.7, inner_loss=3.107, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.69, expert1_balance_bottom=20.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=94.4, ups=0.12, wpb=785.7, bsz=64, num_updates=2040, lr=1.88252e-05, gnorm=2.53, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=16394
2022-05-17 03:18:19 - progress_bar.py[line:272] - INFO: epoch 001:   2055 / 8856 loss=4.111, loss_v1=0, loss_v2=0, nll_loss=1.873, ntokens=767.1, nsentences=64, sample_size=767.1, inner_loss=3.108, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.361, expert1_balance_bottom=20.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.66, wps=133.9, ups=0.17, wpb=767.1, bsz=64, num_updates=2050, lr=1.88132e-05, gnorm=2.511, loss_scale=32, train_wall=33, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=16452
2022-05-17 03:18:57 - progress_bar.py[line:272] - INFO: epoch 001:   2065 / 8856 loss=4.105, loss_v1=0, loss_v2=0, nll_loss=1.86, ntokens=761.6, nsentences=64, sample_size=761.6, inner_loss=3.102, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.434, expert1_balance_bottom=20.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=199.4, ups=0.26, wpb=761.6, bsz=64, num_updates=2060, lr=1.88012e-05, gnorm=2.884, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16490
2022-05-17 03:19:34 - progress_bar.py[line:272] - INFO: epoch 001:   2075 / 8856 loss=4.137, loss_v1=0, loss_v2=0, nll_loss=1.898, ntokens=768.2, nsentences=64, sample_size=768.2, inner_loss=3.135, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.998, expert1_balance_bottom=20.608, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=208, ups=0.27, wpb=768.2, bsz=64, num_updates=2070, lr=1.87892e-05, gnorm=2.904, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16527
2022-05-17 03:20:12 - progress_bar.py[line:272] - INFO: epoch 001:   2085 / 8856 loss=4.047, loss_v1=0, loss_v2=0, nll_loss=1.798, ntokens=752, nsentences=64, sample_size=752, inner_loss=3.045, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.143, expert1_balance_bottom=20.098, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.48, wps=201.8, ups=0.27, wpb=752, bsz=64, num_updates=2080, lr=1.87772e-05, gnorm=2.632, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16564
2022-05-17 03:20:49 - progress_bar.py[line:272] - INFO: epoch 001:   2095 / 8856 loss=4.13, loss_v1=0, loss_v2=0, nll_loss=1.891, ntokens=760.3, nsentences=64, sample_size=760.3, inner_loss=3.128, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.768, expert1_balance_bottom=20.809, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=206.1, ups=0.27, wpb=760.3, bsz=64, num_updates=2090, lr=1.87652e-05, gnorm=2.656, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16601
2022-05-17 03:21:26 - progress_bar.py[line:272] - INFO: epoch 001:   2105 / 8856 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=1.897, ntokens=759.2, nsentences=64, sample_size=759.2, inner_loss=3.13, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.816, expert1_balance_bottom=20.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=204.1, ups=0.27, wpb=759.2, bsz=64, num_updates=2100, lr=1.87532e-05, gnorm=2.777, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16638
2022-05-17 03:22:02 - progress_bar.py[line:272] - INFO: epoch 001:   2115 / 8856 loss=4.143, loss_v1=0, loss_v2=0, nll_loss=1.902, ntokens=761.4, nsentences=64, sample_size=761.4, inner_loss=3.141, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.689, expert1_balance_bottom=20.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.74, wps=207.9, ups=0.27, wpb=761.4, bsz=64, num_updates=2110, lr=1.87411e-05, gnorm=2.685, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16675
2022-05-17 03:22:41 - progress_bar.py[line:272] - INFO: epoch 001:   2125 / 8856 loss=4.135, loss_v1=0, loss_v2=0, nll_loss=1.899, ntokens=768.7, nsentences=64, sample_size=768.7, inner_loss=3.133, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.944, expert1_balance_bottom=20.584, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=200.7, ups=0.26, wpb=768.7, bsz=64, num_updates=2120, lr=1.87291e-05, gnorm=2.514, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16713
2022-05-17 03:23:17 - progress_bar.py[line:272] - INFO: epoch 001:   2135 / 8856 loss=4.117, loss_v1=0, loss_v2=0, nll_loss=1.882, ntokens=770.5, nsentences=64, sample_size=770.5, inner_loss=3.115, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.691, expert1_balance_bottom=20.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=212.9, ups=0.28, wpb=770.5, bsz=64, num_updates=2130, lr=1.87171e-05, gnorm=2.602, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16749
2022-05-17 03:23:54 - progress_bar.py[line:272] - INFO: epoch 001:   2145 / 8856 loss=4.15, loss_v1=0, loss_v2=0, nll_loss=1.915, ntokens=766.1, nsentences=64, sample_size=766.1, inner_loss=3.148, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.683, expert1_balance_bottom=20.801, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.77, wps=208, ups=0.27, wpb=766.1, bsz=64, num_updates=2140, lr=1.87051e-05, gnorm=2.507, loss_scale=32, train_wall=32, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=16786
2022-05-17 03:24:30 - progress_bar.py[line:272] - INFO: epoch 001:   2155 / 8856 loss=4.151, loss_v1=0, loss_v2=0, nll_loss=1.92, ntokens=774.5, nsentences=64, sample_size=774.5, inner_loss=3.15, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.621, expert1_balance_bottom=20.389, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=211.4, ups=0.27, wpb=774.5, bsz=64, num_updates=2150, lr=1.86931e-05, gnorm=2.798, loss_scale=32, train_wall=32, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=16823
2022-05-17 03:25:09 - progress_bar.py[line:272] - INFO: epoch 001:   2165 / 8856 loss=4.136, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=773, nsentences=64, sample_size=773, inner_loss=3.134, moe_gate_loss=1.003, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.577, expert1_balance_bottom=20.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=197.7, ups=0.26, wpb=773, bsz=64, num_updates=2160, lr=1.86811e-05, gnorm=2.813, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16862
2022-05-17 03:25:46 - progress_bar.py[line:272] - INFO: epoch 001:   2175 / 8856 loss=4.1, loss_v1=0, loss_v2=0, nll_loss=1.859, ntokens=762.1, nsentences=64, sample_size=762.1, inner_loss=3.098, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.013, expert1_balance_bottom=20.746, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=209, ups=0.27, wpb=762.1, bsz=64, num_updates=2170, lr=1.86691e-05, gnorm=2.495, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16898
2022-05-17 03:26:53 - progress_bar.py[line:272] - INFO: epoch 001:   2185 / 8856 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=1.897, ntokens=756.1, nsentences=64, sample_size=756.1, inner_loss=3.13, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.356, expert1_balance_bottom=20.59, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=112.2, ups=0.15, wpb=756.1, bsz=64, num_updates=2180, lr=1.86571e-05, gnorm=2.427, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=16966
2022-05-17 03:28:17 - progress_bar.py[line:272] - INFO: epoch 001:   2195 / 8856 loss=4.083, loss_v1=0, loss_v2=0, nll_loss=1.842, ntokens=764.9, nsentences=64, sample_size=764.9, inner_loss=3.081, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.801, expert1_balance_bottom=20.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.58, wps=91, ups=0.12, wpb=764.9, bsz=64, num_updates=2190, lr=1.8645e-05, gnorm=2.65, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17050
2022-05-17 03:29:40 - progress_bar.py[line:272] - INFO: epoch 001:   2205 / 8856 loss=4.101, loss_v1=0, loss_v2=0, nll_loss=1.861, ntokens=758.1, nsentences=64, sample_size=758.1, inner_loss=3.098, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.92, expert1_balance_bottom=20.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=91.3, ups=0.12, wpb=758.1, bsz=64, num_updates=2200, lr=1.8633e-05, gnorm=3.159, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=17133
2022-05-17 03:31:04 - progress_bar.py[line:272] - INFO: epoch 001:   2215 / 8856 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=1.896, ntokens=770.4, nsentences=64, sample_size=770.4, inner_loss=3.13, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.142, expert1_balance_bottom=21.033, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=92.5, ups=0.12, wpb=770.4, bsz=64, num_updates=2210, lr=1.8621e-05, gnorm=2.837, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17216
2022-05-17 03:32:29 - progress_bar.py[line:272] - INFO: epoch 001:   2225 / 8856 loss=4.134, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=764, nsentences=64, sample_size=764, inner_loss=3.132, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.515, expert1_balance_bottom=21.028, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=89.5, ups=0.12, wpb=764, bsz=64, num_updates=2220, lr=1.8609e-05, gnorm=2.537, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17302
2022-05-17 03:33:53 - progress_bar.py[line:272] - INFO: epoch 001:   2235 / 8856 loss=4.119, loss_v1=0, loss_v2=0, nll_loss=1.881, ntokens=767.9, nsentences=64, sample_size=767.9, inner_loss=3.118, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.727, expert1_balance_bottom=20.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.68, wps=91, ups=0.12, wpb=767.9, bsz=64, num_updates=2230, lr=1.8597e-05, gnorm=2.435, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=17386
2022-05-17 03:35:17 - progress_bar.py[line:272] - INFO: epoch 001:   2245 / 8856 loss=4.181, loss_v1=0, loss_v2=0, nll_loss=1.95, ntokens=770.8, nsentences=64, sample_size=770.8, inner_loss=3.179, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.75, expert1_balance_bottom=20.317, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.86, wps=91.8, ups=0.12, wpb=770.8, bsz=64, num_updates=2240, lr=1.8585e-05, gnorm=2.629, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17470
2022-05-17 03:36:41 - progress_bar.py[line:272] - INFO: epoch 001:   2255 / 8856 loss=4.067, loss_v1=0, loss_v2=0, nll_loss=1.827, ntokens=759.9, nsentences=64, sample_size=759.9, inner_loss=3.065, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.196, expert1_balance_bottom=20.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=91.4, ups=0.12, wpb=759.9, bsz=64, num_updates=2250, lr=1.8573e-05, gnorm=2.514, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17553
2022-05-17 03:38:06 - progress_bar.py[line:272] - INFO: epoch 001:   2265 / 8856 loss=4.139, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=762.6, nsentences=64, sample_size=762.6, inner_loss=3.137, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.706, expert1_balance_bottom=20.601, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=89.8, ups=0.12, wpb=762.6, bsz=64, num_updates=2260, lr=1.8561e-05, gnorm=2.229, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17638
2022-05-17 03:39:30 - progress_bar.py[line:272] - INFO: epoch 001:   2275 / 8856 loss=4.161, loss_v1=0, loss_v2=0, nll_loss=1.93, ntokens=769.9, nsentences=64, sample_size=769.9, inner_loss=3.159, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.776, expert1_balance_bottom=20.702, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.81, wps=91.2, ups=0.12, wpb=769.9, bsz=64, num_updates=2270, lr=1.85489e-05, gnorm=2.858, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17722
2022-05-17 03:40:53 - progress_bar.py[line:272] - INFO: epoch 001:   2285 / 8856 loss=4.14, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=765.1, nsentences=64, sample_size=765.1, inner_loss=3.138, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.743, expert1_balance_bottom=20.753, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=92.4, ups=0.12, wpb=765.1, bsz=64, num_updates=2280, lr=1.85369e-05, gnorm=2.727, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17805
2022-05-17 03:42:18 - progress_bar.py[line:272] - INFO: epoch 001:   2295 / 8856 loss=4.096, loss_v1=0, loss_v2=0, nll_loss=1.859, ntokens=775.5, nsentences=64, sample_size=775.5, inner_loss=3.094, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.714, expert1_balance_bottom=20.718, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=91.4, ups=0.12, wpb=775.5, bsz=64, num_updates=2290, lr=1.85249e-05, gnorm=2.959, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17890
2022-05-17 03:43:42 - progress_bar.py[line:272] - INFO: epoch 001:   2305 / 8856 loss=4.126, loss_v1=0, loss_v2=0, nll_loss=1.887, ntokens=761.8, nsentences=64, sample_size=761.8, inner_loss=3.124, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.5, expert1_balance_bottom=20.727, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=90.8, ups=0.12, wpb=761.8, bsz=64, num_updates=2300, lr=1.85129e-05, gnorm=2.399, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=17974
2022-05-17 03:45:05 - progress_bar.py[line:272] - INFO: epoch 001:   2315 / 8856 loss=4.054, loss_v1=0, loss_v2=0, nll_loss=1.815, ntokens=767.4, nsentences=64, sample_size=767.4, inner_loss=3.053, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.967, expert1_balance_bottom=21.12, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.52, wps=92.4, ups=0.12, wpb=767.4, bsz=64, num_updates=2310, lr=1.85009e-05, gnorm=2.861, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18057
2022-05-17 03:46:28 - progress_bar.py[line:272] - INFO: epoch 001:   2325 / 8856 loss=4.129, loss_v1=0, loss_v2=0, nll_loss=1.891, ntokens=763.1, nsentences=64, sample_size=763.1, inner_loss=3.127, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.03, expert1_balance_bottom=20.808, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.71, wps=91.5, ups=0.12, wpb=763.1, bsz=64, num_updates=2320, lr=1.84889e-05, gnorm=2.767, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18141
2022-05-17 03:47:51 - progress_bar.py[line:272] - INFO: epoch 001:   2335 / 8856 loss=4.144, loss_v1=0, loss_v2=0, nll_loss=1.906, ntokens=769.4, nsentences=64, sample_size=769.4, inner_loss=3.142, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.801, expert1_balance_bottom=20.837, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.75, wps=92.3, ups=0.12, wpb=769.4, bsz=64, num_updates=2330, lr=1.84769e-05, gnorm=2.641, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18224
2022-05-17 03:49:15 - progress_bar.py[line:272] - INFO: epoch 001:   2345 / 8856 loss=4.135, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=772.9, nsentences=64, sample_size=772.9, inner_loss=3.133, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.949, expert1_balance_bottom=20.435, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=92.7, ups=0.12, wpb=772.9, bsz=64, num_updates=2340, lr=1.84649e-05, gnorm=2.563, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=18307
2022-05-17 03:50:39 - progress_bar.py[line:272] - INFO: epoch 001:   2355 / 8856 loss=4.088, loss_v1=0, loss_v2=0, nll_loss=1.852, ntokens=772.7, nsentences=64, sample_size=772.7, inner_loss=3.086, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.615, expert1_balance_bottom=20.464, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.61, wps=91.3, ups=0.12, wpb=772.7, bsz=64, num_updates=2350, lr=1.84529e-05, gnorm=2.561, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=18392
2022-05-17 03:52:03 - progress_bar.py[line:272] - INFO: epoch 001:   2365 / 8856 loss=4.166, loss_v1=0, loss_v2=0, nll_loss=1.934, ntokens=770.9, nsentences=64, sample_size=770.9, inner_loss=3.163, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.742, expert1_balance_bottom=20.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.82, wps=92.4, ups=0.12, wpb=770.9, bsz=64, num_updates=2360, lr=1.84408e-05, gnorm=2.53, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18475
2022-05-17 03:53:27 - progress_bar.py[line:272] - INFO: epoch 001:   2375 / 8856 loss=4.099, loss_v1=0, loss_v2=0, nll_loss=1.86, ntokens=755.2, nsentences=64, sample_size=755.2, inner_loss=3.097, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.107, expert1_balance_bottom=20.505, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=89.9, ups=0.12, wpb=755.2, bsz=64, num_updates=2370, lr=1.84288e-05, gnorm=2.719, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18559
2022-05-17 03:54:50 - progress_bar.py[line:272] - INFO: epoch 001:   2385 / 8856 loss=4.103, loss_v1=0, loss_v2=0, nll_loss=1.862, ntokens=760.1, nsentences=64, sample_size=760.1, inner_loss=3.101, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.676, expert1_balance_bottom=20.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.63, wps=91.4, ups=0.12, wpb=760.1, bsz=64, num_updates=2380, lr=1.84168e-05, gnorm=2.265, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18643
2022-05-17 03:56:13 - progress_bar.py[line:272] - INFO: epoch 001:   2395 / 8856 loss=4.125, loss_v1=0, loss_v2=0, nll_loss=1.888, ntokens=774, nsentences=64, sample_size=774, inner_loss=3.123, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.188, expert1_balance_bottom=20.704, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.7, wps=93, ups=0.12, wpb=774, bsz=64, num_updates=2390, lr=1.84048e-05, gnorm=2.597, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18726
2022-05-17 03:57:36 - progress_bar.py[line:272] - INFO: epoch 001:   2405 / 8856 loss=4.055, loss_v1=0, loss_v2=0, nll_loss=1.814, ntokens=774, nsentences=64, sample_size=774, inner_loss=3.053, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.987, expert1_balance_bottom=20.955, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.52, wps=93.4, ups=0.12, wpb=774, bsz=64, num_updates=2400, lr=1.83928e-05, gnorm=2.441, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18809
2022-05-17 03:59:00 - progress_bar.py[line:272] - INFO: epoch 001:   2415 / 8856 loss=4.09, loss_v1=0, loss_v2=0, nll_loss=1.848, ntokens=769, nsentences=64, sample_size=769, inner_loss=3.087, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.049, expert1_balance_bottom=20.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.6, wps=92.2, ups=0.12, wpb=769, bsz=64, num_updates=2410, lr=1.83808e-05, gnorm=2.622, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18892
2022-05-17 04:00:24 - progress_bar.py[line:272] - INFO: epoch 001:   2425 / 8856 loss=4.132, loss_v1=0, loss_v2=0, nll_loss=1.897, ntokens=768.4, nsentences=64, sample_size=768.4, inner_loss=3.131, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.508, expert1_balance_bottom=21.023, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.72, wps=91.5, ups=0.12, wpb=768.4, bsz=64, num_updates=2420, lr=1.83688e-05, gnorm=2.766, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=18976
2022-05-17 04:01:47 - progress_bar.py[line:272] - INFO: epoch 001:   2435 / 8856 loss=4.15, loss_v1=0, loss_v2=0, nll_loss=1.918, ntokens=756, nsentences=64, sample_size=756, inner_loss=3.149, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.559, expert1_balance_bottom=20.728, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.78, wps=90.2, ups=0.12, wpb=756, bsz=64, num_updates=2430, lr=1.83568e-05, gnorm=2.702, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19060
2022-05-17 04:03:11 - progress_bar.py[line:272] - INFO: epoch 001:   2445 / 8856 loss=4.074, loss_v1=0, loss_v2=0, nll_loss=1.827, ntokens=762.3, nsentences=64, sample_size=762.3, inner_loss=3.072, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.222, expert1_balance_bottom=20.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.55, wps=91, ups=0.12, wpb=762.3, bsz=64, num_updates=2440, lr=1.83447e-05, gnorm=2.566, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19144
2022-05-17 04:04:35 - progress_bar.py[line:272] - INFO: epoch 001:   2455 / 8856 loss=4.142, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=759.3, nsentences=64, sample_size=759.3, inner_loss=3.14, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.653, expert1_balance_bottom=20.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=90.4, ups=0.12, wpb=759.3, bsz=64, num_updates=2450, lr=1.83327e-05, gnorm=2.756, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19228
2022-05-17 04:05:59 - progress_bar.py[line:272] - INFO: epoch 001:   2465 / 8856 loss=4.14, loss_v1=0, loss_v2=0, nll_loss=1.909, ntokens=767.8, nsentences=64, sample_size=767.8, inner_loss=3.138, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.651, expert1_balance_bottom=20.563, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.76, wps=92, ups=0.12, wpb=767.8, bsz=64, num_updates=2460, lr=1.83207e-05, gnorm=2.577, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19311
2022-05-17 04:07:22 - progress_bar.py[line:272] - INFO: epoch 001:   2475 / 8856 loss=4.098, loss_v1=0, loss_v2=0, nll_loss=1.863, ntokens=773.7, nsentences=64, sample_size=773.7, inner_loss=3.097, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.489, expert1_balance_bottom=20.962, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.64, wps=92.3, ups=0.12, wpb=773.7, bsz=64, num_updates=2470, lr=1.83087e-05, gnorm=2.409, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19395
2022-05-17 04:08:46 - progress_bar.py[line:272] - INFO: epoch 001:   2485 / 8856 loss=4.106, loss_v1=0, loss_v2=0, nll_loss=1.867, ntokens=760, nsentences=64, sample_size=760, inner_loss=3.104, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.728, expert1_balance_bottom=21.045, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.65, wps=91, ups=0.12, wpb=760, bsz=64, num_updates=2480, lr=1.82967e-05, gnorm=2.736, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19478
2022-05-17 04:10:10 - progress_bar.py[line:272] - INFO: epoch 001:   2495 / 8856 loss=4.131, loss_v1=0, loss_v2=0, nll_loss=1.9, ntokens=771.2, nsentences=64, sample_size=771.2, inner_loss=3.129, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.55, expert1_balance_bottom=20.585, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.73, wps=92.4, ups=0.12, wpb=771.2, bsz=64, num_updates=2490, lr=1.82847e-05, gnorm=2.387, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19562
2022-05-17 04:11:32 - progress_bar.py[line:272] - INFO: epoch 001:   2505 / 8856 loss=4.121, loss_v1=0, loss_v2=0, nll_loss=1.884, ntokens=772.2, nsentences=64, sample_size=772.2, inner_loss=3.119, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.581, expert1_balance_bottom=20.628, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=3.69, wps=93.6, ups=0.12, wpb=772.2, bsz=64, num_updates=2500, lr=1.82727e-05, gnorm=2.333, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19645
2022-05-17 04:12:56 - progress_bar.py[line:272] - INFO: epoch 001:   2515 / 8856 loss=3.441, loss_v1=0, loss_v2=0, nll_loss=1.095, ntokens=763.9, nsentences=64, sample_size=624.5, inner_loss=2.439, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.526, expert1_balance_bottom=20.89, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=2.14, wps=91, ups=0.12, wpb=763.9, bsz=64, num_updates=2510, lr=1.82607e-05, gnorm=2.719, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19728
2022-05-17 04:14:19 - progress_bar.py[line:272] - INFO: epoch 001:   2525 / 8856 loss=3.307, loss_v1=0, loss_v2=0, nll_loss=0.948, ntokens=768.4, nsentences=64, sample_size=612, inner_loss=2.305, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.969, expert1_balance_bottom=20.705, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=92.1, ups=0.12, wpb=768.4, bsz=64, num_updates=2520, lr=1.82486e-05, gnorm=2.148, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19812
2022-05-17 04:15:45 - progress_bar.py[line:272] - INFO: epoch 001:   2535 / 8856 loss=3.28, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=757.4, nsentences=64, sample_size=602.9, inner_loss=2.278, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.459, expert1_balance_bottom=20.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=88.8, ups=0.12, wpb=757.4, bsz=64, num_updates=2530, lr=1.82366e-05, gnorm=2.495, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19897
2022-05-17 04:17:07 - progress_bar.py[line:272] - INFO: epoch 001:   2545 / 8856 loss=3.297, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=787, nsentences=64, sample_size=626, inner_loss=2.295, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.492, expert1_balance_bottom=20.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=95.4, ups=0.12, wpb=787, bsz=64, num_updates=2540, lr=1.82246e-05, gnorm=2.372, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=19980
2022-05-17 04:18:31 - progress_bar.py[line:272] - INFO: epoch 001:   2555 / 8856 loss=3.265, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=759.6, nsentences=64, sample_size=604.4, inner_loss=2.263, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.66, expert1_balance_bottom=20.564, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.9, ups=0.12, wpb=759.6, bsz=64, num_updates=2550, lr=1.82126e-05, gnorm=2.578, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20063
2022-05-17 04:19:55 - progress_bar.py[line:272] - INFO: epoch 001:   2565 / 8856 loss=3.326, loss_v1=0, loss_v2=0, nll_loss=0.973, ntokens=772.5, nsentences=64, sample_size=614.7, inner_loss=2.325, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.661, expert1_balance_bottom=20.703, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=91.5, ups=0.12, wpb=772.5, bsz=64, num_updates=2560, lr=1.82006e-05, gnorm=2.997, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20148
2022-05-17 04:21:18 - progress_bar.py[line:272] - INFO: epoch 001:   2575 / 8856 loss=3.287, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=763.7, nsentences=64, sample_size=607.6, inner_loss=2.286, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.783, expert1_balance_bottom=20.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=92.1, ups=0.12, wpb=763.7, bsz=64, num_updates=2570, lr=1.81886e-05, gnorm=2.612, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20231
2022-05-17 04:22:40 - progress_bar.py[line:272] - INFO: epoch 001:   2585 / 8856 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=768.6, nsentences=64, sample_size=611.9, inner_loss=2.254, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.462, expert1_balance_bottom=20.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=93.9, ups=0.12, wpb=768.6, bsz=64, num_updates=2580, lr=1.81766e-05, gnorm=2.482, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20312
2022-05-17 04:24:04 - progress_bar.py[line:272] - INFO: epoch 001:   2595 / 8856 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=770.7, nsentences=64, sample_size=613.2, inner_loss=2.218, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.789, expert1_balance_bottom=20.721, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.3, ups=0.12, wpb=770.7, bsz=64, num_updates=2590, lr=1.81646e-05, gnorm=2.231, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20396
2022-05-17 04:25:26 - progress_bar.py[line:272] - INFO: epoch 001:   2605 / 8856 loss=3.336, loss_v1=0, loss_v2=0, nll_loss=0.985, ntokens=761.2, nsentences=64, sample_size=606, inner_loss=2.334, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.916, expert1_balance_bottom=20.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.98, wps=92.6, ups=0.12, wpb=761.2, bsz=64, num_updates=2600, lr=1.81526e-05, gnorm=2.464, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=20478
2022-05-17 04:26:50 - progress_bar.py[line:272] - INFO: epoch 001:   2615 / 8856 loss=3.267, loss_v1=0, loss_v2=0, nll_loss=0.914, ntokens=759.4, nsentences=64, sample_size=604, inner_loss=2.266, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.337, expert1_balance_bottom=20.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=90, ups=0.12, wpb=759.4, bsz=64, num_updates=2610, lr=1.81405e-05, gnorm=2.521, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20563
2022-05-17 04:28:13 - progress_bar.py[line:272] - INFO: epoch 001:   2625 / 8856 loss=3.263, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=775.2, nsentences=64, sample_size=617, inner_loss=2.261, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.983, expert1_balance_bottom=20.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=93.5, ups=0.12, wpb=775.2, bsz=64, num_updates=2620, lr=1.81285e-05, gnorm=2.579, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=20646
2022-05-17 04:29:38 - progress_bar.py[line:272] - INFO: epoch 001:   2635 / 8856 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=766.1, nsentences=64, sample_size=610, inner_loss=2.243, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.37, expert1_balance_bottom=20.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90, ups=0.12, wpb=766.1, bsz=64, num_updates=2630, lr=1.81165e-05, gnorm=2.502, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20731
2022-05-17 04:31:01 - progress_bar.py[line:272] - INFO: epoch 001:   2645 / 8856 loss=3.277, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=766, nsentences=64, sample_size=609.6, inner_loss=2.275, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.352, expert1_balance_bottom=21.051, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=92.1, ups=0.12, wpb=766, bsz=64, num_updates=2640, lr=1.81045e-05, gnorm=2.636, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=20814
2022-05-17 04:32:25 - progress_bar.py[line:272] - INFO: epoch 001:   2655 / 8856 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=762.4, nsentences=64, sample_size=606.6, inner_loss=2.245, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.746, expert1_balance_bottom=20.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.1, ups=0.12, wpb=762.4, bsz=64, num_updates=2650, lr=1.80925e-05, gnorm=2.701, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=20898
2022-05-17 04:33:51 - progress_bar.py[line:272] - INFO: epoch 001:   2665 / 8856 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=762.1, nsentences=64, sample_size=606.5, inner_loss=2.264, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.578, expert1_balance_bottom=20.812, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=88.6, ups=0.12, wpb=762.1, bsz=64, num_updates=2660, lr=1.80805e-05, gnorm=2.876, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=20984
2022-05-17 04:35:15 - progress_bar.py[line:272] - INFO: epoch 001:   2675 / 8856 loss=3.271, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=764.1, nsentences=64, sample_size=608, inner_loss=2.27, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.133, expert1_balance_bottom=21.253, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=90.7, ups=0.12, wpb=764.1, bsz=64, num_updates=2670, lr=1.80685e-05, gnorm=2.606, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21068
2022-05-17 04:36:39 - progress_bar.py[line:272] - INFO: epoch 001:   2685 / 8856 loss=3.267, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=774.2, nsentences=64, sample_size=615.8, inner_loss=2.264, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.87, expert1_balance_bottom=20.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=92.5, ups=0.12, wpb=774.2, bsz=64, num_updates=2680, lr=1.80565e-05, gnorm=2.784, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21152
2022-05-17 04:38:03 - progress_bar.py[line:272] - INFO: epoch 001:   2695 / 8856 loss=3.273, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=776.4, nsentences=64, sample_size=618.1, inner_loss=2.272, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.547, expert1_balance_bottom=20.987, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=92.8, ups=0.12, wpb=776.4, bsz=64, num_updates=2690, lr=1.80444e-05, gnorm=2.679, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21235
2022-05-17 04:39:27 - progress_bar.py[line:272] - INFO: epoch 001:   2705 / 8856 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=771.6, nsentences=64, sample_size=614, inner_loss=2.272, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.473, expert1_balance_bottom=20.853, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=92.2, ups=0.12, wpb=771.6, bsz=64, num_updates=2700, lr=1.80324e-05, gnorm=2.592, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21319
2022-05-17 04:40:51 - progress_bar.py[line:272] - INFO: epoch 001:   2715 / 8856 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=768.5, nsentences=64, sample_size=611.7, inner_loss=2.233, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.162, expert1_balance_bottom=20.877, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.4, ups=0.12, wpb=768.5, bsz=64, num_updates=2710, lr=1.80204e-05, gnorm=2.519, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21403
2022-05-17 04:41:08 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-17 04:42:24 - progress_bar.py[line:272] - INFO: epoch 001:   2726 / 8856 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=766.2, nsentences=64, sample_size=609.9, inner_loss=2.248, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.389, expert1_balance_bottom=20.928, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=82.5, ups=0.11, wpb=766.2, bsz=64, num_updates=2720, lr=1.80084e-05, gnorm=2.926, loss_scale=32, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21496
2022-05-17 04:43:47 - progress_bar.py[line:272] - INFO: epoch 001:   2736 / 8856 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=761.3, nsentences=64, sample_size=605.9, inner_loss=2.24, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.485, expert1_balance_bottom=20.555, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.8, ups=0.12, wpb=761.3, bsz=64, num_updates=2730, lr=1.79964e-05, gnorm=2.771, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21580
2022-05-17 04:45:11 - progress_bar.py[line:272] - INFO: epoch 001:   2746 / 8856 loss=3.276, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=767.5, nsentences=64, sample_size=610.4, inner_loss=2.274, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.632, expert1_balance_bottom=20.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=92.2, ups=0.12, wpb=767.5, bsz=64, num_updates=2740, lr=1.79844e-05, gnorm=3.074, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21663
2022-05-17 04:46:35 - progress_bar.py[line:272] - INFO: epoch 001:   2756 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=754.4, nsentences=64, sample_size=600.5, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.301, expert1_balance_bottom=21.034, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=89.3, ups=0.12, wpb=754.4, bsz=64, num_updates=2750, lr=1.79724e-05, gnorm=2.357, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21748
2022-05-17 04:47:57 - progress_bar.py[line:272] - INFO: epoch 001:   2766 / 8856 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=777.4, nsentences=64, sample_size=619, inner_loss=2.252, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.817, expert1_balance_bottom=20.946, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=94.7, ups=0.12, wpb=777.4, bsz=64, num_updates=2760, lr=1.79604e-05, gnorm=2.419, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21830
2022-05-17 04:49:21 - progress_bar.py[line:272] - INFO: epoch 001:   2776 / 8856 loss=3.298, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=753.1, nsentences=64, sample_size=599.3, inner_loss=2.297, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.78, expert1_balance_bottom=20.632, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=89.7, ups=0.12, wpb=753.1, bsz=64, num_updates=2770, lr=1.79483e-05, gnorm=2.735, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=21914
2022-05-17 04:50:45 - progress_bar.py[line:272] - INFO: epoch 001:   2786 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=761.8, nsentences=64, sample_size=606.4, inner_loss=2.228, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.863, expert1_balance_bottom=20.89, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.2, ups=0.12, wpb=761.8, bsz=64, num_updates=2780, lr=1.79363e-05, gnorm=2.65, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=21997
2022-05-17 04:52:08 - progress_bar.py[line:272] - INFO: epoch 001:   2796 / 8856 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=750.6, nsentences=64, sample_size=597.2, inner_loss=2.245, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.873, expert1_balance_bottom=20.448, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.3, ups=0.12, wpb=750.6, bsz=64, num_updates=2790, lr=1.79243e-05, gnorm=2.66, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22080
2022-05-17 04:53:32 - progress_bar.py[line:272] - INFO: epoch 001:   2806 / 8856 loss=3.299, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=768, nsentences=64, sample_size=611.2, inner_loss=2.297, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.456, expert1_balance_bottom=20.848, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=91.2, ups=0.12, wpb=768, bsz=64, num_updates=2800, lr=1.79123e-05, gnorm=2.808, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22164
2022-05-17 04:54:56 - progress_bar.py[line:272] - INFO: epoch 001:   2816 / 8856 loss=3.265, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=769.5, nsentences=64, sample_size=612.3, inner_loss=2.264, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.264, expert1_balance_bottom=21.102, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=91.2, ups=0.12, wpb=769.5, bsz=64, num_updates=2810, lr=1.79003e-05, gnorm=2.719, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22249
2022-05-17 04:56:20 - progress_bar.py[line:272] - INFO: epoch 001:   2826 / 8856 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=768, nsentences=64, sample_size=610.9, inner_loss=2.254, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.865, expert1_balance_bottom=20.669, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=91.3, ups=0.12, wpb=768, bsz=64, num_updates=2820, lr=1.78883e-05, gnorm=2.43, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22333
2022-05-17 04:57:44 - progress_bar.py[line:272] - INFO: epoch 001:   2836 / 8856 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=764, nsentences=64, sample_size=607.7, inner_loss=2.246, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.213, expert1_balance_bottom=20.781, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.6, ups=0.12, wpb=764, bsz=64, num_updates=2830, lr=1.78763e-05, gnorm=2.692, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22416
2022-05-17 04:59:08 - progress_bar.py[line:272] - INFO: epoch 001:   2846 / 8856 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=766, nsentences=64, sample_size=610.1, inner_loss=2.291, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.468, expert1_balance_bottom=20.934, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=91.5, ups=0.12, wpb=766, bsz=64, num_updates=2840, lr=1.78643e-05, gnorm=2.943, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22500
2022-05-17 05:00:32 - progress_bar.py[line:272] - INFO: epoch 001:   2856 / 8856 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=756, nsentences=64, sample_size=601.5, inner_loss=2.24, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.949, expert1_balance_bottom=21.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=89.7, ups=0.12, wpb=756, bsz=64, num_updates=2850, lr=1.78523e-05, gnorm=2.633, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22584
2022-05-17 05:01:55 - progress_bar.py[line:272] - INFO: epoch 001:   2866 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=757.6, nsentences=64, sample_size=602.5, inner_loss=2.222, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.862, expert1_balance_bottom=20.95, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.3, ups=0.12, wpb=757.6, bsz=64, num_updates=2860, lr=1.78402e-05, gnorm=2.437, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22667
2022-05-17 05:03:19 - progress_bar.py[line:272] - INFO: epoch 001:   2876 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=763.8, nsentences=64, sample_size=607.7, inner_loss=2.216, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.462, expert1_balance_bottom=20.9, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.2, ups=0.12, wpb=763.8, bsz=64, num_updates=2870, lr=1.78282e-05, gnorm=2.664, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22751
2022-05-17 05:04:42 - progress_bar.py[line:272] - INFO: epoch 001:   2886 / 8856 loss=3.249, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=752.1, nsentences=64, sample_size=598.5, inner_loss=2.247, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.408, expert1_balance_bottom=20.495, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=89.7, ups=0.12, wpb=752.1, bsz=64, num_updates=2880, lr=1.78162e-05, gnorm=3.01, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22835
2022-05-17 05:06:06 - progress_bar.py[line:272] - INFO: epoch 001:   2896 / 8856 loss=3.271, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=753.4, nsentences=64, sample_size=600, inner_loss=2.27, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.573, expert1_balance_bottom=21.197, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=90.3, ups=0.12, wpb=753.4, bsz=64, num_updates=2890, lr=1.78042e-05, gnorm=2.698, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=22918
2022-05-17 05:07:30 - progress_bar.py[line:272] - INFO: epoch 001:   2906 / 8856 loss=3.265, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=776, nsentences=64, sample_size=617.9, inner_loss=2.264, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.633, expert1_balance_bottom=21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=92.5, ups=0.12, wpb=776, bsz=64, num_updates=2900, lr=1.77922e-05, gnorm=2.74, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23002
2022-05-17 05:08:53 - progress_bar.py[line:272] - INFO: epoch 001:   2916 / 8856 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=0.93, ntokens=776.8, nsentences=64, sample_size=618.7, inner_loss=2.27, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.633, expert1_balance_bottom=20.865, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=93.6, ups=0.12, wpb=776.8, bsz=64, num_updates=2910, lr=1.77802e-05, gnorm=2.514, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23085
2022-05-17 05:10:17 - progress_bar.py[line:272] - INFO: epoch 001:   2926 / 8856 loss=3.287, loss_v1=0, loss_v2=0, nll_loss=0.937, ntokens=770.3, nsentences=64, sample_size=613.3, inner_loss=2.285, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.774, expert1_balance_bottom=20.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=91.2, ups=0.12, wpb=770.3, bsz=64, num_updates=2920, lr=1.77682e-05, gnorm=3.374, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23170
2022-05-17 05:11:40 - progress_bar.py[line:272] - INFO: epoch 001:   2936 / 8856 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=764.2, nsentences=64, sample_size=608.3, inner_loss=2.26, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.325, expert1_balance_bottom=20.822, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=92, ups=0.12, wpb=764.2, bsz=64, num_updates=2930, lr=1.77562e-05, gnorm=3.138, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23253
2022-05-17 05:11:49 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-17 05:13:13 - progress_bar.py[line:272] - INFO: epoch 001:   2947 / 8856 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=763, nsentences=64, sample_size=607.3, inner_loss=2.243, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.474, expert1_balance_bottom=20.868, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=82.6, ups=0.11, wpb=763, bsz=64, num_updates=2940, lr=1.77441e-05, gnorm=2.727, loss_scale=16, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23345
2022-05-17 05:14:37 - progress_bar.py[line:272] - INFO: epoch 001:   2957 / 8856 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=758.5, nsentences=64, sample_size=603.7, inner_loss=2.23, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.308, expert1_balance_bottom=20.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.1, ups=0.12, wpb=758.5, bsz=64, num_updates=2950, lr=1.77321e-05, gnorm=2.433, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23429
2022-05-17 05:16:00 - progress_bar.py[line:272] - INFO: epoch 001:   2967 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=770.2, nsentences=64, sample_size=612.7, inner_loss=2.214, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.217, expert1_balance_bottom=20.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.1, ups=0.12, wpb=770.2, bsz=64, num_updates=2960, lr=1.77201e-05, gnorm=2.881, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23513
2022-05-17 05:17:23 - progress_bar.py[line:272] - INFO: epoch 001:   2977 / 8856 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=758.7, nsentences=64, sample_size=603.5, inner_loss=2.244, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.842, expert1_balance_bottom=20.714, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.5, ups=0.12, wpb=758.7, bsz=64, num_updates=2970, lr=1.77081e-05, gnorm=2.726, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23596
2022-05-17 05:18:48 - progress_bar.py[line:272] - INFO: epoch 001:   2987 / 8856 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=760.7, nsentences=64, sample_size=605.3, inner_loss=2.252, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=30.08, expert1_balance_bottom=20.414, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=90.3, ups=0.12, wpb=760.7, bsz=64, num_updates=2980, lr=1.76961e-05, gnorm=2.586, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23680
2022-05-17 05:20:11 - progress_bar.py[line:272] - INFO: epoch 001:   2997 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=758.9, nsentences=64, sample_size=603.9, inner_loss=2.232, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.493, expert1_balance_bottom=20.627, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.3, ups=0.12, wpb=758.9, bsz=64, num_updates=2990, lr=1.76841e-05, gnorm=2.621, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23763
2022-05-17 05:21:35 - progress_bar.py[line:272] - INFO: epoch 001:   3007 / 8856 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=760, nsentences=64, sample_size=604.9, inner_loss=2.231, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.611, expert1_balance_bottom=20.907, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.3, ups=0.12, wpb=760, bsz=64, num_updates=3000, lr=1.76721e-05, gnorm=2.913, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23847
2022-05-17 05:22:59 - progress_bar.py[line:272] - INFO: epoch 001:   3017 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=766.9, nsentences=64, sample_size=610.9, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.382, expert1_balance_bottom=21.144, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.2, ups=0.12, wpb=766.9, bsz=64, num_updates=3010, lr=1.76601e-05, gnorm=3.163, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=23931
2022-05-17 05:24:24 - progress_bar.py[line:272] - INFO: epoch 001:   3027 / 8856 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=0.929, ntokens=770.3, nsentences=64, sample_size=613.1, inner_loss=2.271, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.285, expert1_balance_bottom=21.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=90.6, ups=0.12, wpb=770.3, bsz=64, num_updates=3020, lr=1.7648e-05, gnorm=2.73, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24016
2022-05-17 05:25:47 - progress_bar.py[line:272] - INFO: epoch 001:   3037 / 8856 loss=3.269, loss_v1=0, loss_v2=0, nll_loss=0.925, ntokens=763.7, nsentences=64, sample_size=607.5, inner_loss=2.268, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.363, expert1_balance_bottom=20.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=91.9, ups=0.12, wpb=763.7, bsz=64, num_updates=3030, lr=1.7636e-05, gnorm=2.593, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24100
2022-05-17 05:27:11 - progress_bar.py[line:272] - INFO: epoch 001:   3047 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=772.2, nsentences=64, sample_size=614.5, inner_loss=2.217, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.426, expert1_balance_bottom=20.916, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92, ups=0.12, wpb=772.2, bsz=64, num_updates=3040, lr=1.7624e-05, gnorm=2.403, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24183
2022-05-17 05:28:35 - progress_bar.py[line:272] - INFO: epoch 001:   3057 / 8856 loss=3.265, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=763.8, nsentences=64, sample_size=607.3, inner_loss=2.264, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.416, expert1_balance_bottom=20.596, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=91.5, ups=0.12, wpb=763.8, bsz=64, num_updates=3050, lr=1.7612e-05, gnorm=3.093, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24267
2022-05-17 05:29:57 - progress_bar.py[line:272] - INFO: epoch 001:   3067 / 8856 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=761, nsentences=64, sample_size=605.7, inner_loss=2.238, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.665, expert1_balance_bottom=20.612, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.7, ups=0.12, wpb=761, bsz=64, num_updates=3060, lr=1.76e-05, gnorm=2.773, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24350
2022-05-17 05:31:20 - progress_bar.py[line:272] - INFO: epoch 001:   3077 / 8856 loss=3.241, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=767.1, nsentences=64, sample_size=610.5, inner_loss=2.24, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.212, expert1_balance_bottom=21.167, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=92.4, ups=0.12, wpb=767.1, bsz=64, num_updates=3070, lr=1.7588e-05, gnorm=2.706, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24433
2022-05-17 05:32:44 - progress_bar.py[line:272] - INFO: epoch 001:   3087 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=765.2, nsentences=64, sample_size=609, inner_loss=2.222, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.581, expert1_balance_bottom=20.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.9, ups=0.12, wpb=765.2, bsz=64, num_updates=3080, lr=1.7576e-05, gnorm=2.783, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24516
2022-05-17 05:34:06 - progress_bar.py[line:272] - INFO: epoch 001:   3097 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=767, nsentences=64, sample_size=609.9, inner_loss=2.226, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.748, expert1_balance_bottom=20.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.7, ups=0.12, wpb=767, bsz=64, num_updates=3090, lr=1.7564e-05, gnorm=2.639, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24599
2022-05-17 05:35:30 - progress_bar.py[line:272] - INFO: epoch 001:   3107 / 8856 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=766.5, nsentences=64, sample_size=609.8, inner_loss=2.18, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.244, expert1_balance_bottom=21.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.6, ups=0.12, wpb=766.5, bsz=64, num_updates=3100, lr=1.7552e-05, gnorm=2.592, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=24683
2022-05-17 05:36:54 - progress_bar.py[line:272] - INFO: epoch 001:   3117 / 8856 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=0.94, ntokens=755.4, nsentences=64, sample_size=601, inner_loss=2.281, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.479, expert1_balance_bottom=21.187, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=90, ups=0.12, wpb=755.4, bsz=64, num_updates=3110, lr=1.75399e-05, gnorm=2.997, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24767
2022-05-17 05:38:17 - progress_bar.py[line:272] - INFO: epoch 001:   3127 / 8856 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=761.4, nsentences=64, sample_size=605.9, inner_loss=2.252, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.612, expert1_balance_bottom=20.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=91.5, ups=0.12, wpb=761.4, bsz=64, num_updates=3120, lr=1.75279e-05, gnorm=2.858, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24850
2022-05-17 05:39:40 - progress_bar.py[line:272] - INFO: epoch 001:   3137 / 8856 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=753.1, nsentences=64, sample_size=598.9, inner_loss=2.229, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.351, expert1_balance_bottom=21.196, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.7, ups=0.12, wpb=753.1, bsz=64, num_updates=3130, lr=1.75159e-05, gnorm=2.868, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24933
2022-05-17 05:40:37 - progress_bar.py[line:272] - INFO: epoch 001:   3147 / 8856 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=770.8, nsentences=64, sample_size=612.8, inner_loss=2.24, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.433, expert1_balance_bottom=20.771, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=136.7, ups=0.18, wpb=770.8, bsz=64, num_updates=3140, lr=1.75039e-05, gnorm=2.85, loss_scale=16, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=24989
2022-05-17 05:41:15 - progress_bar.py[line:272] - INFO: epoch 001:   3157 / 8856 loss=3.26, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=761.1, nsentences=64, sample_size=606, inner_loss=2.258, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.471, expert1_balance_bottom=21.022, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=199.3, ups=0.26, wpb=761.1, bsz=64, num_updates=3150, lr=1.74919e-05, gnorm=2.784, loss_scale=16, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=25027
2022-05-17 05:41:53 - progress_bar.py[line:272] - INFO: epoch 001:   3167 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=758.9, nsentences=64, sample_size=604.2, inner_loss=2.23, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.474, expert1_balance_bottom=20.782, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=200.5, ups=0.26, wpb=758.9, bsz=64, num_updates=3160, lr=1.74799e-05, gnorm=3.336, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25065
2022-05-17 05:42:31 - progress_bar.py[line:272] - INFO: epoch 001:   3177 / 8856 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=761.3, nsentences=64, sample_size=605.8, inner_loss=2.242, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.855, expert1_balance_bottom=20.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=197.3, ups=0.26, wpb=761.3, bsz=64, num_updates=3170, lr=1.74679e-05, gnorm=2.471, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25104
2022-05-17 05:43:10 - progress_bar.py[line:272] - INFO: epoch 001:   3187 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=768.5, nsentences=64, sample_size=611.3, inner_loss=2.211, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.459, expert1_balance_bottom=20.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=198.5, ups=0.26, wpb=768.5, bsz=64, num_updates=3180, lr=1.74559e-05, gnorm=2.504, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25142
2022-05-17 05:43:47 - progress_bar.py[line:272] - INFO: epoch 001:   3197 / 8856 loss=3.271, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=756.3, nsentences=64, sample_size=601.7, inner_loss=2.269, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.542, expert1_balance_bottom=21.17, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=205.6, ups=0.27, wpb=756.3, bsz=64, num_updates=3190, lr=1.74438e-05, gnorm=2.481, loss_scale=16, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=25179
2022-05-17 05:44:25 - progress_bar.py[line:272] - INFO: epoch 001:   3207 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=783.1, nsentences=64, sample_size=623.4, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.519, expert1_balance_bottom=21.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=203.3, ups=0.26, wpb=783.1, bsz=64, num_updates=3200, lr=1.74318e-05, gnorm=2.789, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25218
2022-05-17 05:45:05 - progress_bar.py[line:272] - INFO: epoch 001:   3217 / 8856 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=780.9, nsentences=64, sample_size=621.6, inner_loss=2.242, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.33, expert1_balance_bottom=20.897, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=197.8, ups=0.25, wpb=780.9, bsz=64, num_updates=3210, lr=1.74198e-05, gnorm=2.727, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25257
2022-05-17 05:45:42 - progress_bar.py[line:272] - INFO: epoch 001:   3227 / 8856 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=767.1, nsentences=64, sample_size=610.7, inner_loss=2.191, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.489, expert1_balance_bottom=21.042, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=203.5, ups=0.27, wpb=767.1, bsz=64, num_updates=3220, lr=1.74078e-05, gnorm=2.762, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25295
2022-05-17 05:46:19 - progress_bar.py[line:272] - INFO: epoch 001:   3237 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=773.9, nsentences=64, sample_size=616.2, inner_loss=2.227, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.285, expert1_balance_bottom=20.828, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.8, ups=0.27, wpb=773.9, bsz=64, num_updates=3230, lr=1.73958e-05, gnorm=2.654, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25332
2022-05-17 05:46:56 - progress_bar.py[line:272] - INFO: epoch 001:   3247 / 8856 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=766.4, nsentences=64, sample_size=610.2, inner_loss=2.272, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.577, expert1_balance_bottom=20.834, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=208.6, ups=0.27, wpb=766.4, bsz=64, num_updates=3240, lr=1.73838e-05, gnorm=2.997, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25369
2022-05-17 05:47:33 - progress_bar.py[line:272] - INFO: epoch 001:   3257 / 8856 loss=3.252, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=779.5, nsentences=64, sample_size=620.6, inner_loss=2.251, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.081, expert1_balance_bottom=21.005, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=209, ups=0.27, wpb=779.5, bsz=64, num_updates=3250, lr=1.73718e-05, gnorm=3.033, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25406
2022-05-17 05:48:47 - progress_bar.py[line:272] - INFO: epoch 001:   3267 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=760.2, nsentences=64, sample_size=605.3, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.184, expert1_balance_bottom=21.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=103.8, ups=0.14, wpb=760.2, bsz=64, num_updates=3260, lr=1.73598e-05, gnorm=3.091, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25479
2022-05-17 05:50:11 - progress_bar.py[line:272] - INFO: epoch 001:   3277 / 8856 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=764.8, nsentences=64, sample_size=608.6, inner_loss=2.233, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.63, expert1_balance_bottom=20.672, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.7, ups=0.12, wpb=764.8, bsz=64, num_updates=3270, lr=1.73477e-05, gnorm=2.911, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25563
2022-05-17 05:51:35 - progress_bar.py[line:272] - INFO: epoch 001:   3287 / 8856 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=761.9, nsentences=64, sample_size=606.4, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.336, expert1_balance_bottom=21.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.2, ups=0.12, wpb=761.9, bsz=64, num_updates=3280, lr=1.73357e-05, gnorm=2.431, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25648
2022-05-17 05:53:00 - progress_bar.py[line:272] - INFO: epoch 001:   3297 / 8856 loss=3.276, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=756.5, nsentences=64, sample_size=602.1, inner_loss=2.274, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.708, expert1_balance_bottom=20.854, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=89.5, ups=0.12, wpb=756.5, bsz=64, num_updates=3290, lr=1.73237e-05, gnorm=2.907, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=25732
2022-05-17 05:54:24 - progress_bar.py[line:272] - INFO: epoch 001:   3307 / 8856 loss=3.293, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=765.3, nsentences=64, sample_size=609, inner_loss=2.291, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.318, expert1_balance_bottom=20.635, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=90.6, ups=0.12, wpb=765.3, bsz=64, num_updates=3300, lr=1.73117e-05, gnorm=3.164, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25817
2022-05-17 05:55:47 - progress_bar.py[line:272] - INFO: epoch 001:   3317 / 8856 loss=3.262, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=776.3, nsentences=64, sample_size=617.8, inner_loss=2.26, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.395, expert1_balance_bottom=21.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=93.6, ups=0.12, wpb=776.3, bsz=64, num_updates=3310, lr=1.72997e-05, gnorm=2.92, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25900
2022-05-17 05:56:46 - progress_bar.py[line:272] - INFO: epoch 001:   3327 / 8856 loss=3.27, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=771.2, nsentences=64, sample_size=614, inner_loss=2.269, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.214, expert1_balance_bottom=21.01, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=131.3, ups=0.17, wpb=771.2, bsz=64, num_updates=3320, lr=1.72877e-05, gnorm=3.113, loss_scale=16, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25958
2022-05-17 05:57:25 - progress_bar.py[line:272] - INFO: epoch 001:   3337 / 8856 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=773.2, nsentences=64, sample_size=615.3, inner_loss=2.228, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.363, expert1_balance_bottom=20.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=199.1, ups=0.26, wpb=773.2, bsz=64, num_updates=3330, lr=1.72757e-05, gnorm=2.474, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=25997
2022-05-17 05:58:02 - progress_bar.py[line:272] - INFO: epoch 001:   3347 / 8856 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=0.92, ntokens=745.2, nsentences=64, sample_size=592.5, inner_loss=2.259, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.537, expert1_balance_bottom=21.002, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=202.6, ups=0.27, wpb=745.2, bsz=64, num_updates=3340, lr=1.72637e-05, gnorm=2.696, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26034
2022-05-17 05:58:40 - progress_bar.py[line:272] - INFO: epoch 001:   3357 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=774.7, nsentences=64, sample_size=616.5, inner_loss=2.217, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.796, expert1_balance_bottom=20.401, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=203.2, ups=0.26, wpb=774.7, bsz=64, num_updates=3350, lr=1.72517e-05, gnorm=3.107, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26072
2022-05-17 05:59:17 - progress_bar.py[line:272] - INFO: epoch 001:   3367 / 8856 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=761.9, nsentences=64, sample_size=606.2, inner_loss=2.194, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.418, expert1_balance_bottom=21.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=203.8, ups=0.27, wpb=761.9, bsz=64, num_updates=3360, lr=1.72396e-05, gnorm=2.489, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26110
2022-05-17 05:59:53 - progress_bar.py[line:272] - INFO: epoch 001:   3377 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=780.4, nsentences=64, sample_size=620.9, inner_loss=2.223, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.695, expert1_balance_bottom=20.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=215.2, ups=0.28, wpb=780.4, bsz=64, num_updates=3370, lr=1.72276e-05, gnorm=2.277, loss_scale=16, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=26146
2022-05-17 06:00:32 - progress_bar.py[line:272] - INFO: epoch 001:   3387 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=762.4, nsentences=64, sample_size=606.5, inner_loss=2.19, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.414, expert1_balance_bottom=21.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=196.4, ups=0.26, wpb=762.4, bsz=64, num_updates=3380, lr=1.72156e-05, gnorm=2.578, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26185
2022-05-17 06:01:10 - progress_bar.py[line:272] - INFO: epoch 001:   3397 / 8856 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=764.5, nsentences=64, sample_size=608.3, inner_loss=2.22, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.081, expert1_balance_bottom=21.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=202.1, ups=0.26, wpb=764.5, bsz=64, num_updates=3390, lr=1.72036e-05, gnorm=2.742, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26222
2022-05-17 06:01:48 - progress_bar.py[line:272] - INFO: epoch 001:   3407 / 8856 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=770.5, nsentences=64, sample_size=613.5, inner_loss=2.232, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.531, expert1_balance_bottom=20.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=201.5, ups=0.26, wpb=770.5, bsz=64, num_updates=3400, lr=1.71916e-05, gnorm=2.555, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26261
2022-05-17 06:02:27 - progress_bar.py[line:272] - INFO: epoch 001:   3417 / 8856 loss=3.272, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=771.4, nsentences=64, sample_size=614.4, inner_loss=2.271, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.801, expert1_balance_bottom=21.678, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=201, ups=0.26, wpb=771.4, bsz=64, num_updates=3410, lr=1.71796e-05, gnorm=2.388, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26299
2022-05-17 06:03:05 - progress_bar.py[line:272] - INFO: epoch 001:   3427 / 8856 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=777.9, nsentences=64, sample_size=619.5, inner_loss=2.222, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.86, expert1_balance_bottom=21.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=204.8, ups=0.26, wpb=777.9, bsz=64, num_updates=3420, lr=1.71676e-05, gnorm=2.466, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26337
2022-05-17 06:03:42 - progress_bar.py[line:272] - INFO: epoch 001:   3437 / 8856 loss=3.266, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=762.3, nsentences=64, sample_size=606.5, inner_loss=2.264, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.511, expert1_balance_bottom=20.831, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=203.9, ups=0.27, wpb=762.3, bsz=64, num_updates=3430, lr=1.71556e-05, gnorm=2.903, loss_scale=16, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=26374
2022-05-17 06:04:20 - progress_bar.py[line:272] - INFO: epoch 001:   3447 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=773.9, nsentences=64, sample_size=616.1, inner_loss=2.216, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.556, expert1_balance_bottom=20.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=205, ups=0.26, wpb=773.9, bsz=64, num_updates=3440, lr=1.71435e-05, gnorm=2.709, loss_scale=16, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26412
2022-05-17 06:05:35 - progress_bar.py[line:272] - INFO: epoch 001:   3457 / 8856 loss=3.29, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=771, nsentences=64, sample_size=613.6, inner_loss=2.289, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.336, expert1_balance_bottom=21.012, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=102.7, ups=0.13, wpb=771, bsz=64, num_updates=3450, lr=1.71315e-05, gnorm=2.741, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26487
2022-05-17 06:06:58 - progress_bar.py[line:272] - INFO: epoch 001:   3467 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=779.4, nsentences=64, sample_size=620.4, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.932, expert1_balance_bottom=21.228, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=93.1, ups=0.12, wpb=779.4, bsz=64, num_updates=3460, lr=1.71195e-05, gnorm=2.95, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26571
2022-05-17 06:08:22 - progress_bar.py[line:272] - INFO: epoch 001:   3477 / 8856 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=770.6, nsentences=64, sample_size=613.6, inner_loss=2.238, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.833, expert1_balance_bottom=21.204, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.4, ups=0.12, wpb=770.6, bsz=64, num_updates=3470, lr=1.71075e-05, gnorm=2.601, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26654
2022-05-17 06:09:46 - progress_bar.py[line:272] - INFO: epoch 001:   3487 / 8856 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=759.2, nsentences=64, sample_size=604.3, inner_loss=2.22, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.888, expert1_balance_bottom=20.684, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.2, ups=0.12, wpb=759.2, bsz=64, num_updates=3480, lr=1.70955e-05, gnorm=2.515, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26738
2022-05-17 06:11:08 - progress_bar.py[line:272] - INFO: epoch 001:   3497 / 8856 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=761, nsentences=64, sample_size=605.9, inner_loss=2.221, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.263, expert1_balance_bottom=21.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.7, ups=0.12, wpb=761, bsz=64, num_updates=3490, lr=1.70835e-05, gnorm=2.499, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26821
2022-05-17 06:12:33 - progress_bar.py[line:272] - INFO: epoch 001:   3507 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=767, nsentences=64, sample_size=609.8, inner_loss=2.205, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.984, expert1_balance_bottom=20.804, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.8, ups=0.12, wpb=767, bsz=64, num_updates=3500, lr=1.70715e-05, gnorm=2.727, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26905
2022-05-17 06:13:57 - progress_bar.py[line:272] - INFO: epoch 001:   3517 / 8856 loss=3.267, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=765, nsentences=64, sample_size=608.7, inner_loss=2.265, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.535, expert1_balance_bottom=20.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=91, ups=0.12, wpb=765, bsz=64, num_updates=3510, lr=1.70595e-05, gnorm=2.552, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=26989
2022-05-17 06:15:20 - progress_bar.py[line:272] - INFO: epoch 001:   3527 / 8856 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=771.3, nsentences=64, sample_size=613.8, inner_loss=2.239, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.333, expert1_balance_bottom=20.91, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.2, ups=0.12, wpb=771.3, bsz=64, num_updates=3520, lr=1.70474e-05, gnorm=2.537, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27073
2022-05-17 06:16:43 - progress_bar.py[line:272] - INFO: epoch 001:   3537 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=763.3, nsentences=64, sample_size=607.7, inner_loss=2.236, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.423, expert1_balance_bottom=20.951, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92.5, ups=0.12, wpb=763.3, bsz=64, num_updates=3530, lr=1.70354e-05, gnorm=2.862, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27155
2022-05-17 06:18:06 - progress_bar.py[line:272] - INFO: epoch 001:   3547 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=766.3, nsentences=64, sample_size=609.6, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.396, expert1_balance_bottom=21.07, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.1, ups=0.12, wpb=766.3, bsz=64, num_updates=3540, lr=1.70234e-05, gnorm=2.725, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27239
2022-05-17 06:19:31 - progress_bar.py[line:272] - INFO: epoch 001:   3557 / 8856 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=758.7, nsentences=64, sample_size=603.8, inner_loss=2.206, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.586, expert1_balance_bottom=20.96, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=89.2, ups=0.12, wpb=758.7, bsz=64, num_updates=3550, lr=1.70114e-05, gnorm=2.761, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27324
2022-05-17 06:20:57 - progress_bar.py[line:272] - INFO: epoch 001:   3567 / 8856 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=757.3, nsentences=64, sample_size=602.4, inner_loss=2.245, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.846, expert1_balance_bottom=21.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=88.8, ups=0.12, wpb=757.3, bsz=64, num_updates=3560, lr=1.69994e-05, gnorm=2.54, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=27409
2022-05-17 06:22:19 - progress_bar.py[line:272] - INFO: epoch 001:   3577 / 8856 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=759.5, nsentences=64, sample_size=604.2, inner_loss=2.221, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.411, expert1_balance_bottom=21.123, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.5, ups=0.12, wpb=759.5, bsz=64, num_updates=3570, lr=1.69874e-05, gnorm=2.658, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27491
2022-05-17 06:23:43 - progress_bar.py[line:272] - INFO: epoch 001:   3587 / 8856 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=763.5, nsentences=64, sample_size=607.5, inner_loss=2.183, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.349, expert1_balance_bottom=21.18, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.1, ups=0.12, wpb=763.5, bsz=64, num_updates=3580, lr=1.69754e-05, gnorm=2.836, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27576
2022-05-17 06:25:08 - progress_bar.py[line:272] - INFO: epoch 001:   3597 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=768.1, nsentences=64, sample_size=611.5, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.175, expert1_balance_bottom=21.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.2, ups=0.12, wpb=768.1, bsz=64, num_updates=3590, lr=1.69634e-05, gnorm=2.589, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27660
2022-05-17 06:26:31 - progress_bar.py[line:272] - INFO: epoch 001:   3607 / 8856 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=752.4, nsentences=64, sample_size=598.6, inner_loss=2.194, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.23, expert1_balance_bottom=21.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90, ups=0.12, wpb=752.4, bsz=64, num_updates=3600, lr=1.69514e-05, gnorm=2.442, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27744
2022-05-17 06:27:55 - progress_bar.py[line:272] - INFO: epoch 001:   3617 / 8856 loss=3.279, loss_v1=0, loss_v2=0, nll_loss=0.95, ntokens=762.4, nsentences=64, sample_size=606.9, inner_loss=2.277, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.305, expert1_balance_bottom=20.882, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=91.3, ups=0.12, wpb=762.4, bsz=64, num_updates=3610, lr=1.69393e-05, gnorm=2.61, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27827
2022-05-17 06:29:19 - progress_bar.py[line:272] - INFO: epoch 001:   3627 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=766.2, nsentences=64, sample_size=609.8, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.07, expert1_balance_bottom=21.249, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.3, ups=0.12, wpb=766.2, bsz=64, num_updates=3620, lr=1.69273e-05, gnorm=2.757, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27911
2022-05-17 06:30:41 - progress_bar.py[line:272] - INFO: epoch 001:   3637 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=754.1, nsentences=64, sample_size=600, inner_loss=2.232, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.469, expert1_balance_bottom=21.092, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.5, ups=0.12, wpb=754.1, bsz=64, num_updates=3630, lr=1.69153e-05, gnorm=2.723, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=27994
2022-05-17 06:32:04 - progress_bar.py[line:272] - INFO: epoch 001:   3647 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=758.9, nsentences=64, sample_size=604.1, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.272, expert1_balance_bottom=21.246, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.2, ups=0.12, wpb=758.9, bsz=64, num_updates=3640, lr=1.69033e-05, gnorm=2.809, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28077
2022-05-17 06:33:28 - progress_bar.py[line:272] - INFO: epoch 001:   3657 / 8856 loss=3.283, loss_v1=0, loss_v2=0, nll_loss=0.946, ntokens=775.2, nsentences=64, sample_size=617, inner_loss=2.281, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.705, expert1_balance_bottom=20.947, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=93.1, ups=0.12, wpb=775.2, bsz=64, num_updates=3650, lr=1.68913e-05, gnorm=2.88, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28160
2022-05-17 06:34:51 - progress_bar.py[line:272] - INFO: epoch 001:   3667 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=764.2, nsentences=64, sample_size=608.2, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.21, expert1_balance_bottom=20.816, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.8, ups=0.12, wpb=764.2, bsz=64, num_updates=3660, lr=1.68793e-05, gnorm=2.969, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=28243
2022-05-17 06:36:15 - progress_bar.py[line:272] - INFO: epoch 001:   3677 / 8856 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=754.7, nsentences=64, sample_size=600.3, inner_loss=2.196, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.301, expert1_balance_bottom=20.978, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.8, ups=0.12, wpb=754.7, bsz=64, num_updates=3670, lr=1.68673e-05, gnorm=2.706, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28327
2022-05-17 06:37:38 - progress_bar.py[line:272] - INFO: epoch 001:   3687 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=767.4, nsentences=64, sample_size=610.8, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.126, expert1_balance_bottom=21.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.3, ups=0.12, wpb=767.4, bsz=64, num_updates=3680, lr=1.68553e-05, gnorm=2.735, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28410
2022-05-17 06:39:01 - progress_bar.py[line:272] - INFO: epoch 001:   3697 / 8856 loss=3.289, loss_v1=0, loss_v2=0, nll_loss=0.955, ntokens=762, nsentences=64, sample_size=606.4, inner_loss=2.287, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.263, expert1_balance_bottom=20.982, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=91.7, ups=0.12, wpb=762, bsz=64, num_updates=3690, lr=1.68432e-05, gnorm=3.026, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28493
2022-05-17 06:40:24 - progress_bar.py[line:272] - INFO: epoch 001:   3707 / 8856 loss=3.248, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=762.1, nsentences=64, sample_size=606.4, inner_loss=2.247, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.114, expert1_balance_bottom=21.055, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=91.7, ups=0.12, wpb=762.1, bsz=64, num_updates=3700, lr=1.68312e-05, gnorm=3.102, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28577
2022-05-17 06:41:47 - progress_bar.py[line:272] - INFO: epoch 001:   3717 / 8856 loss=3.257, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=766.3, nsentences=64, sample_size=609.7, inner_loss=2.255, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.086, expert1_balance_bottom=20.817, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=93, ups=0.12, wpb=766.3, bsz=64, num_updates=3710, lr=1.68192e-05, gnorm=2.771, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=28659
2022-05-17 06:43:11 - progress_bar.py[line:272] - INFO: epoch 001:   3727 / 8856 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=776.5, nsentences=64, sample_size=617.9, inner_loss=2.232, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.148, expert1_balance_bottom=21.118, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92.3, ups=0.12, wpb=776.5, bsz=64, num_updates=3720, lr=1.68072e-05, gnorm=2.718, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28743
2022-05-17 06:44:33 - progress_bar.py[line:272] - INFO: epoch 001:   3737 / 8856 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=760, nsentences=64, sample_size=604.9, inner_loss=2.204, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.649, expert1_balance_bottom=20.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.9, ups=0.12, wpb=760, bsz=64, num_updates=3730, lr=1.67952e-05, gnorm=2.297, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28826
2022-05-17 06:45:57 - progress_bar.py[line:272] - INFO: epoch 001:   3747 / 8856 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=775.1, nsentences=64, sample_size=616.5, inner_loss=2.182, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.389, expert1_balance_bottom=20.875, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=92.8, ups=0.12, wpb=775.1, bsz=64, num_updates=3740, lr=1.67832e-05, gnorm=2.966, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28909
2022-05-17 06:47:21 - progress_bar.py[line:272] - INFO: epoch 001:   3757 / 8856 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=764.8, nsentences=64, sample_size=608.8, inner_loss=2.189, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.183, expert1_balance_bottom=21.059, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.2, ups=0.12, wpb=764.8, bsz=64, num_updates=3750, lr=1.67712e-05, gnorm=2.397, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=28993
2022-05-17 06:48:43 - progress_bar.py[line:272] - INFO: epoch 001:   3767 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=763.9, nsentences=64, sample_size=608.5, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.049, expert1_balance_bottom=21.173, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.3, ups=0.12, wpb=763.9, bsz=64, num_updates=3760, lr=1.67592e-05, gnorm=2.518, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29076
2022-05-17 06:50:07 - progress_bar.py[line:272] - INFO: epoch 001:   3777 / 8856 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=764.8, nsentences=64, sample_size=608.2, inner_loss=2.242, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.144, expert1_balance_bottom=21.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=91.2, ups=0.12, wpb=764.8, bsz=64, num_updates=3770, lr=1.67471e-05, gnorm=2.698, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29160
2022-05-17 06:51:31 - progress_bar.py[line:272] - INFO: epoch 001:   3787 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=772.9, nsentences=64, sample_size=615.5, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.3, expert1_balance_bottom=21.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92.3, ups=0.12, wpb=772.9, bsz=64, num_updates=3780, lr=1.67351e-05, gnorm=2.708, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=29244
2022-05-17 06:52:54 - progress_bar.py[line:272] - INFO: epoch 001:   3797 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=773.7, nsentences=64, sample_size=615.6, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.284, expert1_balance_bottom=21.168, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=93.3, ups=0.12, wpb=773.7, bsz=64, num_updates=3790, lr=1.67231e-05, gnorm=2.212, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29327
2022-05-17 06:54:19 - progress_bar.py[line:272] - INFO: epoch 001:   3807 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=773.1, nsentences=64, sample_size=615.1, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.158, expert1_balance_bottom=21.086, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.7, ups=0.12, wpb=773.1, bsz=64, num_updates=3800, lr=1.67111e-05, gnorm=2.572, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29412
2022-05-17 06:55:43 - progress_bar.py[line:272] - INFO: epoch 001:   3817 / 8856 loss=3.249, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=748.8, nsentences=64, sample_size=596.5, inner_loss=2.248, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.424, expert1_balance_bottom=20.959, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=89.5, ups=0.12, wpb=748.8, bsz=64, num_updates=3810, lr=1.66991e-05, gnorm=3.11, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29495
2022-05-17 06:57:07 - progress_bar.py[line:272] - INFO: epoch 001:   3827 / 8856 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=752.7, nsentences=64, sample_size=598.8, inner_loss=2.252, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.407, expert1_balance_bottom=21.052, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=89.5, ups=0.12, wpb=752.7, bsz=64, num_updates=3820, lr=1.66871e-05, gnorm=2.705, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29579
2022-05-17 06:58:31 - progress_bar.py[line:272] - INFO: epoch 001:   3837 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=762.7, nsentences=64, sample_size=607.1, inner_loss=2.231, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.412, expert1_balance_bottom=21.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.1, ups=0.12, wpb=762.7, bsz=64, num_updates=3830, lr=1.66751e-05, gnorm=2.782, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29663
2022-05-17 06:59:54 - progress_bar.py[line:272] - INFO: epoch 001:   3847 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=745.3, nsentences=64, sample_size=592.8, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.113, expert1_balance_bottom=21.207, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90, ups=0.12, wpb=745.3, bsz=64, num_updates=3840, lr=1.66631e-05, gnorm=2.486, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29746
2022-05-17 07:01:19 - progress_bar.py[line:272] - INFO: epoch 001:   3857 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=759.9, nsentences=64, sample_size=604.8, inner_loss=2.228, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.452, expert1_balance_bottom=21.082, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=88.6, ups=0.12, wpb=759.9, bsz=64, num_updates=3850, lr=1.66511e-05, gnorm=2.594, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=29832
2022-05-17 07:02:44 - progress_bar.py[line:272] - INFO: epoch 001:   3867 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=768.1, nsentences=64, sample_size=611.2, inner_loss=2.23, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.169, expert1_balance_bottom=20.805, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.2, ups=0.12, wpb=768.1, bsz=64, num_updates=3860, lr=1.6639e-05, gnorm=2.6, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=29916
2022-05-17 07:04:07 - progress_bar.py[line:272] - INFO: epoch 001:   3877 / 8856 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=761, nsentences=64, sample_size=605.9, inner_loss=2.229, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.658, expert1_balance_bottom=20.824, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.9, ups=0.12, wpb=761, bsz=64, num_updates=3870, lr=1.6627e-05, gnorm=2.363, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30000
2022-05-17 07:05:32 - progress_bar.py[line:272] - INFO: epoch 001:   3887 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=780, nsentences=64, sample_size=621, inner_loss=2.203, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.69, expert1_balance_bottom=20.891, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.4, ups=0.12, wpb=780, bsz=64, num_updates=3880, lr=1.6615e-05, gnorm=2.772, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30084
2022-05-17 07:06:56 - progress_bar.py[line:272] - INFO: epoch 001:   3897 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=766.3, nsentences=64, sample_size=609.7, inner_loss=2.188, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.966, expert1_balance_bottom=21.181, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.1, ups=0.12, wpb=766.3, bsz=64, num_updates=3890, lr=1.6603e-05, gnorm=2.387, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30168
2022-05-17 07:08:21 - progress_bar.py[line:272] - INFO: epoch 001:   3907 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=763.5, nsentences=64, sample_size=607.7, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.218, expert1_balance_bottom=20.821, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=89.4, ups=0.12, wpb=763.5, bsz=64, num_updates=3900, lr=1.6591e-05, gnorm=2.791, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=30254
2022-05-17 07:09:44 - progress_bar.py[line:272] - INFO: epoch 001:   3917 / 8856 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=760.5, nsentences=64, sample_size=605.2, inner_loss=2.215, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.101, expert1_balance_bottom=20.933, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.4, ups=0.12, wpb=760.5, bsz=64, num_updates=3910, lr=1.6579e-05, gnorm=2.784, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30337
2022-05-17 07:11:08 - progress_bar.py[line:272] - INFO: epoch 001:   3927 / 8856 loss=3.292, loss_v1=0, loss_v2=0, nll_loss=0.961, ntokens=770, nsentences=64, sample_size=613, inner_loss=2.291, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.921, expert1_balance_bottom=21.043, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=91.7, ups=0.12, wpb=770, bsz=64, num_updates=3920, lr=1.6567e-05, gnorm=2.781, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30421
2022-05-17 07:12:32 - progress_bar.py[line:272] - INFO: epoch 001:   3937 / 8856 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=759.8, nsentences=64, sample_size=604.8, inner_loss=2.228, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.029, expert1_balance_bottom=21.26, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.2, ups=0.12, wpb=759.8, bsz=64, num_updates=3930, lr=1.6555e-05, gnorm=2.619, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30504
2022-05-17 07:13:55 - progress_bar.py[line:272] - INFO: epoch 001:   3947 / 8856 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=764.9, nsentences=64, sample_size=608.7, inner_loss=2.238, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.498, expert1_balance_bottom=20.841, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=91.3, ups=0.12, wpb=764.9, bsz=64, num_updates=3940, lr=1.65429e-05, gnorm=2.663, loss_scale=32, train_wall=33, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=30588
2022-05-17 07:15:18 - progress_bar.py[line:272] - INFO: epoch 001:   3957 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=773.4, nsentences=64, sample_size=615.6, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.002, expert1_balance_bottom=20.924, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=93.8, ups=0.12, wpb=773.4, bsz=64, num_updates=3950, lr=1.65309e-05, gnorm=2.626, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30670
2022-05-17 07:16:41 - progress_bar.py[line:272] - INFO: epoch 001:   3967 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=760.4, nsentences=64, sample_size=605.3, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.279, expert1_balance_bottom=20.781, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.2, ups=0.12, wpb=760.4, bsz=64, num_updates=3960, lr=1.65189e-05, gnorm=2.735, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30754
2022-05-17 07:18:06 - progress_bar.py[line:272] - INFO: epoch 001:   3977 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=774.6, nsentences=64, sample_size=616.8, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.914, expert1_balance_bottom=21.366, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.9, ups=0.12, wpb=774.6, bsz=64, num_updates=3970, lr=1.65069e-05, gnorm=2.649, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=30838
2022-05-17 07:19:29 - progress_bar.py[line:272] - INFO: epoch 001:   3987 / 8856 loss=3.294, loss_v1=0, loss_v2=0, nll_loss=0.964, ntokens=763.2, nsentences=64, sample_size=607.5, inner_loss=2.293, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.28, expert1_balance_bottom=21.062, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=91.7, ups=0.12, wpb=763.2, bsz=64, num_updates=3980, lr=1.64949e-05, gnorm=2.74, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=30921
2022-05-17 07:20:54 - progress_bar.py[line:272] - INFO: epoch 001:   3997 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=754.3, nsentences=64, sample_size=599.8, inner_loss=2.169, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.868, expert1_balance_bottom=20.856, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=88.9, ups=0.12, wpb=754.3, bsz=64, num_updates=3990, lr=1.64829e-05, gnorm=2.789, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=31006
2022-05-17 07:22:19 - progress_bar.py[line:272] - INFO: epoch 001:   4007 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=768.9, nsentences=64, sample_size=611.7, inner_loss=2.223, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.157, expert1_balance_bottom=20.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=89.9, ups=0.12, wpb=768.9, bsz=64, num_updates=4000, lr=1.64709e-05, gnorm=2.5, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=31092
2022-05-17 07:22:19 - train.py[line:456] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-17 07:22:21 - train.py[line:466] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-17 07:22:21 - train.py[line:494] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-17 07:29:04 - train.py[line:503] - INFO: valid_step finished
2022-05-17 07:29:04 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 11.315 | loss_v1 0 | loss_v2 0 | nll_loss 9.54 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | inner_loss 10.315 | moe_gate_loss 1 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.38 | expert1_balance_top 27.683 | expert1_balance_bottom 22.417 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 744.19 | cider 1.268 | wps 748.6 | wpb 481.7 | bsz 8 | num_updates 4000 | best_cider 1.268
2022-05-17 07:29:04 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 4000 updates
2022-05-17 07:29:04 - trainer.py[line:450] - INFO: Saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_4000.pt
2022-05-17 07:29:10 - trainer.py[line:460] - INFO: Finished saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_4000.pt
2022-05-17 07:29:20 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_4000.pt (epoch 1 @ 4000 updates, score 1.268) (writing took 16.473257002420723 seconds)
2022-05-17 07:30:37 - progress_bar.py[line:272] - INFO: epoch 001:   4017 / 8856 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=763, nsentences=64, sample_size=606.8, inner_loss=2.164, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.668, expert1_balance_bottom=21.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=15.3, ups=0.02, wpb=763, bsz=64, num_updates=4010, lr=1.64589e-05, gnorm=2.556, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=31590
2022-05-17 07:32:01 - progress_bar.py[line:272] - INFO: epoch 001:   4027 / 8856 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=770.5, nsentences=64, sample_size=613.1, inner_loss=2.242, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.115, expert1_balance_bottom=21.149, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=91.6, ups=0.12, wpb=770.5, bsz=64, num_updates=4020, lr=1.64468e-05, gnorm=2.679, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=31674
2022-05-17 07:33:26 - progress_bar.py[line:272] - INFO: epoch 001:   4037 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=771.2, nsentences=64, sample_size=613.7, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.008, expert1_balance_bottom=21.214, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.7, ups=0.12, wpb=771.2, bsz=64, num_updates=4030, lr=1.64348e-05, gnorm=2.479, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=31759
2022-05-17 07:34:50 - progress_bar.py[line:272] - INFO: epoch 001:   4047 / 8856 loss=3.244, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=764.2, nsentences=64, sample_size=608.2, inner_loss=2.243, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.068, expert1_balance_bottom=21.158, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=91.9, ups=0.12, wpb=764.2, bsz=64, num_updates=4040, lr=1.64228e-05, gnorm=2.81, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=31842
2022-05-17 07:36:15 - progress_bar.py[line:272] - INFO: epoch 001:   4057 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=762.1, nsentences=64, sample_size=606.3, inner_loss=2.209, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.951, expert1_balance_bottom=20.921, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=88.8, ups=0.12, wpb=762.1, bsz=64, num_updates=4050, lr=1.64108e-05, gnorm=2.819, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=31928
2022-05-17 07:37:40 - progress_bar.py[line:272] - INFO: epoch 001:   4067 / 8856 loss=3.273, loss_v1=0, loss_v2=0, nll_loss=0.943, ntokens=763.5, nsentences=64, sample_size=607.9, inner_loss=2.272, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.133, expert1_balance_bottom=21.061, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=90.6, ups=0.12, wpb=763.5, bsz=64, num_updates=4060, lr=1.63988e-05, gnorm=2.665, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32012
2022-05-17 07:39:02 - progress_bar.py[line:272] - INFO: epoch 001:   4077 / 8856 loss=3.251, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=766.1, nsentences=64, sample_size=610.1, inner_loss=2.25, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.267, expert1_balance_bottom=21.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=92.7, ups=0.12, wpb=766.1, bsz=64, num_updates=4070, lr=1.63868e-05, gnorm=2.385, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=32095
2022-05-17 07:40:27 - progress_bar.py[line:272] - INFO: epoch 001:   4087 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=770.9, nsentences=64, sample_size=613.8, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.31, expert1_balance_bottom=21.117, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.4, ups=0.12, wpb=770.9, bsz=64, num_updates=4080, lr=1.63748e-05, gnorm=2.707, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32179
2022-05-17 07:41:50 - progress_bar.py[line:272] - INFO: epoch 001:   4097 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=760.6, nsentences=64, sample_size=605.1, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.417, expert1_balance_bottom=21.132, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91, ups=0.12, wpb=760.6, bsz=64, num_updates=4090, lr=1.63628e-05, gnorm=2.509, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32263
2022-05-17 07:43:14 - progress_bar.py[line:272] - INFO: epoch 001:   4107 / 8856 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=757.8, nsentences=64, sample_size=602.7, inner_loss=2.158, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.612, expert1_balance_bottom=21.402, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=90.3, ups=0.12, wpb=757.8, bsz=64, num_updates=4100, lr=1.63508e-05, gnorm=2.118, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32347
2022-05-17 07:44:35 - progress_bar.py[line:272] - INFO: epoch 001:   4117 / 8856 loss=3.276, loss_v1=0, loss_v2=0, nll_loss=0.942, ntokens=753.4, nsentences=64, sample_size=599.4, inner_loss=2.274, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.508, expert1_balance_bottom=20.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=92.6, ups=0.12, wpb=753.4, bsz=64, num_updates=4110, lr=1.63387e-05, gnorm=2.673, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32428
2022-05-17 07:46:00 - progress_bar.py[line:272] - INFO: epoch 001:   4127 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=770.7, nsentences=64, sample_size=613.2, inner_loss=2.209, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.158, expert1_balance_bottom=21.015, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.6, ups=0.12, wpb=770.7, bsz=64, num_updates=4120, lr=1.63267e-05, gnorm=2.589, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=32512
2022-05-17 07:47:24 - progress_bar.py[line:272] - INFO: epoch 001:   4137 / 8856 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=775.3, nsentences=64, sample_size=617.3, inner_loss=2.215, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.255, expert1_balance_bottom=21.141, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.1, ups=0.12, wpb=775.3, bsz=64, num_updates=4130, lr=1.63147e-05, gnorm=2.483, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32596
2022-05-17 07:48:45 - progress_bar.py[line:272] - INFO: epoch 001:   4147 / 8856 loss=3.255, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=760.3, nsentences=64, sample_size=605.2, inner_loss=2.254, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.127, expert1_balance_bottom=21.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=93.2, ups=0.12, wpb=760.3, bsz=64, num_updates=4140, lr=1.63027e-05, gnorm=2.556, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32678
2022-05-17 07:50:08 - progress_bar.py[line:272] - INFO: epoch 001:   4157 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=766.1, nsentences=64, sample_size=609.4, inner_loss=2.208, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.176, expert1_balance_bottom=20.772, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.6, ups=0.12, wpb=766.1, bsz=64, num_updates=4150, lr=1.62907e-05, gnorm=2.733, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32761
2022-05-17 07:51:31 - progress_bar.py[line:272] - INFO: epoch 001:   4167 / 8856 loss=3.265, loss_v1=0, loss_v2=0, nll_loss=0.934, ntokens=754, nsentences=64, sample_size=599.8, inner_loss=2.264, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.794, expert1_balance_bottom=21.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=90.9, ups=0.12, wpb=754, bsz=64, num_updates=4160, lr=1.62787e-05, gnorm=2.565, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=32843
2022-05-17 07:52:55 - progress_bar.py[line:272] - INFO: epoch 001:   4177 / 8856 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=759.6, nsentences=64, sample_size=604.2, inner_loss=2.205, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.394, expert1_balance_bottom=21.233, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.4, ups=0.12, wpb=759.6, bsz=64, num_updates=4170, lr=1.62667e-05, gnorm=2.505, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=32928
2022-05-17 07:54:19 - progress_bar.py[line:272] - INFO: epoch 001:   4187 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=770.7, nsentences=64, sample_size=613.1, inner_loss=2.223, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.266, expert1_balance_bottom=21.331, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.5, ups=0.12, wpb=770.7, bsz=64, num_updates=4180, lr=1.62547e-05, gnorm=2.432, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33012
2022-05-17 07:55:43 - progress_bar.py[line:272] - INFO: epoch 001:   4197 / 8856 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=760.3, nsentences=64, sample_size=605.3, inner_loss=2.215, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.158, expert1_balance_bottom=21.257, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.8, ups=0.12, wpb=760.3, bsz=64, num_updates=4190, lr=1.62426e-05, gnorm=2.785, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33096
2022-05-17 07:57:08 - progress_bar.py[line:272] - INFO: epoch 001:   4207 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=776.6, nsentences=64, sample_size=617.9, inner_loss=2.209, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.13, expert1_balance_bottom=21.189, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.8, ups=0.12, wpb=776.6, bsz=64, num_updates=4200, lr=1.62306e-05, gnorm=2.401, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33180
2022-05-17 07:58:08 - progress_bar.py[line:272] - INFO: epoch 001:   4217 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=771.5, nsentences=64, sample_size=614.3, inner_loss=2.224, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.43, expert1_balance_bottom=21.084, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=127.7, ups=0.17, wpb=771.5, bsz=64, num_updates=4210, lr=1.62186e-05, gnorm=2.493, loss_scale=64, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33241
2022-05-17 07:58:45 - progress_bar.py[line:272] - INFO: epoch 001:   4227 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=762, nsentences=64, sample_size=606.5, inner_loss=2.202, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.452, expert1_balance_bottom=20.978, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.8, ups=0.27, wpb=762, bsz=64, num_updates=4220, lr=1.62066e-05, gnorm=2.39, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33277
2022-05-17 07:59:22 - progress_bar.py[line:272] - INFO: epoch 001:   4237 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=763.5, nsentences=64, sample_size=608.1, inner_loss=2.205, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.27, expert1_balance_bottom=20.943, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=204.2, ups=0.27, wpb=763.5, bsz=64, num_updates=4230, lr=1.61946e-05, gnorm=2.574, loss_scale=64, train_wall=32, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=33315
2022-05-17 08:00:00 - progress_bar.py[line:272] - INFO: epoch 001:   4247 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=775.1, nsentences=64, sample_size=616.8, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.323, expert1_balance_bottom=21.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=208.4, ups=0.27, wpb=775.1, bsz=64, num_updates=4240, lr=1.61826e-05, gnorm=2.713, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33352
2022-05-17 08:00:38 - progress_bar.py[line:272] - INFO: epoch 001:   4257 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=768.3, nsentences=64, sample_size=611.4, inner_loss=2.232, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.414, expert1_balance_bottom=21.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=201.5, ups=0.26, wpb=768.3, bsz=64, num_updates=4250, lr=1.61706e-05, gnorm=2.878, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33390
2022-05-17 08:01:14 - progress_bar.py[line:272] - INFO: epoch 001:   4267 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=766.3, nsentences=64, sample_size=609.8, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.994, expert1_balance_bottom=21.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=213.9, ups=0.28, wpb=766.3, bsz=64, num_updates=4260, lr=1.61586e-05, gnorm=2.598, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33426
2022-05-17 08:01:50 - progress_bar.py[line:272] - INFO: epoch 001:   4277 / 8856 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=764, nsentences=64, sample_size=608.3, inner_loss=2.233, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.309, expert1_balance_bottom=20.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=207.6, ups=0.27, wpb=764, bsz=64, num_updates=4270, lr=1.61465e-05, gnorm=2.49, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33463
2022-05-17 08:02:27 - progress_bar.py[line:272] - INFO: epoch 001:   4287 / 8856 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=764.1, nsentences=64, sample_size=608.3, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.889, expert1_balance_bottom=21.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=208.3, ups=0.27, wpb=764.1, bsz=64, num_updates=4280, lr=1.61345e-05, gnorm=2.399, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33499
2022-05-17 08:03:04 - progress_bar.py[line:272] - INFO: epoch 001:   4297 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=752.7, nsentences=64, sample_size=598.6, inner_loss=2.228, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.012, expert1_balance_bottom=20.992, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=205.4, ups=0.27, wpb=752.7, bsz=64, num_updates=4290, lr=1.61225e-05, gnorm=2.577, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33536
2022-05-17 08:03:39 - progress_bar.py[line:272] - INFO: epoch 001:   4307 / 8856 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=756.6, nsentences=64, sample_size=601.9, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.302, expert1_balance_bottom=21.008, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=216.8, ups=0.29, wpb=756.6, bsz=64, num_updates=4300, lr=1.61105e-05, gnorm=2.613, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33571
2022-05-17 08:04:16 - progress_bar.py[line:272] - INFO: epoch 001:   4317 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=756.5, nsentences=64, sample_size=602.1, inner_loss=2.232, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.355, expert1_balance_bottom=21.101, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=204.7, ups=0.27, wpb=756.5, bsz=64, num_updates=4310, lr=1.60985e-05, gnorm=2.679, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33608
2022-05-17 08:04:52 - progress_bar.py[line:272] - INFO: epoch 001:   4327 / 8856 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=762.7, nsentences=64, sample_size=607.1, inner_loss=2.226, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.13, expert1_balance_bottom=21.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209.6, ups=0.27, wpb=762.7, bsz=64, num_updates=4320, lr=1.60865e-05, gnorm=2.721, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33644
2022-05-17 08:05:34 - progress_bar.py[line:272] - INFO: epoch 001:   4337 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=774.2, nsentences=64, sample_size=615.8, inner_loss=2.173, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.725, expert1_balance_bottom=21.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=185.3, ups=0.24, wpb=774.2, bsz=64, num_updates=4330, lr=1.60745e-05, gnorm=2.694, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33686
2022-05-17 08:06:57 - progress_bar.py[line:272] - INFO: epoch 001:   4347 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=757.1, nsentences=64, sample_size=602.2, inner_loss=2.197, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.664, expert1_balance_bottom=21.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.4, ups=0.12, wpb=757.1, bsz=64, num_updates=4340, lr=1.60625e-05, gnorm=2.508, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33769
2022-05-17 08:08:20 - progress_bar.py[line:272] - INFO: epoch 001:   4357 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=768.4, nsentences=64, sample_size=611.7, inner_loss=2.188, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.915, expert1_balance_bottom=21.344, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.6, ups=0.12, wpb=768.4, bsz=64, num_updates=4350, lr=1.60505e-05, gnorm=2.376, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=33853
2022-05-17 08:09:44 - progress_bar.py[line:272] - INFO: epoch 001:   4367 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=762.6, nsentences=64, sample_size=607, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.348, expert1_balance_bottom=20.963, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=90.9, ups=0.12, wpb=762.6, bsz=64, num_updates=4360, lr=1.60384e-05, gnorm=2.693, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=33937
2022-05-17 08:11:09 - progress_bar.py[line:272] - INFO: epoch 001:   4377 / 8856 loss=3.282, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=760.2, nsentences=64, sample_size=604.7, inner_loss=2.28, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.736, expert1_balance_bottom=21.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=89.8, ups=0.12, wpb=760.2, bsz=64, num_updates=4370, lr=1.60264e-05, gnorm=2.472, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34021
2022-05-17 08:12:33 - progress_bar.py[line:272] - INFO: epoch 001:   4387 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=755.7, nsentences=64, sample_size=601.1, inner_loss=2.194, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.139, expert1_balance_bottom=21.192, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.3, ups=0.12, wpb=755.7, bsz=64, num_updates=4380, lr=1.60144e-05, gnorm=2.318, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34105
2022-05-17 08:13:57 - progress_bar.py[line:272] - INFO: epoch 001:   4397 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=755.6, nsentences=64, sample_size=601, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.152, expert1_balance_bottom=21.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=89.9, ups=0.12, wpb=755.6, bsz=64, num_updates=4390, lr=1.60024e-05, gnorm=2.703, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34189
2022-05-17 08:15:19 - progress_bar.py[line:272] - INFO: epoch 001:   4407 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=756, nsentences=64, sample_size=601.6, inner_loss=2.223, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.437, expert1_balance_bottom=21.09, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.7, ups=0.12, wpb=756, bsz=64, num_updates=4400, lr=1.59904e-05, gnorm=3.197, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34272
2022-05-17 08:16:43 - progress_bar.py[line:272] - INFO: epoch 001:   4417 / 8856 loss=3.236, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=769.1, nsentences=64, sample_size=612.3, inner_loss=2.235, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.316, expert1_balance_bottom=21.007, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92, ups=0.12, wpb=769.1, bsz=64, num_updates=4410, lr=1.59784e-05, gnorm=2.944, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34355
2022-05-17 08:18:07 - progress_bar.py[line:272] - INFO: epoch 001:   4427 / 8856 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.818, ntokens=758.8, nsentences=64, sample_size=603.6, inner_loss=2.154, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.186, expert1_balance_bottom=21.258, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=90.5, ups=0.12, wpb=758.8, bsz=64, num_updates=4420, lr=1.59664e-05, gnorm=2.461, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34439
2022-05-17 08:19:30 - progress_bar.py[line:272] - INFO: epoch 001:   4437 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=781.2, nsentences=64, sample_size=621.9, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.978, expert1_balance_bottom=21.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=93.7, ups=0.12, wpb=781.2, bsz=64, num_updates=4430, lr=1.59544e-05, gnorm=2.285, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=34522
2022-05-17 08:20:54 - progress_bar.py[line:272] - INFO: epoch 001:   4447 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=782.8, nsentences=64, sample_size=623.4, inner_loss=2.222, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.353, expert1_balance_bottom=20.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=93.5, ups=0.12, wpb=782.8, bsz=64, num_updates=4440, lr=1.59423e-05, gnorm=2.429, loss_scale=64, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34606
2022-05-17 08:22:17 - progress_bar.py[line:272] - INFO: epoch 001:   4457 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=779.7, nsentences=64, sample_size=620.1, inner_loss=2.209, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.245, expert1_balance_bottom=21.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=93.2, ups=0.12, wpb=779.7, bsz=64, num_updates=4450, lr=1.59303e-05, gnorm=2.561, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34690
2022-05-17 08:23:39 - progress_bar.py[line:272] - INFO: epoch 001:   4467 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=761.8, nsentences=64, sample_size=606.4, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.11, expert1_balance_bottom=21.195, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=93.1, ups=0.12, wpb=761.8, bsz=64, num_updates=4460, lr=1.59183e-05, gnorm=2.408, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34772
2022-05-17 08:24:55 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-17 08:25:11 - progress_bar.py[line:272] - INFO: epoch 001:   4478 / 8856 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=768.8, nsentences=64, sample_size=611.6, inner_loss=2.251, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.484, expert1_balance_bottom=20.904, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=83.4, ups=0.11, wpb=768.8, bsz=64, num_updates=4470, lr=1.59063e-05, gnorm=2.651, loss_scale=64, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=34864
2022-05-17 08:26:35 - progress_bar.py[line:272] - INFO: epoch 001:   4488 / 8856 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=769.1, nsentences=64, sample_size=612.2, inner_loss=2.226, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.062, expert1_balance_bottom=21.08, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92.3, ups=0.12, wpb=769.1, bsz=64, num_updates=4480, lr=1.58943e-05, gnorm=2.596, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=34947
2022-05-17 08:27:58 - progress_bar.py[line:272] - INFO: epoch 001:   4498 / 8856 loss=3.281, loss_v1=0, loss_v2=0, nll_loss=0.952, ntokens=763.2, nsentences=64, sample_size=607.3, inner_loss=2.279, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.147, expert1_balance_bottom=21.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=91.9, ups=0.12, wpb=763.2, bsz=64, num_updates=4490, lr=1.58823e-05, gnorm=2.84, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35030
2022-05-17 08:29:20 - progress_bar.py[line:272] - INFO: epoch 001:   4508 / 8856 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=763, nsentences=64, sample_size=607.3, inner_loss=2.226, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.766, expert1_balance_bottom=21.293, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=93, ups=0.12, wpb=763, bsz=64, num_updates=4500, lr=1.58703e-05, gnorm=2.504, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35112
2022-05-17 08:30:45 - progress_bar.py[line:272] - INFO: epoch 001:   4518 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=761.9, nsentences=64, sample_size=606.1, inner_loss=2.218, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.566, expert1_balance_bottom=21.535, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=89, ups=0.12, wpb=761.9, bsz=64, num_updates=4510, lr=1.58583e-05, gnorm=2.44, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35198
2022-05-17 08:32:10 - progress_bar.py[line:272] - INFO: epoch 001:   4528 / 8856 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=763.9, nsentences=64, sample_size=607.8, inner_loss=2.201, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.99, expert1_balance_bottom=21.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.5, ups=0.12, wpb=763.9, bsz=64, num_updates=4520, lr=1.58462e-05, gnorm=2.649, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=35282
2022-05-17 08:33:33 - progress_bar.py[line:272] - INFO: epoch 001:   4538 / 8856 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=760.8, nsentences=64, sample_size=605.4, inner_loss=2.238, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.63, expert1_balance_bottom=20.768, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=91.9, ups=0.12, wpb=760.8, bsz=64, num_updates=4530, lr=1.58342e-05, gnorm=2.519, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35365
2022-05-17 08:34:56 - progress_bar.py[line:272] - INFO: epoch 001:   4548 / 8856 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=753.8, nsentences=64, sample_size=599.9, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.955, expert1_balance_bottom=21.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=90.7, ups=0.12, wpb=753.8, bsz=64, num_updates=4540, lr=1.58222e-05, gnorm=2.444, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35448
2022-05-17 08:36:20 - progress_bar.py[line:272] - INFO: epoch 001:   4558 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=764.9, nsentences=64, sample_size=608.7, inner_loss=2.206, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.114, expert1_balance_bottom=21.295, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.8, ups=0.12, wpb=764.9, bsz=64, num_updates=4550, lr=1.58102e-05, gnorm=2.585, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35532
2022-05-17 08:37:43 - progress_bar.py[line:272] - INFO: epoch 001:   4568 / 8856 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=763.3, nsentences=64, sample_size=607.1, inner_loss=2.192, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.9, expert1_balance_bottom=21.378, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.4, ups=0.12, wpb=763.3, bsz=64, num_updates=4560, lr=1.57982e-05, gnorm=2.313, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35616
2022-05-17 08:39:07 - progress_bar.py[line:272] - INFO: epoch 001:   4578 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=760.3, nsentences=64, sample_size=605, inner_loss=2.168, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.798, expert1_balance_bottom=21.368, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.8, ups=0.12, wpb=760.3, bsz=64, num_updates=4570, lr=1.57862e-05, gnorm=2.569, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35700
2022-05-17 08:40:30 - progress_bar.py[line:272] - INFO: epoch 001:   4588 / 8856 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=760.8, nsentences=64, sample_size=605.2, inner_loss=2.225, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.123, expert1_balance_bottom=21.518, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.6, ups=0.12, wpb=760.8, bsz=64, num_updates=4580, lr=1.57742e-05, gnorm=2.573, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35783
2022-05-17 08:41:53 - progress_bar.py[line:272] - INFO: epoch 001:   4598 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=763.5, nsentences=64, sample_size=608.1, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.569, expert1_balance_bottom=21.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.9, ups=0.12, wpb=763.5, bsz=64, num_updates=4590, lr=1.57622e-05, gnorm=2.248, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35866
2022-05-17 08:43:15 - progress_bar.py[line:272] - INFO: epoch 001:   4608 / 8856 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=764.8, nsentences=64, sample_size=609, inner_loss=2.255, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.209, expert1_balance_bottom=21.299, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=93.7, ups=0.12, wpb=764.8, bsz=64, num_updates=4600, lr=1.57502e-05, gnorm=2.583, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=35947
2022-05-17 08:44:40 - progress_bar.py[line:272] - INFO: epoch 001:   4618 / 8856 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=766.4, nsentences=64, sample_size=610.1, inner_loss=2.251, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.135, expert1_balance_bottom=21.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=90.5, ups=0.12, wpb=766.4, bsz=64, num_updates=4610, lr=1.57381e-05, gnorm=2.615, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36032
2022-05-17 08:46:03 - progress_bar.py[line:272] - INFO: epoch 001:   4628 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=754.5, nsentences=64, sample_size=600.3, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.134, expert1_balance_bottom=20.969, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.1, ups=0.12, wpb=754.5, bsz=64, num_updates=4620, lr=1.57261e-05, gnorm=2.688, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36116
2022-05-17 08:47:27 - progress_bar.py[line:272] - INFO: epoch 001:   4638 / 8856 loss=3.236, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=764.7, nsentences=64, sample_size=608.6, inner_loss=2.235, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.529, expert1_balance_bottom=21.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=91.3, ups=0.12, wpb=764.7, bsz=64, num_updates=4630, lr=1.57141e-05, gnorm=2.587, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36200
2022-05-17 08:48:50 - progress_bar.py[line:272] - INFO: epoch 001:   4648 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=759.5, nsentences=64, sample_size=604.4, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.451, expert1_balance_bottom=20.961, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.8, ups=0.12, wpb=759.5, bsz=64, num_updates=4640, lr=1.57021e-05, gnorm=2.677, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36282
2022-05-17 08:50:15 - progress_bar.py[line:272] - INFO: epoch 001:   4658 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=769.8, nsentences=64, sample_size=612.3, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.911, expert1_balance_bottom=21.164, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.6, ups=0.12, wpb=769.8, bsz=64, num_updates=4650, lr=1.56901e-05, gnorm=2.807, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36367
2022-05-17 08:51:38 - progress_bar.py[line:272] - INFO: epoch 001:   4668 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=768.1, nsentences=64, sample_size=611.1, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.621, expert1_balance_bottom=21.711, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.2, ups=0.12, wpb=768.1, bsz=64, num_updates=4660, lr=1.56781e-05, gnorm=2.501, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36451
2022-05-17 08:53:01 - progress_bar.py[line:272] - INFO: epoch 001:   4678 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=772.3, nsentences=64, sample_size=614.4, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.685, expert1_balance_bottom=21.504, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=92.9, ups=0.12, wpb=772.3, bsz=64, num_updates=4670, lr=1.56661e-05, gnorm=2.446, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36534
2022-05-17 08:54:24 - progress_bar.py[line:272] - INFO: epoch 001:   4688 / 8856 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=764.3, nsentences=64, sample_size=608.2, inner_loss=2.19, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.221, expert1_balance_bottom=21.305, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.7, ups=0.12, wpb=764.3, bsz=64, num_updates=4680, lr=1.56541e-05, gnorm=2.8, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36616
2022-05-17 08:55:48 - progress_bar.py[line:272] - INFO: epoch 001:   4698 / 8856 loss=3.233, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=751.6, nsentences=64, sample_size=597.9, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.035, expert1_balance_bottom=20.993, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=89, ups=0.12, wpb=751.6, bsz=64, num_updates=4690, lr=1.5642e-05, gnorm=2.48, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36701
2022-05-17 08:57:12 - progress_bar.py[line:272] - INFO: epoch 001:   4708 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=756.7, nsentences=64, sample_size=602.5, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.027, expert1_balance_bottom=21.15, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.4, ups=0.12, wpb=756.7, bsz=64, num_updates=4700, lr=1.563e-05, gnorm=2.399, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36784
2022-05-17 08:58:35 - progress_bar.py[line:272] - INFO: epoch 001:   4718 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=760.5, nsentences=64, sample_size=605, inner_loss=2.202, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.894, expert1_balance_bottom=21.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.1, ups=0.12, wpb=760.5, bsz=64, num_updates=4710, lr=1.5618e-05, gnorm=2.484, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36867
2022-05-17 08:59:59 - progress_bar.py[line:272] - INFO: epoch 001:   4728 / 8856 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=772.5, nsentences=64, sample_size=614.8, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.846, expert1_balance_bottom=21.336, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.3, ups=0.12, wpb=772.5, bsz=64, num_updates=4720, lr=1.5606e-05, gnorm=2.417, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=36952
2022-05-17 09:01:23 - progress_bar.py[line:272] - INFO: epoch 001:   4738 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=760.6, nsentences=64, sample_size=605.5, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.869, expert1_balance_bottom=21.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91, ups=0.12, wpb=760.6, bsz=64, num_updates=4730, lr=1.5594e-05, gnorm=2.471, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37035
2022-05-17 09:02:47 - progress_bar.py[line:272] - INFO: epoch 001:   4748 / 8856 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=756.7, nsentences=64, sample_size=602.2, inner_loss=2.242, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.322, expert1_balance_bottom=20.914, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=89.7, ups=0.12, wpb=756.7, bsz=64, num_updates=4740, lr=1.5582e-05, gnorm=2.627, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37120
2022-05-17 09:04:11 - progress_bar.py[line:272] - INFO: epoch 001:   4758 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=771, nsentences=64, sample_size=613.1, inner_loss=2.235, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.2, expert1_balance_bottom=21.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=91.4, ups=0.12, wpb=771, bsz=64, num_updates=4750, lr=1.557e-05, gnorm=2.597, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37204
2022-05-17 09:05:35 - progress_bar.py[line:272] - INFO: epoch 001:   4768 / 8856 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=759.1, nsentences=64, sample_size=604.3, inner_loss=2.226, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.132, expert1_balance_bottom=21.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.4, ups=0.12, wpb=759.1, bsz=64, num_updates=4760, lr=1.5558e-05, gnorm=2.469, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37288
2022-05-17 09:06:59 - progress_bar.py[line:272] - INFO: epoch 001:   4778 / 8856 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=772.8, nsentences=64, sample_size=615.5, inner_loss=2.171, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.287, expert1_balance_bottom=20.984, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=92.7, ups=0.12, wpb=772.8, bsz=64, num_updates=4770, lr=1.55459e-05, gnorm=2.558, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37371
2022-05-17 09:08:22 - progress_bar.py[line:272] - INFO: epoch 001:   4788 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=764.2, nsentences=64, sample_size=608.1, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.126, expert1_balance_bottom=21.087, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.4, ups=0.12, wpb=764.2, bsz=64, num_updates=4780, lr=1.55339e-05, gnorm=2.481, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37455
2022-05-17 09:09:45 - progress_bar.py[line:272] - INFO: epoch 001:   4798 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.911, ntokens=762.1, nsentences=64, sample_size=605.9, inner_loss=2.237, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.668, expert1_balance_bottom=21.639, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=92.8, ups=0.12, wpb=762.1, bsz=64, num_updates=4790, lr=1.55219e-05, gnorm=2.509, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37537
2022-05-17 09:11:07 - progress_bar.py[line:272] - INFO: epoch 001:   4808 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=756.5, nsentences=64, sample_size=602.6, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.526, expert1_balance_bottom=21.685, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.3, ups=0.12, wpb=756.5, bsz=64, num_updates=4800, lr=1.55099e-05, gnorm=2.213, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37620
2022-05-17 09:12:30 - progress_bar.py[line:272] - INFO: epoch 001:   4818 / 8856 loss=3.281, loss_v1=0, loss_v2=0, nll_loss=0.956, ntokens=759.8, nsentences=64, sample_size=604.6, inner_loss=2.279, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.98, expert1_balance_bottom=20.903, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=92.1, ups=0.12, wpb=759.8, bsz=64, num_updates=4810, lr=1.54979e-05, gnorm=2.812, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37702
2022-05-17 09:13:55 - progress_bar.py[line:272] - INFO: epoch 001:   4828 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=750.2, nsentences=64, sample_size=596.9, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.359, expert1_balance_bottom=21.142, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=88.1, ups=0.12, wpb=750.2, bsz=64, num_updates=4820, lr=1.54859e-05, gnorm=2.743, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37788
2022-05-17 09:15:19 - progress_bar.py[line:272] - INFO: epoch 001:   4838 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=765.2, nsentences=64, sample_size=609.1, inner_loss=2.209, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.777, expert1_balance_bottom=21.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.8, ups=0.12, wpb=765.2, bsz=64, num_updates=4830, lr=1.54739e-05, gnorm=2.405, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37872
2022-05-17 09:16:44 - progress_bar.py[line:272] - INFO: epoch 001:   4848 / 8856 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=769.2, nsentences=64, sample_size=612.3, inner_loss=2.164, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.807, expert1_balance_bottom=21.288, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.9, ups=0.12, wpb=769.2, bsz=64, num_updates=4840, lr=1.54619e-05, gnorm=2.394, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=37956
2022-05-17 09:18:08 - progress_bar.py[line:272] - INFO: epoch 001:   4858 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.906, ntokens=762.1, nsentences=64, sample_size=606.6, inner_loss=2.237, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.131, expert1_balance_bottom=21.42, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=90.8, ups=0.12, wpb=762.1, bsz=64, num_updates=4850, lr=1.54498e-05, gnorm=2.351, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38040
2022-05-17 09:19:33 - progress_bar.py[line:272] - INFO: epoch 001:   4868 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=761.2, nsentences=64, sample_size=605.2, inner_loss=2.235, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.302, expert1_balance_bottom=21.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=89.5, ups=0.12, wpb=761.2, bsz=64, num_updates=4860, lr=1.54378e-05, gnorm=2.476, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38125
2022-05-17 09:20:55 - progress_bar.py[line:272] - INFO: epoch 001:   4878 / 8856 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=767.8, nsentences=64, sample_size=610.7, inner_loss=2.163, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.786, expert1_balance_bottom=20.807, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=93.6, ups=0.12, wpb=767.8, bsz=64, num_updates=4870, lr=1.54258e-05, gnorm=2.683, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38207
2022-05-17 09:22:19 - progress_bar.py[line:272] - INFO: epoch 001:   4888 / 8856 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=790.1, nsentences=64, sample_size=629.4, inner_loss=2.16, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.944, expert1_balance_bottom=21.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=94.2, ups=0.12, wpb=790.1, bsz=64, num_updates=4880, lr=1.54138e-05, gnorm=2.642, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38291
2022-05-17 09:23:41 - progress_bar.py[line:272] - INFO: epoch 001:   4898 / 8856 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=770.3, nsentences=64, sample_size=613.3, inner_loss=2.243, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.934, expert1_balance_bottom=21.335, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=93.5, ups=0.12, wpb=770.3, bsz=64, num_updates=4890, lr=1.54018e-05, gnorm=3.122, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38374
2022-05-17 09:25:06 - progress_bar.py[line:272] - INFO: epoch 001:   4908 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=775.9, nsentences=64, sample_size=617.9, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.924, expert1_balance_bottom=21.271, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.7, ups=0.12, wpb=775.9, bsz=64, num_updates=4900, lr=1.53898e-05, gnorm=2.447, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38458
2022-05-17 09:26:30 - progress_bar.py[line:272] - INFO: epoch 001:   4918 / 8856 loss=3.253, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=781.6, nsentences=64, sample_size=622.2, inner_loss=2.252, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=29.2, expert1_balance_bottom=21.036, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=92.9, ups=0.12, wpb=781.6, bsz=64, num_updates=4910, lr=1.53778e-05, gnorm=2.591, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38542
2022-05-17 09:27:54 - progress_bar.py[line:272] - INFO: epoch 001:   4928 / 8856 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=757.2, nsentences=64, sample_size=602.6, inner_loss=2.22, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.792, expert1_balance_bottom=21.814, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.1, ups=0.12, wpb=757.2, bsz=64, num_updates=4920, lr=1.53658e-05, gnorm=2.432, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=38626
2022-05-17 09:29:18 - progress_bar.py[line:272] - INFO: epoch 001:   4938 / 8856 loss=3.246, loss_v1=0, loss_v2=0, nll_loss=0.921, ntokens=754.6, nsentences=64, sample_size=600.7, inner_loss=2.245, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.17, expert1_balance_bottom=21.363, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=90.2, ups=0.12, wpb=754.6, bsz=64, num_updates=4930, lr=1.53538e-05, gnorm=2.921, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38710
2022-05-17 09:30:42 - progress_bar.py[line:272] - INFO: epoch 001:   4948 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=771.9, nsentences=64, sample_size=614.7, inner_loss=2.218, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.381, expert1_balance_top=29.32, expert1_balance_bottom=21.113, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.1, ups=0.12, wpb=771.9, bsz=64, num_updates=4940, lr=1.53417e-05, gnorm=2.631, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38795
2022-05-17 09:32:05 - progress_bar.py[line:272] - INFO: epoch 001:   4958 / 8856 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=772.9, nsentences=64, sample_size=615, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.22, expert1_balance_bottom=21.053, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=93.5, ups=0.12, wpb=772.9, bsz=64, num_updates=4950, lr=1.53297e-05, gnorm=2.358, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38878
2022-05-17 09:33:29 - progress_bar.py[line:272] - INFO: epoch 001:   4968 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=765.5, nsentences=64, sample_size=609, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.585, expert1_balance_bottom=21.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.2, ups=0.12, wpb=765.5, bsz=64, num_updates=4960, lr=1.53177e-05, gnorm=2.475, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=38961
2022-05-17 09:34:52 - progress_bar.py[line:272] - INFO: epoch 001:   4978 / 8856 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=758.5, nsentences=64, sample_size=603.2, inner_loss=2.239, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.082, expert1_balance_bottom=21.032, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=91.3, ups=0.12, wpb=758.5, bsz=64, num_updates=4970, lr=1.53057e-05, gnorm=2.615, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39045
2022-05-17 09:36:17 - progress_bar.py[line:272] - INFO: epoch 001:   4988 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=780.4, nsentences=64, sample_size=620.8, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.998, expert1_balance_bottom=21.13, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=92.1, ups=0.12, wpb=780.4, bsz=64, num_updates=4980, lr=1.52937e-05, gnorm=2.336, loss_scale=128, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39129
2022-05-17 09:37:41 - progress_bar.py[line:272] - INFO: epoch 001:   4998 / 8856 loss=3.24, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=773.3, nsentences=64, sample_size=615.4, inner_loss=2.239, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.936, expert1_balance_bottom=21.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.2, ups=0.12, wpb=773.3, bsz=64, num_updates=4990, lr=1.52817e-05, gnorm=2.656, loss_scale=128, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39213
2022-05-17 09:39:06 - progress_bar.py[line:272] - INFO: epoch 001:   5008 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=767.4, nsentences=64, sample_size=610.8, inner_loss=2.206, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.748, expert1_balance_bottom=21.446, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.5, ups=0.12, wpb=767.4, bsz=64, num_updates=5000, lr=1.52697e-05, gnorm=2.844, loss_scale=128, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39298
2022-05-17 09:40:30 - progress_bar.py[line:272] - INFO: epoch 001:   5018 / 8856 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=766.3, nsentences=64, sample_size=609.6, inner_loss=2.225, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.997, expert1_balance_bottom=21.521, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.3, ups=0.12, wpb=766.3, bsz=64, num_updates=5010, lr=1.52577e-05, gnorm=2.506, loss_scale=128, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39382
2022-05-17 09:41:52 - progress_bar.py[line:272] - INFO: epoch 001:   5028 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=767.5, nsentences=64, sample_size=610.5, inner_loss=2.191, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.185, expert1_balance_bottom=21.403, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.5, ups=0.12, wpb=767.5, bsz=64, num_updates=5020, lr=1.52456e-05, gnorm=2.577, loss_scale=128, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=39465
2022-05-17 09:43:07 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-17 09:43:24 - progress_bar.py[line:272] - INFO: epoch 001:   5039 / 8856 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=0.945, ntokens=770.1, nsentences=64, sample_size=612.9, inner_loss=2.273, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.149, expert1_balance_bottom=21.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.93, wps=83.8, ups=0.11, wpb=770.1, bsz=64, num_updates=5030, lr=1.52336e-05, gnorm=2.382, loss_scale=64, train_wall=38, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=39557
2022-05-17 09:44:48 - progress_bar.py[line:272] - INFO: epoch 001:   5049 / 8856 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=768.5, nsentences=64, sample_size=611.5, inner_loss=2.149, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.683, expert1_balance_bottom=21.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=92.1, ups=0.12, wpb=768.5, bsz=64, num_updates=5040, lr=1.52216e-05, gnorm=2.753, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39640
2022-05-17 09:46:12 - progress_bar.py[line:272] - INFO: epoch 001:   5059 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=756.6, nsentences=64, sample_size=602.1, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.588, expert1_balance_bottom=21.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=89.6, ups=0.12, wpb=756.6, bsz=64, num_updates=5050, lr=1.52096e-05, gnorm=2.768, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=39725
2022-05-17 09:47:36 - progress_bar.py[line:272] - INFO: epoch 001:   5069 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=768.6, nsentences=64, sample_size=612, inner_loss=2.23, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.257, expert1_balance_bottom=21.104, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92, ups=0.12, wpb=768.6, bsz=64, num_updates=5060, lr=1.51976e-05, gnorm=2.445, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39808
2022-05-17 09:49:00 - progress_bar.py[line:272] - INFO: epoch 001:   5079 / 8856 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=759, nsentences=64, sample_size=603.7, inner_loss=2.152, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.319, expert1_balance_bottom=21.485, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=90.8, ups=0.12, wpb=759, bsz=64, num_updates=5070, lr=1.51856e-05, gnorm=2.689, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39892
2022-05-17 09:50:23 - progress_bar.py[line:272] - INFO: epoch 001:   5089 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=772.7, nsentences=64, sample_size=615, inner_loss=2.19, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.943, expert1_balance_bottom=21.362, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.7, ups=0.12, wpb=772.7, bsz=64, num_updates=5080, lr=1.51736e-05, gnorm=2.566, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=39975
2022-05-17 09:51:47 - progress_bar.py[line:272] - INFO: epoch 001:   5099 / 8856 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=752.9, nsentences=64, sample_size=599.6, inner_loss=2.148, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.226, expert1_balance_bottom=21.301, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=90, ups=0.12, wpb=752.9, bsz=64, num_updates=5090, lr=1.51616e-05, gnorm=2.456, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40059
2022-05-17 09:53:09 - progress_bar.py[line:272] - INFO: epoch 001:   5109 / 8856 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=762.3, nsentences=64, sample_size=606.7, inner_loss=2.201, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.618, expert1_balance_bottom=21.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.3, ups=0.12, wpb=762.3, bsz=64, num_updates=5100, lr=1.51495e-05, gnorm=2.692, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40142
2022-05-17 09:54:31 - progress_bar.py[line:272] - INFO: epoch 001:   5119 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=756.6, nsentences=64, sample_size=602.6, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.098, expert1_balance_bottom=21.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.4, ups=0.12, wpb=756.6, bsz=64, num_updates=5110, lr=1.51375e-05, gnorm=2.573, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40224
2022-05-17 09:55:55 - progress_bar.py[line:272] - INFO: epoch 001:   5129 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=758.4, nsentences=64, sample_size=604.1, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.868, expert1_balance_bottom=21.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=90, ups=0.12, wpb=758.4, bsz=64, num_updates=5120, lr=1.51255e-05, gnorm=2.516, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40308
2022-05-17 09:57:20 - progress_bar.py[line:272] - INFO: epoch 001:   5139 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=768.5, nsentences=64, sample_size=611.6, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.507, expert1_balance_bottom=21.483, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.5, ups=0.12, wpb=768.5, bsz=64, num_updates=5130, lr=1.51135e-05, gnorm=2.466, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=40393
2022-05-17 09:58:44 - progress_bar.py[line:272] - INFO: epoch 001:   5149 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=769.3, nsentences=64, sample_size=612.1, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.807, expert1_balance_bottom=21.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92, ups=0.12, wpb=769.3, bsz=64, num_updates=5140, lr=1.51015e-05, gnorm=2.318, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40476
2022-05-17 09:59:25 - progress_bar.py[line:272] - INFO: epoch 001:   5159 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=761.8, nsentences=64, sample_size=605.9, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.066, expert1_balance_bottom=21.262, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=185.2, ups=0.24, wpb=761.8, bsz=64, num_updates=5150, lr=1.50895e-05, gnorm=2.34, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40518
2022-05-17 10:00:02 - progress_bar.py[line:272] - INFO: epoch 001:   5169 / 8856 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=766.2, nsentences=64, sample_size=609.6, inner_loss=2.183, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.628, expert1_balance_bottom=21.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=208.1, ups=0.27, wpb=766.2, bsz=64, num_updates=5160, lr=1.50775e-05, gnorm=2.532, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40554
2022-05-17 10:00:39 - progress_bar.py[line:272] - INFO: epoch 001:   5179 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=769.9, nsentences=64, sample_size=612.7, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.581, expert1_balance_bottom=21.431, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=206.9, ups=0.27, wpb=769.9, bsz=64, num_updates=5170, lr=1.50655e-05, gnorm=2.605, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40592
2022-05-17 10:01:16 - progress_bar.py[line:272] - INFO: epoch 001:   5189 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=766.6, nsentences=64, sample_size=610.2, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.11, expert1_balance_bottom=21.018, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=208.9, ups=0.27, wpb=766.6, bsz=64, num_updates=5180, lr=1.50535e-05, gnorm=2.848, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40628
2022-05-17 10:01:54 - progress_bar.py[line:272] - INFO: epoch 001:   5199 / 8856 loss=3.137, loss_v1=0, loss_v2=0, nll_loss=0.794, ntokens=758.4, nsentences=64, sample_size=603.4, inner_loss=2.135, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.032, expert1_balance_bottom=21.222, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=199.8, ups=0.26, wpb=758.4, bsz=64, num_updates=5190, lr=1.50414e-05, gnorm=2.671, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40666
2022-05-17 10:02:31 - progress_bar.py[line:272] - INFO: epoch 001:   5209 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=765.6, nsentences=64, sample_size=609.4, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.277, expert1_balance_bottom=20.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=204.4, ups=0.27, wpb=765.6, bsz=64, num_updates=5200, lr=1.50294e-05, gnorm=2.395, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40704
2022-05-17 10:03:09 - progress_bar.py[line:272] - INFO: epoch 001:   5219 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=763.7, nsentences=64, sample_size=607.6, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.118, expert1_balance_bottom=21.286, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=203.9, ups=0.27, wpb=763.7, bsz=64, num_updates=5210, lr=1.50174e-05, gnorm=2.533, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40741
2022-05-17 10:03:46 - progress_bar.py[line:272] - INFO: epoch 001:   5229 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=755.9, nsentences=64, sample_size=601.7, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.329, expert1_balance_bottom=21.185, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=202.1, ups=0.27, wpb=755.9, bsz=64, num_updates=5220, lr=1.50054e-05, gnorm=2.628, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40779
2022-05-17 10:04:23 - progress_bar.py[line:272] - INFO: epoch 001:   5239 / 8856 loss=3.218, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=770.6, nsentences=64, sample_size=613.4, inner_loss=2.217, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.969, expert1_balance_bottom=21.356, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=209.3, ups=0.27, wpb=770.6, bsz=64, num_updates=5230, lr=1.49934e-05, gnorm=2.416, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40815
2022-05-17 10:05:01 - progress_bar.py[line:272] - INFO: epoch 001:   5249 / 8856 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=766.1, nsentences=64, sample_size=609.3, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.151, expert1_balance_bottom=21.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=199.1, ups=0.26, wpb=766.1, bsz=64, num_updates=5240, lr=1.49814e-05, gnorm=2.372, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40854
2022-05-17 10:05:38 - progress_bar.py[line:272] - INFO: epoch 001:   5259 / 8856 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=771.1, nsentences=64, sample_size=614.1, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.786, expert1_balance_bottom=21.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=209.3, ups=0.27, wpb=771.1, bsz=64, num_updates=5250, lr=1.49694e-05, gnorm=2.743, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40891
2022-05-17 10:06:34 - progress_bar.py[line:272] - INFO: epoch 001:   5269 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=758.1, nsentences=64, sample_size=603.6, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.074, expert1_balance_bottom=21.063, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=135, ups=0.18, wpb=758.1, bsz=64, num_updates=5260, lr=1.49574e-05, gnorm=2.661, loss_scale=64, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=40947
2022-05-17 10:07:58 - progress_bar.py[line:272] - INFO: epoch 001:   5279 / 8856 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=763.6, nsentences=64, sample_size=608.2, inner_loss=2.146, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.498, expert1_balance_bottom=21.514, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=91.5, ups=0.12, wpb=763.6, bsz=64, num_updates=5270, lr=1.49453e-05, gnorm=2.282, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41030
2022-05-17 10:09:22 - progress_bar.py[line:272] - INFO: epoch 001:   5289 / 8856 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=756.8, nsentences=64, sample_size=601.8, inner_loss=2.176, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.989, expert1_balance_bottom=21.163, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.1, ups=0.12, wpb=756.8, bsz=64, num_updates=5280, lr=1.49333e-05, gnorm=2.491, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41114
2022-05-17 10:10:45 - progress_bar.py[line:272] - INFO: epoch 001:   5299 / 8856 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=775, nsentences=64, sample_size=617, inner_loss=2.241, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.605, expert1_balance_bottom=21.699, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=93.7, ups=0.12, wpb=775, bsz=64, num_updates=5290, lr=1.49213e-05, gnorm=2.734, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41197
2022-05-17 10:12:07 - progress_bar.py[line:272] - INFO: epoch 001:   5309 / 8856 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=783.8, nsentences=64, sample_size=623.4, inner_loss=2.205, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.988, expert1_balance_bottom=21.544, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=94.7, ups=0.12, wpb=783.8, bsz=64, num_updates=5300, lr=1.49093e-05, gnorm=2.774, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41280
2022-05-17 10:13:30 - progress_bar.py[line:272] - INFO: epoch 001:   5319 / 8856 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=770, nsentences=64, sample_size=612.9, inner_loss=2.192, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.792, expert1_balance_bottom=21.646, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=93.6, ups=0.12, wpb=770, bsz=64, num_updates=5310, lr=1.48973e-05, gnorm=2.415, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41362
2022-05-17 10:14:54 - progress_bar.py[line:272] - INFO: epoch 001:   5329 / 8856 loss=3.234, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=766.5, nsentences=64, sample_size=610, inner_loss=2.234, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.682, expert1_balance_bottom=21.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=91, ups=0.12, wpb=766.5, bsz=64, num_updates=5320, lr=1.48853e-05, gnorm=2.611, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41446
2022-05-17 10:16:19 - progress_bar.py[line:272] - INFO: epoch 001:   5339 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=767.8, nsentences=64, sample_size=611, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.875, expert1_balance_bottom=21.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.6, ups=0.12, wpb=767.8, bsz=64, num_updates=5330, lr=1.48733e-05, gnorm=2.622, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41531
2022-05-17 10:17:23 - progress_bar.py[line:272] - INFO: epoch 001:   5349 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=779.3, nsentences=64, sample_size=620.1, inner_loss=2.197, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.231, expert1_balance_bottom=21.21, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=121.3, ups=0.16, wpb=779.3, bsz=64, num_updates=5340, lr=1.48613e-05, gnorm=2.354, loss_scale=64, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41595
2022-05-17 10:18:02 - progress_bar.py[line:272] - INFO: epoch 001:   5359 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=773.7, nsentences=64, sample_size=615.7, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.952, expert1_balance_bottom=21.476, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=197.9, ups=0.26, wpb=773.7, bsz=64, num_updates=5350, lr=1.48492e-05, gnorm=2.603, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41634
2022-05-17 10:18:39 - progress_bar.py[line:272] - INFO: epoch 001:   5369 / 8856 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=770.8, nsentences=64, sample_size=613.7, inner_loss=2.218, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.832, expert1_balance_bottom=21.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=207.4, ups=0.27, wpb=770.8, bsz=64, num_updates=5360, lr=1.48372e-05, gnorm=2.552, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41672
2022-05-17 10:19:17 - progress_bar.py[line:272] - INFO: epoch 001:   5379 / 8856 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=767.9, nsentences=64, sample_size=611.4, inner_loss=2.155, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.535, expert1_balance_bottom=21.739, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=204.6, ups=0.27, wpb=767.9, bsz=64, num_updates=5370, lr=1.48252e-05, gnorm=2.316, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41709
2022-05-17 10:19:54 - progress_bar.py[line:272] - INFO: epoch 001:   5389 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=767, nsentences=64, sample_size=610.2, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.741, expert1_balance_bottom=21.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=203.4, ups=0.27, wpb=767, bsz=64, num_updates=5380, lr=1.48132e-05, gnorm=2.653, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41747
2022-05-17 10:20:35 - progress_bar.py[line:272] - INFO: epoch 001:   5399 / 8856 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=765.4, nsentences=64, sample_size=608.8, inner_loss=2.19, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.005, expert1_balance_bottom=21.208, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=190.3, ups=0.25, wpb=765.4, bsz=64, num_updates=5390, lr=1.48012e-05, gnorm=2.734, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41787
2022-05-17 10:21:14 - progress_bar.py[line:272] - INFO: epoch 001:   5409 / 8856 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=773.5, nsentences=64, sample_size=615.8, inner_loss=2.219, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.871, expert1_balance_bottom=21.138, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=197, ups=0.25, wpb=773.5, bsz=64, num_updates=5400, lr=1.47892e-05, gnorm=2.676, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41826
2022-05-17 10:21:51 - progress_bar.py[line:272] - INFO: epoch 001:   5419 / 8856 loss=3.223, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=778.5, nsentences=64, sample_size=619.9, inner_loss=2.222, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.455, expert1_balance_bottom=21.452, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=207.6, ups=0.27, wpb=778.5, bsz=64, num_updates=5410, lr=1.47772e-05, gnorm=3.098, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41864
2022-05-17 10:22:30 - progress_bar.py[line:272] - INFO: epoch 001:   5429 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=760.7, nsentences=64, sample_size=605.3, inner_loss=2.218, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.791, expert1_balance_bottom=21.176, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=197.8, ups=0.26, wpb=760.7, bsz=64, num_updates=5420, lr=1.47652e-05, gnorm=2.566, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41902
2022-05-17 10:23:07 - progress_bar.py[line:272] - INFO: epoch 001:   5439 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=774.5, nsentences=64, sample_size=616.3, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.927, expert1_balance_bottom=21.054, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=208.5, ups=0.27, wpb=774.5, bsz=64, num_updates=5430, lr=1.47532e-05, gnorm=2.613, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41939
2022-05-17 10:23:45 - progress_bar.py[line:272] - INFO: epoch 001:   5449 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=754.2, nsentences=64, sample_size=600.5, inner_loss=2.191, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.171, expert1_balance_bottom=21.004, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=199, ups=0.26, wpb=754.2, bsz=64, num_updates=5440, lr=1.47411e-05, gnorm=2.363, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=41977
2022-05-17 10:24:22 - progress_bar.py[line:272] - INFO: epoch 001:   5459 / 8856 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=760.2, nsentences=64, sample_size=605, inner_loss=2.197, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.556, expert1_balance_bottom=21.143, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=203.7, ups=0.27, wpb=760.2, bsz=64, num_updates=5450, lr=1.47291e-05, gnorm=2.598, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42015
2022-05-17 10:25:00 - progress_bar.py[line:272] - INFO: epoch 001:   5469 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=766.1, nsentences=64, sample_size=609.6, inner_loss=2.172, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.156, expert1_balance_bottom=21.349, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=203.8, ups=0.27, wpb=766.1, bsz=64, num_updates=5460, lr=1.47171e-05, gnorm=2.359, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42052
2022-05-17 10:26:20 - progress_bar.py[line:272] - INFO: epoch 001:   5479 / 8856 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.816, ntokens=755.1, nsentences=64, sample_size=601.3, inner_loss=2.152, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.91, expert1_balance_bottom=21.507, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=94.7, ups=0.13, wpb=755.1, bsz=64, num_updates=5470, lr=1.47051e-05, gnorm=2.352, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42132
2022-05-17 10:27:44 - progress_bar.py[line:272] - INFO: epoch 001:   5489 / 8856 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=0.912, ntokens=766.4, nsentences=64, sample_size=610.2, inner_loss=2.238, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.297, expert1_balance_bottom=21.133, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=90.9, ups=0.12, wpb=766.4, bsz=64, num_updates=5480, lr=1.46931e-05, gnorm=2.968, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42216
2022-05-17 10:29:05 - progress_bar.py[line:272] - INFO: epoch 001:   5499 / 8856 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=757.7, nsentences=64, sample_size=603.6, inner_loss=2.219, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.953, expert1_balance_bottom=21.383, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=93.5, ups=0.12, wpb=757.7, bsz=64, num_updates=5490, lr=1.46811e-05, gnorm=2.678, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42297
2022-05-17 10:30:29 - progress_bar.py[line:272] - INFO: epoch 001:   5509 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.907, ntokens=761.2, nsentences=64, sample_size=606.1, inner_loss=2.235, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.856, expert1_balance_bottom=21.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=90.8, ups=0.12, wpb=761.2, bsz=64, num_updates=5500, lr=1.46691e-05, gnorm=2.529, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42381
2022-05-17 10:31:52 - progress_bar.py[line:272] - INFO: epoch 001:   5519 / 8856 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=759.4, nsentences=64, sample_size=605, inner_loss=2.161, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.174, expert1_balance_bottom=21.325, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.6, ups=0.12, wpb=759.4, bsz=64, num_updates=5510, lr=1.46571e-05, gnorm=2.265, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42464
2022-05-17 10:33:16 - progress_bar.py[line:272] - INFO: epoch 001:   5529 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=761.4, nsentences=64, sample_size=606.1, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.805, expert1_balance_bottom=21.302, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=89.8, ups=0.12, wpb=761.4, bsz=64, num_updates=5520, lr=1.4645e-05, gnorm=2.611, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=42549
2022-05-17 10:34:39 - progress_bar.py[line:272] - INFO: epoch 001:   5539 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=762.4, nsentences=64, sample_size=606.6, inner_loss=2.177, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.964, expert1_balance_bottom=21.235, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=92.7, ups=0.12, wpb=762.4, bsz=64, num_updates=5530, lr=1.4633e-05, gnorm=2.427, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42631
2022-05-17 10:36:03 - progress_bar.py[line:272] - INFO: epoch 001:   5549 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.888, ntokens=770.1, nsentences=64, sample_size=612.6, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.766, expert1_balance_bottom=21.618, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.6, ups=0.12, wpb=770.1, bsz=64, num_updates=5540, lr=1.4621e-05, gnorm=2.619, loss_scale=128, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42715
2022-05-17 10:37:28 - progress_bar.py[line:272] - INFO: epoch 001:   5559 / 8856 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=758.6, nsentences=64, sample_size=603.7, inner_loss=2.238, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.886, expert1_balance_bottom=21.037, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=89.3, ups=0.12, wpb=758.6, bsz=64, num_updates=5550, lr=1.4609e-05, gnorm=2.659, loss_scale=128, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42800
2022-05-17 10:38:52 - progress_bar.py[line:272] - INFO: epoch 001:   5569 / 8856 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.882, ntokens=746, nsentences=64, sample_size=593.3, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.68, expert1_balance_bottom=21.321, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=88.6, ups=0.12, wpb=746, bsz=64, num_updates=5560, lr=1.4597e-05, gnorm=2.465, loss_scale=128, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42884
2022-05-17 10:39:42 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-17 10:40:23 - progress_bar.py[line:272] - INFO: epoch 001:   5580 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=773.3, nsentences=64, sample_size=615.7, inner_loss=2.173, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.027, expert1_balance_bottom=21.247, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=85.1, ups=0.11, wpb=773.3, bsz=64, num_updates=5570, lr=1.4585e-05, gnorm=2.821, loss_scale=64, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=42975
2022-05-17 10:41:47 - progress_bar.py[line:272] - INFO: epoch 001:   5590 / 8856 loss=3.258, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=764.7, nsentences=64, sample_size=608.8, inner_loss=2.257, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.372, expert1_balance_bottom=20.731, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=91.2, ups=0.12, wpb=764.7, bsz=64, num_updates=5580, lr=1.4573e-05, gnorm=2.781, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=43059
2022-05-17 10:43:09 - progress_bar.py[line:272] - INFO: epoch 001:   5600 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=754.5, nsentences=64, sample_size=600.5, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.975, expert1_balance_bottom=21.387, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91, ups=0.12, wpb=754.5, bsz=64, num_updates=5590, lr=1.4561e-05, gnorm=2.719, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43142
2022-05-17 10:44:32 - progress_bar.py[line:272] - INFO: epoch 001:   5610 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=755.1, nsentences=64, sample_size=600.7, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.937, expert1_balance_bottom=21.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.4, ups=0.12, wpb=755.1, bsz=64, num_updates=5600, lr=1.45489e-05, gnorm=2.352, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43225
2022-05-17 10:45:56 - progress_bar.py[line:272] - INFO: epoch 001:   5620 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=757.9, nsentences=64, sample_size=603, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.027, expert1_balance_bottom=21.412, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.4, ups=0.12, wpb=757.9, bsz=64, num_updates=5610, lr=1.45369e-05, gnorm=2.828, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43308
2022-05-17 10:47:19 - progress_bar.py[line:272] - INFO: epoch 001:   5630 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=758.1, nsentences=64, sample_size=603.3, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.874, expert1_balance_bottom=21.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91, ups=0.12, wpb=758.1, bsz=64, num_updates=5620, lr=1.45249e-05, gnorm=2.27, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43392
2022-05-17 10:48:43 - progress_bar.py[line:272] - INFO: epoch 001:   5640 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.899, ntokens=769.1, nsentences=64, sample_size=612.1, inner_loss=2.229, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.251, expert1_balance_bottom=21.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92.2, ups=0.12, wpb=769.1, bsz=64, num_updates=5630, lr=1.45129e-05, gnorm=2.569, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43475
2022-05-17 10:50:06 - progress_bar.py[line:272] - INFO: epoch 001:   5650 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=775, nsentences=64, sample_size=616.5, inner_loss=2.187, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.143, expert1_balance_bottom=21.112, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=93.3, ups=0.12, wpb=775, bsz=64, num_updates=5640, lr=1.45009e-05, gnorm=2.863, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43558
2022-05-17 10:51:28 - progress_bar.py[line:272] - INFO: epoch 001:   5660 / 8856 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=770.1, nsentences=64, sample_size=612.8, inner_loss=2.158, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.701, expert1_balance_bottom=21.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=93.1, ups=0.12, wpb=770.1, bsz=64, num_updates=5650, lr=1.44889e-05, gnorm=2.538, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43641
2022-05-17 10:52:54 - progress_bar.py[line:272] - INFO: epoch 001:   5670 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=766.5, nsentences=64, sample_size=610, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.669, expert1_balance_bottom=21.581, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90, ups=0.12, wpb=766.5, bsz=64, num_updates=5660, lr=1.44769e-05, gnorm=2.649, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43726
2022-05-17 10:54:18 - progress_bar.py[line:272] - INFO: epoch 001:   5680 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=780.8, nsentences=64, sample_size=621.3, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.574, expert1_balance_bottom=21.352, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.2, ups=0.12, wpb=780.8, bsz=64, num_updates=5670, lr=1.44649e-05, gnorm=2.409, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43811
2022-05-17 10:55:42 - progress_bar.py[line:272] - INFO: epoch 001:   5690 / 8856 loss=3.235, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=761.4, nsentences=64, sample_size=606, inner_loss=2.233, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.1, expert1_balance_bottom=21.237, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=91, ups=0.12, wpb=761.4, bsz=64, num_updates=5680, lr=1.44529e-05, gnorm=2.447, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43894
2022-05-17 10:57:05 - progress_bar.py[line:272] - INFO: epoch 001:   5700 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=766.3, nsentences=64, sample_size=609.7, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.07, expert1_balance_bottom=21.438, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.4, ups=0.12, wpb=766.3, bsz=64, num_updates=5690, lr=1.44408e-05, gnorm=2.434, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=43977
2022-05-17 10:58:29 - progress_bar.py[line:272] - INFO: epoch 001:   5710 / 8856 loss=3.278, loss_v1=0, loss_v2=0, nll_loss=0.96, ntokens=770.6, nsentences=63.5, sample_size=613.5, inner_loss=2.28, moe_gate_loss=0.999, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.487, expert1_balance_bottom=20.989, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.95, wps=91.9, ups=0.12, wpb=770.6, bsz=63.5, num_updates=5700, lr=1.44288e-05, gnorm=2.65, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44061
2022-05-17 10:59:51 - progress_bar.py[line:272] - INFO: epoch 001:   5720 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=755.5, nsentences=64, sample_size=601, inner_loss=2.169, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.913, expert1_balance_bottom=21.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.5, ups=0.12, wpb=755.5, bsz=64, num_updates=5710, lr=1.44168e-05, gnorm=2.366, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44144
2022-05-17 11:01:15 - progress_bar.py[line:272] - INFO: epoch 001:   5730 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=763.9, nsentences=64, sample_size=608.3, inner_loss=2.172, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.097, expert1_balance_bottom=21.239, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.4, ups=0.12, wpb=763.9, bsz=64, num_updates=5720, lr=1.44048e-05, gnorm=2.52, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44227
2022-05-17 11:02:37 - progress_bar.py[line:272] - INFO: epoch 001:   5740 / 8856 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=768.7, nsentences=64, sample_size=611.8, inner_loss=2.156, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.959, expert1_balance_bottom=21.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=93.7, ups=0.12, wpb=768.7, bsz=64, num_updates=5730, lr=1.43928e-05, gnorm=2.416, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44309
2022-05-17 11:04:01 - progress_bar.py[line:272] - INFO: epoch 001:   5750 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=776.9, nsentences=64, sample_size=618.4, inner_loss=2.206, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.857, expert1_balance_bottom=21.243, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.5, ups=0.12, wpb=776.9, bsz=64, num_updates=5740, lr=1.43808e-05, gnorm=2.839, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44393
2022-05-17 11:05:23 - progress_bar.py[line:272] - INFO: epoch 001:   5760 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=771.8, nsentences=64, sample_size=614.4, inner_loss=2.173, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.924, expert1_balance_bottom=21.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=94, ups=0.12, wpb=771.8, bsz=64, num_updates=5750, lr=1.43688e-05, gnorm=2.28, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44476
2022-05-17 11:06:47 - progress_bar.py[line:272] - INFO: epoch 001:   5770 / 8856 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=749.3, nsentences=64, sample_size=596.5, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.863, expert1_balance_bottom=21.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=89.2, ups=0.12, wpb=749.3, bsz=64, num_updates=5760, lr=1.43568e-05, gnorm=2.727, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44560
2022-05-17 11:08:12 - progress_bar.py[line:272] - INFO: epoch 001:   5780 / 8856 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=0.922, ntokens=768.1, nsentences=64, sample_size=611.3, inner_loss=2.244, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.482, expert1_balance_bottom=21.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=90.7, ups=0.12, wpb=768.1, bsz=64, num_updates=5770, lr=1.43447e-05, gnorm=2.587, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44644
2022-05-17 11:09:35 - progress_bar.py[line:272] - INFO: epoch 001:   5790 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=769.7, nsentences=64, sample_size=613, inner_loss=2.181, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.368, expert1_balance_bottom=21.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.3, ups=0.12, wpb=769.7, bsz=64, num_updates=5780, lr=1.43327e-05, gnorm=2.597, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44728
2022-05-17 11:10:59 - progress_bar.py[line:272] - INFO: epoch 001:   5800 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=752.2, nsentences=64, sample_size=598.6, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.799, expert1_balance_bottom=21.471, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=89.8, ups=0.12, wpb=752.2, bsz=64, num_updates=5790, lr=1.43207e-05, gnorm=2.242, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44811
2022-05-17 11:12:22 - progress_bar.py[line:272] - INFO: epoch 001:   5810 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=768.4, nsentences=64, sample_size=611, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.162, expert1_balance_bottom=21.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.5, ups=0.12, wpb=768.4, bsz=64, num_updates=5800, lr=1.43087e-05, gnorm=2.409, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=44895
2022-05-17 11:13:45 - progress_bar.py[line:272] - INFO: epoch 001:   5820 / 8856 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=778.3, nsentences=64, sample_size=619.2, inner_loss=2.215, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.002, expert1_balance_bottom=21.621, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=93.5, ups=0.12, wpb=778.3, bsz=64, num_updates=5810, lr=1.42967e-05, gnorm=2.337, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=44978
2022-05-17 11:15:09 - progress_bar.py[line:272] - INFO: epoch 001:   5830 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=763.8, nsentences=64, sample_size=608.3, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.73, expert1_balance_bottom=21.567, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.5, ups=0.12, wpb=763.8, bsz=64, num_updates=5820, lr=1.42847e-05, gnorm=2.369, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=45061
2022-05-17 11:16:32 - progress_bar.py[line:272] - INFO: epoch 001:   5840 / 8856 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=768.4, nsentences=64, sample_size=611.4, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.609, expert1_balance_bottom=21.064, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.1, ups=0.12, wpb=768.4, bsz=64, num_updates=5830, lr=1.42727e-05, gnorm=2.679, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45145
2022-05-17 11:17:55 - progress_bar.py[line:272] - INFO: epoch 001:   5850 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=770.3, nsentences=64, sample_size=612.9, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.041, expert1_balance_bottom=21.137, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.9, ups=0.12, wpb=770.3, bsz=64, num_updates=5840, lr=1.42607e-05, gnorm=2.831, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45228
2022-05-17 11:19:18 - progress_bar.py[line:272] - INFO: epoch 001:   5860 / 8856 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=766.8, nsentences=64, sample_size=610.9, inner_loss=2.193, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.272, expert1_balance_bottom=21.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.3, ups=0.12, wpb=766.8, bsz=64, num_updates=5850, lr=1.42486e-05, gnorm=2.64, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45311
2022-05-17 11:20:41 - progress_bar.py[line:272] - INFO: epoch 001:   5870 / 8856 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=760.8, nsentences=64, sample_size=605.4, inner_loss=2.181, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.486, expert1_balance_bottom=21.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.2, ups=0.12, wpb=760.8, bsz=64, num_updates=5860, lr=1.42366e-05, gnorm=2.47, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45393
2022-05-17 11:22:05 - progress_bar.py[line:272] - INFO: epoch 001:   5880 / 8856 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=765.5, nsentences=64, sample_size=609.1, inner_loss=2.2, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.7, expert1_balance_bottom=21.384, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.2, ups=0.12, wpb=765.5, bsz=64, num_updates=5870, lr=1.42246e-05, gnorm=2.454, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45477
2022-05-17 11:23:29 - progress_bar.py[line:272] - INFO: epoch 001:   5890 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.858, ntokens=771.9, nsentences=64, sample_size=614.6, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.648, expert1_balance_bottom=21.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.2, ups=0.12, wpb=771.9, bsz=64, num_updates=5880, lr=1.42126e-05, gnorm=2.358, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45561
2022-05-17 11:24:51 - progress_bar.py[line:272] - INFO: epoch 001:   5900 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=767, nsentences=64, sample_size=610.9, inner_loss=2.182, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.491, expert1_balance_bottom=21.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.6, ups=0.12, wpb=767, bsz=64, num_updates=5890, lr=1.42006e-05, gnorm=2.306, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=45644
2022-05-17 11:26:15 - progress_bar.py[line:272] - INFO: epoch 001:   5910 / 8856 loss=3.247, loss_v1=0, loss_v2=0, nll_loss=0.924, ntokens=761.2, nsentences=64, sample_size=606.1, inner_loss=2.245, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.324, expert1_balance_bottom=20.981, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=91.4, ups=0.12, wpb=761.2, bsz=64, num_updates=5900, lr=1.41886e-05, gnorm=2.57, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45727
2022-05-17 11:27:38 - progress_bar.py[line:272] - INFO: epoch 001:   5920 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=774.5, nsentences=64, sample_size=616.3, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.112, expert1_balance_bottom=21.451, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.8, ups=0.12, wpb=774.5, bsz=64, num_updates=5910, lr=1.41766e-05, gnorm=2.301, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45811
2022-05-17 11:29:03 - progress_bar.py[line:272] - INFO: epoch 001:   5930 / 8856 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=767.1, nsentences=64, sample_size=610.5, inner_loss=2.183, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.983, expert1_balance_bottom=21.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.6, ups=0.12, wpb=767.1, bsz=64, num_updates=5920, lr=1.41646e-05, gnorm=2.323, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=45895
2022-05-17 11:30:27 - progress_bar.py[line:272] - INFO: epoch 001:   5940 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=774.7, nsentences=64, sample_size=616.6, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.811, expert1_balance_bottom=21.58, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.4, ups=0.12, wpb=774.7, bsz=64, num_updates=5930, lr=1.41526e-05, gnorm=2.347, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=45979
2022-05-17 11:31:51 - progress_bar.py[line:272] - INFO: epoch 001:   5950 / 8856 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=761.8, nsentences=64, sample_size=606.2, inner_loss=2.167, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.649, expert1_balance_bottom=21.386, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.4, ups=0.12, wpb=761.8, bsz=64, num_updates=5940, lr=1.41405e-05, gnorm=2.384, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=46063
2022-05-17 11:33:15 - progress_bar.py[line:272] - INFO: epoch 001:   5960 / 8856 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=773, nsentences=64, sample_size=615.1, inner_loss=2.205, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.493, expert1_balance_bottom=21.482, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.9, ups=0.12, wpb=773, bsz=64, num_updates=5950, lr=1.41285e-05, gnorm=2.251, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=46148
2022-05-17 11:34:38 - progress_bar.py[line:272] - INFO: epoch 001:   5970 / 8856 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=766.3, nsentences=64, sample_size=609.6, inner_loss=2.18, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.039, expert1_balance_bottom=20.823, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.1, ups=0.12, wpb=766.3, bsz=64, num_updates=5960, lr=1.41165e-05, gnorm=2.312, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=46231
2022-05-17 11:36:03 - progress_bar.py[line:272] - INFO: epoch 001:   5980 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=763.6, nsentences=64, sample_size=607.7, inner_loss=2.177, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.936, expert1_balance_bottom=21.348, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.1, ups=0.12, wpb=763.6, bsz=64, num_updates=5970, lr=1.41045e-05, gnorm=2.34, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=46315
2022-05-17 11:37:26 - progress_bar.py[line:272] - INFO: epoch 001:   5990 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=768.7, nsentences=64, sample_size=611.8, inner_loss=2.226, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.92, expert1_balance_bottom=21.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.9, ups=0.12, wpb=768.7, bsz=64, num_updates=5980, lr=1.40925e-05, gnorm=2.454, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=46398
2022-05-17 11:38:49 - progress_bar.py[line:272] - INFO: epoch 001:   6000 / 8856 loss=3.259, loss_v1=0, loss_v2=0, nll_loss=0.938, ntokens=766.6, nsentences=64, sample_size=610.1, inner_loss=2.258, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.8, expert1_balance_bottom=21.761, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=92.4, ups=0.12, wpb=766.6, bsz=64, num_updates=5990, lr=1.40805e-05, gnorm=2.456, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=46481
2022-05-17 11:40:11 - progress_bar.py[line:272] - INFO: epoch 001:   6010 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=764.6, nsentences=64, sample_size=608.9, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.945, expert1_balance_bottom=21.099, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.8, ups=0.12, wpb=764.6, bsz=64, num_updates=6000, lr=1.40685e-05, gnorm=2.277, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=46564
2022-05-17 11:40:11 - train.py[line:456] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-17 11:40:13 - train.py[line:466] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-17 11:40:13 - train.py[line:494] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-17 11:46:54 - train.py[line:503] - INFO: valid_step finished
2022-05-17 11:46:54 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 11.532 | loss_v1 0 | loss_v2 0 | nll_loss 9.78 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | inner_loss 10.532 | moe_gate_loss 1 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.38 | expert1_balance_top 27.654 | expert1_balance_bottom 22.402 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 879.47 | cider 1.274 | wps 750.9 | wpb 481.7 | bsz 8 | num_updates 6000 | best_cider 1.274
2022-05-17 11:46:54 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 6000 updates
2022-05-17 11:46:54 - trainer.py[line:450] - INFO: Saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_6000.pt
2022-05-17 11:47:01 - trainer.py[line:460] - INFO: Finished saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_6000.pt
2022-05-17 11:47:11 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_6000.pt (epoch 1 @ 6000 updates, score 1.274) (writing took 16.740786815993488 seconds)
2022-05-17 11:48:26 - progress_bar.py[line:272] - INFO: epoch 001:   6020 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=754.3, nsentences=64, sample_size=599.9, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.357, expert1_balance_bottom=21.079, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=15.2, ups=0.02, wpb=754.3, bsz=64, num_updates=6010, lr=1.40565e-05, gnorm=2.484, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=47059
2022-05-17 11:49:49 - progress_bar.py[line:272] - INFO: epoch 001:   6030 / 8856 loss=3.256, loss_v1=0, loss_v2=0, nll_loss=0.931, ntokens=774.1, nsentences=64, sample_size=616, inner_loss=2.255, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.476, expert1_balance_bottom=21.075, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=93.3, ups=0.12, wpb=774.1, bsz=64, num_updates=6020, lr=1.40444e-05, gnorm=2.734, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47142
2022-05-17 11:51:12 - progress_bar.py[line:272] - INFO: epoch 001:   6040 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=755.2, nsentences=64, sample_size=600.6, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.836, expert1_balance_bottom=21.676, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.7, ups=0.12, wpb=755.2, bsz=64, num_updates=6030, lr=1.40324e-05, gnorm=2.438, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47224
2022-05-17 11:52:37 - progress_bar.py[line:272] - INFO: epoch 001:   6050 / 8856 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=763.2, nsentences=64, sample_size=606.9, inner_loss=2.184, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.538, expert1_balance_bottom=21.576, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.8, ups=0.12, wpb=763.2, bsz=64, num_updates=6040, lr=1.40204e-05, gnorm=2.477, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47309
2022-05-17 11:54:01 - progress_bar.py[line:272] - INFO: epoch 001:   6060 / 8856 loss=3.191, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=769.5, nsentences=64, sample_size=611.6, inner_loss=2.19, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.948, expert1_balance_bottom=21.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.3, ups=0.12, wpb=769.5, bsz=64, num_updates=6050, lr=1.40084e-05, gnorm=2.512, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47393
2022-05-17 11:55:23 - progress_bar.py[line:272] - INFO: epoch 001:   6070 / 8856 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=774.3, nsentences=64, sample_size=615.7, inner_loss=2.158, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.867, expert1_balance_bottom=21.19, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=93.9, ups=0.12, wpb=774.3, bsz=64, num_updates=6060, lr=1.39964e-05, gnorm=2.359, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47476
2022-05-17 11:56:48 - progress_bar.py[line:272] - INFO: epoch 001:   6080 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=768.2, nsentences=64, sample_size=611.6, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.963, expert1_balance_bottom=21.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.3, ups=0.12, wpb=768.2, bsz=64, num_updates=6070, lr=1.39844e-05, gnorm=2.687, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47560
2022-05-17 11:58:11 - progress_bar.py[line:272] - INFO: epoch 001:   6090 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=756, nsentences=64, sample_size=601.6, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.907, expert1_balance_bottom=21.396, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.2, ups=0.12, wpb=756, bsz=64, num_updates=6080, lr=1.39724e-05, gnorm=2.253, loss_scale=128, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47644
2022-05-17 11:59:11 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-17 11:59:45 - progress_bar.py[line:272] - INFO: epoch 001:   6101 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=766.9, nsentences=64, sample_size=610.5, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.228, expert1_balance_bottom=21.121, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=82, ups=0.11, wpb=766.9, bsz=64, num_updates=6090, lr=1.39604e-05, gnorm=2.558, loss_scale=64, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47737
2022-05-17 12:01:07 - progress_bar.py[line:272] - INFO: epoch 001:   6111 / 8856 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=758.4, nsentences=64, sample_size=603.3, inner_loss=2.208, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.727, expert1_balance_bottom=21.41, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.2, ups=0.12, wpb=758.4, bsz=64, num_updates=6100, lr=1.39483e-05, gnorm=2.324, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47820
2022-05-17 12:02:31 - progress_bar.py[line:272] - INFO: epoch 001:   6121 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=783.7, nsentences=64, sample_size=623.7, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.677, expert1_balance_bottom=21.418, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=93.4, ups=0.12, wpb=783.7, bsz=64, num_updates=6110, lr=1.39363e-05, gnorm=2.165, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47904
2022-05-17 12:03:54 - progress_bar.py[line:272] - INFO: epoch 001:   6131 / 8856 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=746.3, nsentences=64, sample_size=594, inner_loss=2.166, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.551, expert1_balance_bottom=21.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=89.8, ups=0.12, wpb=746.3, bsz=64, num_updates=6120, lr=1.39243e-05, gnorm=2.423, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=47987
2022-05-17 12:05:18 - progress_bar.py[line:272] - INFO: epoch 001:   6141 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=767.4, nsentences=64, sample_size=610.5, inner_loss=2.178, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.065, expert1_balance_bottom=21.474, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.9, ups=0.12, wpb=767.4, bsz=64, num_updates=6130, lr=1.39123e-05, gnorm=2.59, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48070
2022-05-17 12:06:42 - progress_bar.py[line:272] - INFO: epoch 001:   6151 / 8856 loss=3.25, loss_v1=0, loss_v2=0, nll_loss=0.926, ntokens=751.1, nsentences=64, sample_size=597.8, inner_loss=2.249, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.78, expert1_balance_bottom=21.116, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=89.2, ups=0.12, wpb=751.1, bsz=64, num_updates=6140, lr=1.39003e-05, gnorm=2.52, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48154
2022-05-17 12:08:06 - progress_bar.py[line:272] - INFO: epoch 001:   6161 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=758.1, nsentences=64, sample_size=603.6, inner_loss=2.202, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.654, expert1_balance_bottom=21.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.5, ups=0.12, wpb=758.1, bsz=64, num_updates=6150, lr=1.38883e-05, gnorm=2.615, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48238
2022-05-17 12:09:29 - progress_bar.py[line:272] - INFO: epoch 001:   6171 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=757, nsentences=64, sample_size=602.6, inner_loss=2.171, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.706, expert1_balance_bottom=21.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.4, ups=0.12, wpb=757, bsz=64, num_updates=6160, lr=1.38763e-05, gnorm=2.371, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48322
2022-05-17 12:10:53 - progress_bar.py[line:272] - INFO: epoch 001:   6181 / 8856 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=767.2, nsentences=64, sample_size=610.4, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.041, expert1_balance_bottom=21.395, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.1, ups=0.12, wpb=767.2, bsz=64, num_updates=6170, lr=1.38643e-05, gnorm=2.684, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48406
2022-05-17 12:12:16 - progress_bar.py[line:272] - INFO: epoch 001:   6191 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=768, nsentences=64, sample_size=611.4, inner_loss=2.169, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.756, expert1_balance_bottom=21.522, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=92.6, ups=0.12, wpb=768, bsz=64, num_updates=6180, lr=1.38523e-05, gnorm=2.444, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48489
2022-05-17 12:13:42 - progress_bar.py[line:272] - INFO: epoch 001:   6201 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=770, nsentences=64, sample_size=612.5, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.851, expert1_balance_bottom=21.588, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.4, ups=0.12, wpb=770, bsz=64, num_updates=6190, lr=1.38402e-05, gnorm=2.162, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48574
2022-05-17 12:15:05 - progress_bar.py[line:272] - INFO: epoch 001:   6211 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=777.7, nsentences=64, sample_size=618.8, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.68, expert1_balance_bottom=21.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=93.5, ups=0.12, wpb=777.7, bsz=64, num_updates=6200, lr=1.38282e-05, gnorm=2.44, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48657
2022-05-17 12:16:30 - progress_bar.py[line:272] - INFO: epoch 001:   6221 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=750.9, nsentences=64, sample_size=597.8, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.066, expert1_balance_bottom=21.443, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=88.5, ups=0.12, wpb=750.9, bsz=64, num_updates=6210, lr=1.38162e-05, gnorm=2.512, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48742
2022-05-17 12:17:54 - progress_bar.py[line:272] - INFO: epoch 001:   6231 / 8856 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=759.2, nsentences=64, sample_size=603.8, inner_loss=2.208, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.641, expert1_balance_bottom=21.408, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.5, ups=0.12, wpb=759.2, bsz=64, num_updates=6220, lr=1.38042e-05, gnorm=2.359, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48826
2022-05-17 12:19:17 - progress_bar.py[line:272] - INFO: epoch 001:   6241 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=754.9, nsentences=64, sample_size=600.9, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.631, expert1_balance_bottom=21.578, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.6, ups=0.12, wpb=754.9, bsz=64, num_updates=6230, lr=1.37922e-05, gnorm=2.613, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=48909
2022-05-17 12:20:40 - progress_bar.py[line:272] - INFO: epoch 001:   6251 / 8856 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=759.2, nsentences=64, sample_size=604.1, inner_loss=2.154, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.409, expert1_balance_bottom=21.59, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=91.4, ups=0.12, wpb=759.2, bsz=64, num_updates=6240, lr=1.37802e-05, gnorm=2.343, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=48992
2022-05-17 12:22:03 - progress_bar.py[line:272] - INFO: epoch 001:   6261 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=765.6, nsentences=64, sample_size=609.5, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.524, expert1_balance_bottom=21.63, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.1, ups=0.12, wpb=765.6, bsz=64, num_updates=6250, lr=1.37682e-05, gnorm=2.404, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49076
2022-05-17 12:23:28 - progress_bar.py[line:272] - INFO: epoch 001:   6271 / 8856 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.8, ntokens=767.7, nsentences=64, sample_size=611.4, inner_loss=2.132, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.902, expert1_balance_bottom=21.296, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=90.9, ups=0.12, wpb=767.7, bsz=64, num_updates=6260, lr=1.37562e-05, gnorm=2.321, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49160
2022-05-17 12:24:52 - progress_bar.py[line:272] - INFO: epoch 001:   6281 / 8856 loss=3.224, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=769.9, nsentences=64, sample_size=612.6, inner_loss=2.223, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.69, expert1_balance_bottom=21.3, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.3, ups=0.12, wpb=769.9, bsz=64, num_updates=6270, lr=1.37441e-05, gnorm=2.673, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49244
2022-05-17 12:26:16 - progress_bar.py[line:272] - INFO: epoch 001:   6291 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=757, nsentences=64, sample_size=602.3, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.893, expert1_balance_bottom=21.172, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=90.3, ups=0.12, wpb=757, bsz=64, num_updates=6280, lr=1.37321e-05, gnorm=2.792, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49328
2022-05-17 12:27:40 - progress_bar.py[line:272] - INFO: epoch 001:   6301 / 8856 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=750.2, nsentences=64, sample_size=596.6, inner_loss=2.181, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.842, expert1_balance_bottom=21.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=88.7, ups=0.12, wpb=750.2, bsz=64, num_updates=6290, lr=1.37201e-05, gnorm=2.184, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=49413
2022-05-17 12:29:05 - progress_bar.py[line:272] - INFO: epoch 001:   6311 / 8856 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=751.7, nsentences=64, sample_size=598.1, inner_loss=2.181, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.837, expert1_balance_bottom=21.558, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=89, ups=0.12, wpb=751.7, bsz=64, num_updates=6300, lr=1.37081e-05, gnorm=2.428, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49497
2022-05-17 12:30:28 - progress_bar.py[line:272] - INFO: epoch 001:   6321 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=765.8, nsentences=64, sample_size=609.2, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.825, expert1_balance_bottom=21.136, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92, ups=0.12, wpb=765.8, bsz=64, num_updates=6310, lr=1.36961e-05, gnorm=2.231, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49580
2022-05-17 12:31:51 - progress_bar.py[line:272] - INFO: epoch 001:   6331 / 8856 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=767.8, nsentences=64, sample_size=610.9, inner_loss=2.2, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.214, expert1_balance_bottom=21.278, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.3, ups=0.12, wpb=767.8, bsz=64, num_updates=6320, lr=1.36841e-05, gnorm=2.53, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49664
2022-05-17 12:33:14 - progress_bar.py[line:272] - INFO: epoch 001:   6341 / 8856 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=757.8, nsentences=64, sample_size=603.1, inner_loss=2.221, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.775, expert1_balance_bottom=21.379, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.2, ups=0.12, wpb=757.8, bsz=64, num_updates=6330, lr=1.36721e-05, gnorm=2.592, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49747
2022-05-17 12:34:39 - progress_bar.py[line:272] - INFO: epoch 001:   6351 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=770.1, nsentences=64, sample_size=612.9, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.85, expert1_balance_bottom=21.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.3, ups=0.12, wpb=770.1, bsz=64, num_updates=6340, lr=1.36601e-05, gnorm=2.623, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49832
2022-05-17 12:36:04 - progress_bar.py[line:272] - INFO: epoch 001:   6361 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=763.8, nsentences=64, sample_size=608.1, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.73, expert1_balance_bottom=21.721, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=89.9, ups=0.12, wpb=763.8, bsz=64, num_updates=6350, lr=1.3648e-05, gnorm=2.299, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=49917
2022-05-17 12:37:28 - progress_bar.py[line:272] - INFO: epoch 001:   6371 / 8856 loss=3.156, loss_v1=0, loss_v2=0, nll_loss=0.824, ntokens=765.2, nsentences=64, sample_size=608.9, inner_loss=2.155, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.124, expert1_balance_bottom=21.345, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=91.2, ups=0.12, wpb=765.2, bsz=64, num_updates=6360, lr=1.3636e-05, gnorm=2.303, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50001
2022-05-17 12:38:31 - progress_bar.py[line:272] - INFO: epoch 001:   6381 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=762.7, nsentences=64, sample_size=606.7, inner_loss=2.206, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.382, expert1_balance_bottom=21.762, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=120.6, ups=0.16, wpb=762.7, bsz=64, num_updates=6370, lr=1.3624e-05, gnorm=2.506, loss_scale=64, train_wall=33, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=50064
2022-05-17 12:39:09 - progress_bar.py[line:272] - INFO: epoch 001:   6391 / 8856 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=758, nsentences=64, sample_size=603.6, inner_loss=2.163, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.821, expert1_balance_bottom=21.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=201.4, ups=0.27, wpb=758, bsz=64, num_updates=6380, lr=1.3612e-05, gnorm=2.865, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50102
2022-05-17 12:39:47 - progress_bar.py[line:272] - INFO: epoch 001:   6401 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=758.6, nsentences=64, sample_size=603.7, inner_loss=2.23, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.782, expert1_balance_bottom=21.422, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=200.2, ups=0.26, wpb=758.6, bsz=64, num_updates=6390, lr=1.36e-05, gnorm=2.948, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50139
2022-05-17 12:40:24 - progress_bar.py[line:272] - INFO: epoch 001:   6411 / 8856 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.892, ntokens=766.4, nsentences=64, sample_size=609.8, inner_loss=2.215, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.367, expert1_balance_bottom=21.178, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=206.5, ups=0.27, wpb=766.4, bsz=64, num_updates=6400, lr=1.3588e-05, gnorm=2.518, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50177
2022-05-17 12:41:03 - progress_bar.py[line:272] - INFO: epoch 001:   6421 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=757.2, nsentences=64, sample_size=603, inner_loss=2.212, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.643, expert1_balance_bottom=21.109, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=195, ups=0.26, wpb=757.2, bsz=64, num_updates=6410, lr=1.3576e-05, gnorm=2.841, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50215
2022-05-17 12:41:40 - progress_bar.py[line:272] - INFO: epoch 001:   6431 / 8856 loss=3.229, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=766.1, nsentences=64, sample_size=609.8, inner_loss=2.228, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.679, expert1_balance_bottom=21.635, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=208.8, ups=0.27, wpb=766.1, bsz=64, num_updates=6420, lr=1.3564e-05, gnorm=2.408, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50252
2022-05-17 12:42:17 - progress_bar.py[line:272] - INFO: epoch 001:   6441 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=763.6, nsentences=64, sample_size=607.5, inner_loss=2.182, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.542, expert1_balance_bottom=21.407, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=204.7, ups=0.27, wpb=763.6, bsz=64, num_updates=6430, lr=1.3552e-05, gnorm=2.65, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50289
2022-05-17 12:42:54 - progress_bar.py[line:272] - INFO: epoch 001:   6451 / 8856 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=755.1, nsentences=64, sample_size=601.2, inner_loss=2.183, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.716, expert1_balance_bottom=21.681, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=205.9, ups=0.27, wpb=755.1, bsz=64, num_updates=6440, lr=1.35399e-05, gnorm=2.371, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50326
2022-05-17 12:43:31 - progress_bar.py[line:272] - INFO: epoch 001:   6461 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=763.8, nsentences=64, sample_size=608.1, inner_loss=2.188, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.469, expert1_balance_bottom=21.867, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=206.3, ups=0.27, wpb=763.8, bsz=64, num_updates=6450, lr=1.35279e-05, gnorm=2.292, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50363
2022-05-17 12:44:06 - progress_bar.py[line:272] - INFO: epoch 001:   6471 / 8856 loss=3.204, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=750.3, nsentences=64, sample_size=597.3, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.647, expert1_balance_bottom=21.306, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.1, ups=0.28, wpb=750.3, bsz=64, num_updates=6460, lr=1.35159e-05, gnorm=2.402, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50399
2022-05-17 12:44:43 - progress_bar.py[line:272] - INFO: epoch 001:   6481 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.905, ntokens=768.3, nsentences=64, sample_size=611.7, inner_loss=2.23, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.903, expert1_balance_bottom=21.382, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=212.2, ups=0.28, wpb=768.3, bsz=64, num_updates=6470, lr=1.35039e-05, gnorm=2.785, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50435
2022-05-17 12:45:21 - progress_bar.py[line:272] - INFO: epoch 001:   6491 / 8856 loss=3.226, loss_v1=0, loss_v2=0, nll_loss=0.901, ntokens=761.9, nsentences=64, sample_size=606, inner_loss=2.225, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.915, expert1_balance_bottom=21.115, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=198.1, ups=0.26, wpb=761.9, bsz=64, num_updates=6480, lr=1.34919e-05, gnorm=2.617, loss_scale=64, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50474
2022-05-17 12:46:16 - progress_bar.py[line:272] - INFO: epoch 001:   6501 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=759.6, nsentences=64, sample_size=604.7, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.749, expert1_balance_bottom=21.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=138.8, ups=0.18, wpb=759.6, bsz=64, num_updates=6490, lr=1.34799e-05, gnorm=2.652, loss_scale=64, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50528
2022-05-17 12:47:40 - progress_bar.py[line:272] - INFO: epoch 001:   6511 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=771, nsentences=64, sample_size=613.4, inner_loss=2.208, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.859, expert1_balance_bottom=21.598, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.1, ups=0.12, wpb=771, bsz=64, num_updates=6500, lr=1.34679e-05, gnorm=2.517, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50612
2022-05-17 12:49:03 - progress_bar.py[line:272] - INFO: epoch 001:   6521 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=768.4, nsentences=64, sample_size=611.8, inner_loss=2.169, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.796, expert1_balance_bottom=21.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.9, ups=0.12, wpb=768.4, bsz=64, num_updates=6510, lr=1.34559e-05, gnorm=2.511, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50696
2022-05-17 12:50:27 - progress_bar.py[line:272] - INFO: epoch 001:   6531 / 8856 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=765.9, nsentences=64, sample_size=609.2, inner_loss=2.189, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.782, expert1_balance_bottom=21.459, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.7, ups=0.12, wpb=765.9, bsz=64, num_updates=6520, lr=1.34438e-05, gnorm=2.477, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50779
2022-05-17 12:51:50 - progress_bar.py[line:272] - INFO: epoch 001:   6541 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=760.1, nsentences=64, sample_size=605.1, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.969, expert1_balance_bottom=21.337, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.2, ups=0.12, wpb=760.1, bsz=64, num_updates=6530, lr=1.34318e-05, gnorm=2.185, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50863
2022-05-17 12:53:13 - progress_bar.py[line:272] - INFO: epoch 001:   6551 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=764.4, nsentences=64, sample_size=608.1, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.968, expert1_balance_bottom=21.508, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.1, ups=0.12, wpb=764.4, bsz=64, num_updates=6540, lr=1.34198e-05, gnorm=2.727, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=50946
2022-05-17 12:54:38 - progress_bar.py[line:272] - INFO: epoch 001:   6561 / 8856 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.834, ntokens=762.8, nsentences=64, sample_size=607.3, inner_loss=2.164, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.13, expert1_balance_bottom=21.406, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.3, ups=0.12, wpb=762.8, bsz=64, num_updates=6550, lr=1.34078e-05, gnorm=2.536, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51030
2022-05-17 12:56:06 - progress_bar.py[line:272] - INFO: epoch 001:   6571 / 8856 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.828, ntokens=758.8, nsentences=64, sample_size=603.6, inner_loss=2.159, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.053, expert1_balance_bottom=21.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=86.4, ups=0.11, wpb=758.8, bsz=64, num_updates=6560, lr=1.33958e-05, gnorm=2.35, loss_scale=64, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51118
2022-05-17 12:57:28 - progress_bar.py[line:272] - INFO: epoch 001:   6581 / 8856 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=767, nsentences=64, sample_size=610.3, inner_loss=2.201, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.846, expert1_balance_bottom=21.592, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.6, ups=0.12, wpb=767, bsz=64, num_updates=6570, lr=1.33838e-05, gnorm=2.742, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51201
2022-05-17 12:58:53 - progress_bar.py[line:272] - INFO: epoch 001:   6591 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=760.2, nsentences=64, sample_size=604.8, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.247, expert1_balance_bottom=21.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.8, ups=0.12, wpb=760.2, bsz=64, num_updates=6580, lr=1.33718e-05, gnorm=2.549, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51286
2022-05-17 13:00:17 - progress_bar.py[line:272] - INFO: epoch 001:   6601 / 8856 loss=3.217, loss_v1=0, loss_v2=0, nll_loss=0.895, ntokens=758, nsentences=64, sample_size=603.1, inner_loss=2.216, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.739, expert1_balance_bottom=21.751, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.4, ups=0.12, wpb=758, bsz=64, num_updates=6590, lr=1.33598e-05, gnorm=2.427, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51369
2022-05-17 13:01:42 - progress_bar.py[line:272] - INFO: epoch 001:   6611 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=755.7, nsentences=64, sample_size=601.6, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.625, expert1_balance_bottom=21.585, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=89, ups=0.12, wpb=755.7, bsz=64, num_updates=6600, lr=1.33477e-05, gnorm=2.571, loss_scale=128, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51454
2022-05-17 13:03:07 - progress_bar.py[line:272] - INFO: epoch 001:   6621 / 8856 loss=3.292, loss_v1=0, loss_v2=0, nll_loss=0.972, ntokens=764, nsentences=64, sample_size=607.9, inner_loss=2.29, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.997, expert1_balance_bottom=21.324, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.96, wps=90.1, ups=0.12, wpb=764, bsz=64, num_updates=6610, lr=1.33357e-05, gnorm=2.716, loss_scale=128, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51539
2022-05-17 13:04:28 - progress_bar.py[line:272] - INFO: epoch 001:   6631 / 8856 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=760.1, nsentences=64, sample_size=605, inner_loss=2.189, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.514, expert1_balance_bottom=21.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=93, ups=0.12, wpb=760.1, bsz=64, num_updates=6620, lr=1.33237e-05, gnorm=2.326, loss_scale=128, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=51621
2022-05-17 13:05:53 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-17 13:06:01 - progress_bar.py[line:272] - INFO: epoch 001:   6642 / 8856 loss=3.21, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=772.9, nsentences=64, sample_size=615.3, inner_loss=2.209, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.592, expert1_balance_bottom=21.711, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=83.2, ups=0.11, wpb=772.9, bsz=64, num_updates=6630, lr=1.33117e-05, gnorm=2.454, loss_scale=64, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51714
2022-05-17 13:07:24 - progress_bar.py[line:272] - INFO: epoch 001:   6652 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=773.2, nsentences=64, sample_size=615.2, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.815, expert1_balance_bottom=21.358, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=93.5, ups=0.12, wpb=773.2, bsz=64, num_updates=6640, lr=1.32997e-05, gnorm=2.134, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51796
2022-05-17 13:08:48 - progress_bar.py[line:272] - INFO: epoch 001:   6662 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=769.6, nsentences=64, sample_size=612.6, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.826, expert1_balance_bottom=21.546, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.3, ups=0.12, wpb=769.6, bsz=64, num_updates=6650, lr=1.32877e-05, gnorm=2.713, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=51881
2022-05-17 13:10:11 - progress_bar.py[line:272] - INFO: epoch 001:   6672 / 8856 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=760, nsentences=64, sample_size=605, inner_loss=2.192, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.422, expert1_balance_bottom=21.59, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.6, ups=0.12, wpb=760, bsz=64, num_updates=6660, lr=1.32757e-05, gnorm=2.706, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=51964
2022-05-17 13:11:34 - progress_bar.py[line:272] - INFO: epoch 001:   6682 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=769.4, nsentences=64, sample_size=612.6, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.803, expert1_balance_bottom=21.512, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=92.9, ups=0.12, wpb=769.4, bsz=64, num_updates=6670, lr=1.32637e-05, gnorm=2.753, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52046
2022-05-17 13:12:57 - progress_bar.py[line:272] - INFO: epoch 001:   6692 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=767.8, nsentences=64, sample_size=610.9, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.055, expert1_balance_bottom=21.277, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.7, ups=0.12, wpb=767.8, bsz=64, num_updates=6680, lr=1.32517e-05, gnorm=2.676, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52129
2022-05-17 13:14:20 - progress_bar.py[line:272] - INFO: epoch 001:   6702 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=758.7, nsentences=64, sample_size=603.6, inner_loss=2.182, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.979, expert1_balance_bottom=21.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.7, ups=0.12, wpb=758.7, bsz=64, num_updates=6690, lr=1.32396e-05, gnorm=2.516, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52213
2022-05-17 13:15:43 - progress_bar.py[line:272] - INFO: epoch 001:   6712 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.875, ntokens=760.9, nsentences=64, sample_size=605.5, inner_loss=2.198, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.232, expert1_balance_bottom=21.066, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.3, ups=0.12, wpb=760.9, bsz=64, num_updates=6700, lr=1.32276e-05, gnorm=2.626, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52295
2022-05-17 13:17:08 - progress_bar.py[line:272] - INFO: epoch 001:   6722 / 8856 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=766.9, nsentences=64, sample_size=610, inner_loss=2.158, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.635, expert1_balance_bottom=21.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.5, ups=0.12, wpb=766.9, bsz=64, num_updates=6710, lr=1.32156e-05, gnorm=2.223, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52380
2022-05-17 13:18:30 - progress_bar.py[line:272] - INFO: epoch 001:   6732 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=769.6, nsentences=64, sample_size=612.7, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.144, expert1_balance_bottom=21.272, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=93.1, ups=0.12, wpb=769.6, bsz=64, num_updates=6720, lr=1.32036e-05, gnorm=2.466, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52463
2022-05-17 13:19:54 - progress_bar.py[line:272] - INFO: epoch 001:   6742 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=762.5, nsentences=64, sample_size=607.3, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.032, expert1_balance_bottom=21.441, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.8, ups=0.12, wpb=762.5, bsz=64, num_updates=6730, lr=1.31916e-05, gnorm=2.368, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52547
2022-05-17 13:21:17 - progress_bar.py[line:272] - INFO: epoch 001:   6752 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=761, nsentences=64, sample_size=606.1, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.152, expert1_balance_bottom=21.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.4, ups=0.12, wpb=761, bsz=64, num_updates=6740, lr=1.31796e-05, gnorm=2.929, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52630
2022-05-17 13:22:41 - progress_bar.py[line:272] - INFO: epoch 001:   6762 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=762.8, nsentences=64, sample_size=606.7, inner_loss=2.174, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.525, expert1_balance_bottom=21.388, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.2, ups=0.12, wpb=762.8, bsz=64, num_updates=6750, lr=1.31676e-05, gnorm=2.579, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52714
2022-05-17 13:24:05 - progress_bar.py[line:272] - INFO: epoch 001:   6772 / 8856 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.897, ntokens=772.2, nsentences=64, sample_size=614.7, inner_loss=2.219, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.991, expert1_balance_bottom=21.611, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92.1, ups=0.12, wpb=772.2, bsz=64, num_updates=6760, lr=1.31556e-05, gnorm=2.658, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52797
2022-05-17 13:25:30 - progress_bar.py[line:272] - INFO: epoch 001:   6782 / 8856 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=770.2, nsentences=64, sample_size=612.6, inner_loss=2.151, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.63, expert1_balance_bottom=21.429, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=90.6, ups=0.12, wpb=770.2, bsz=64, num_updates=6770, lr=1.31435e-05, gnorm=2.286, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52882
2022-05-17 13:26:54 - progress_bar.py[line:272] - INFO: epoch 001:   6792 / 8856 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=770, nsentences=64, sample_size=612.8, inner_loss=2.17, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.974, expert1_balance_bottom=21.281, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.3, ups=0.12, wpb=770, bsz=64, num_updates=6780, lr=1.31315e-05, gnorm=2.559, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=52967
2022-05-17 13:28:18 - progress_bar.py[line:272] - INFO: epoch 001:   6802 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=770.8, nsentences=64, sample_size=613.7, inner_loss=2.178, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.341, expert1_balance_bottom=21.174, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.6, ups=0.12, wpb=770.8, bsz=64, num_updates=6790, lr=1.31195e-05, gnorm=2.502, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53051
2022-05-17 13:29:42 - progress_bar.py[line:272] - INFO: epoch 001:   6812 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=773.4, nsentences=64, sample_size=615.5, inner_loss=2.171, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.742, expert1_balance_bottom=21.256, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=92.7, ups=0.12, wpb=773.4, bsz=64, num_updates=6800, lr=1.31075e-05, gnorm=2.279, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53134
2022-05-17 13:31:06 - progress_bar.py[line:272] - INFO: epoch 001:   6822 / 8856 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=776.8, nsentences=64, sample_size=618.1, inner_loss=2.205, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.108, expert1_balance_bottom=21.209, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.3, ups=0.12, wpb=776.8, bsz=64, num_updates=6810, lr=1.30955e-05, gnorm=2.528, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53219
2022-05-17 13:32:30 - progress_bar.py[line:272] - INFO: epoch 001:   6832 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=752.5, nsentences=64, sample_size=599.3, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.821, expert1_balance_bottom=21.304, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.1, ups=0.12, wpb=752.5, bsz=64, num_updates=6820, lr=1.30835e-05, gnorm=2.431, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=53302
2022-05-17 13:33:54 - progress_bar.py[line:272] - INFO: epoch 001:   6842 / 8856 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=773.2, nsentences=64, sample_size=615.9, inner_loss=2.18, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.805, expert1_balance_bottom=21.539, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.4, ups=0.12, wpb=773.2, bsz=64, num_updates=6830, lr=1.30715e-05, gnorm=2.475, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53387
2022-05-17 13:35:18 - progress_bar.py[line:272] - INFO: epoch 001:   6852 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=760.5, nsentences=64, sample_size=605, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.62, expert1_balance_bottom=21.553, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.5, ups=0.12, wpb=760.5, bsz=64, num_updates=6840, lr=1.30595e-05, gnorm=2.529, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53471
2022-05-17 13:36:42 - progress_bar.py[line:272] - INFO: epoch 001:   6862 / 8856 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.797, ntokens=769.2, nsentences=64, sample_size=612, inner_loss=2.128, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.523, expert1_balance_bottom=21.749, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=91.9, ups=0.12, wpb=769.2, bsz=64, num_updates=6850, lr=1.30474e-05, gnorm=2.368, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53554
2022-05-17 13:38:06 - progress_bar.py[line:272] - INFO: epoch 001:   6872 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.868, ntokens=758.7, nsentences=64, sample_size=603.5, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.543, expert1_balance_bottom=21.416, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.1, ups=0.12, wpb=758.7, bsz=64, num_updates=6860, lr=1.30354e-05, gnorm=2.826, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53639
2022-05-17 13:39:30 - progress_bar.py[line:272] - INFO: epoch 001:   6882 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=759.2, nsentences=64, sample_size=604.4, inner_loss=2.188, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.956, expert1_balance_bottom=21.013, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.9, ups=0.12, wpb=759.2, bsz=64, num_updates=6870, lr=1.30234e-05, gnorm=2.648, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53722
2022-05-17 13:40:54 - progress_bar.py[line:272] - INFO: epoch 001:   6892 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=752.5, nsentences=64, sample_size=598.7, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.827, expert1_balance_bottom=21.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=89.3, ups=0.12, wpb=752.5, bsz=64, num_updates=6880, lr=1.30114e-05, gnorm=2.422, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53806
2022-05-17 13:42:17 - progress_bar.py[line:272] - INFO: epoch 001:   6902 / 8856 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=767.2, nsentences=64, sample_size=610.7, inner_loss=2.159, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.547, expert1_balance_bottom=21.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.9, ups=0.12, wpb=767.2, bsz=64, num_updates=6890, lr=1.29994e-05, gnorm=2.495, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53890
2022-05-17 13:43:40 - progress_bar.py[line:272] - INFO: epoch 001:   6912 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=758.9, nsentences=64, sample_size=604.1, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.819, expert1_balance_bottom=21.303, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.1, ups=0.12, wpb=758.9, bsz=64, num_updates=6900, lr=1.29874e-05, gnorm=2.819, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=53972
2022-05-17 13:45:05 - progress_bar.py[line:272] - INFO: epoch 001:   6922 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=764.6, nsentences=64, sample_size=608.6, inner_loss=2.201, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.061, expert1_balance_bottom=21.341, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.2, ups=0.12, wpb=764.6, bsz=64, num_updates=6910, lr=1.29754e-05, gnorm=2.409, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54057
2022-05-17 13:46:27 - progress_bar.py[line:272] - INFO: epoch 001:   6932 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=762.2, nsentences=64, sample_size=606.4, inner_loss=2.191, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.765, expert1_balance_bottom=21.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.8, ups=0.12, wpb=762.2, bsz=64, num_updates=6920, lr=1.29634e-05, gnorm=2.517, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54139
2022-05-17 13:47:50 - progress_bar.py[line:272] - INFO: epoch 001:   6942 / 8856 loss=3.254, loss_v1=0, loss_v2=0, nll_loss=0.935, ntokens=760, nsentences=64, sample_size=604.4, inner_loss=2.253, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.833, expert1_balance_bottom=21.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.91, wps=91.6, ups=0.12, wpb=760, bsz=64, num_updates=6930, lr=1.29514e-05, gnorm=2.68, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=54222
2022-05-17 13:49:13 - progress_bar.py[line:272] - INFO: epoch 001:   6952 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=764.1, nsentences=64, sample_size=608.5, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.906, expert1_balance_bottom=21.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.2, ups=0.12, wpb=764.1, bsz=64, num_updates=6940, lr=1.29393e-05, gnorm=2.857, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54305
2022-05-17 13:50:36 - progress_bar.py[line:272] - INFO: epoch 001:   6962 / 8856 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=767.3, nsentences=64, sample_size=611.2, inner_loss=2.22, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.44, expert1_balance_bottom=21.215, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.6, ups=0.12, wpb=767.3, bsz=64, num_updates=6950, lr=1.29273e-05, gnorm=2.672, loss_scale=64, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54388
2022-05-17 13:51:59 - progress_bar.py[line:272] - INFO: epoch 001:   6972 / 8856 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=759.7, nsentences=64, sample_size=604.4, inner_loss=2.167, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.065, expert1_balance_bottom=21.252, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.6, ups=0.12, wpb=759.7, bsz=64, num_updates=6960, lr=1.29153e-05, gnorm=2.717, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54472
2022-05-17 13:53:23 - progress_bar.py[line:272] - INFO: epoch 001:   6982 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=766.5, nsentences=64, sample_size=610.5, inner_loss=2.181, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.62, expert1_balance_bottom=21.528, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.7, ups=0.12, wpb=766.5, bsz=64, num_updates=6970, lr=1.29033e-05, gnorm=2.527, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54555
2022-05-17 13:54:46 - progress_bar.py[line:272] - INFO: epoch 001:   6992 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=755.1, nsentences=64, sample_size=600.8, inner_loss=2.195, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.489, expert1_balance_bottom=20.918, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.4, ups=0.12, wpb=755.1, bsz=64, num_updates=6980, lr=1.28913e-05, gnorm=2.676, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54638
2022-05-17 13:56:09 - progress_bar.py[line:272] - INFO: epoch 001:   7002 / 8856 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=763.8, nsentences=64, sample_size=607.9, inner_loss=2.16, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.019, expert1_balance_bottom=21.146, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.3, ups=0.12, wpb=763.8, bsz=64, num_updates=6990, lr=1.28793e-05, gnorm=2.5, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54722
2022-05-17 13:57:34 - progress_bar.py[line:272] - INFO: epoch 001:   7012 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=772.4, nsentences=64, sample_size=614.9, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.837, expert1_balance_bottom=21.462, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.5, ups=0.12, wpb=772.4, bsz=64, num_updates=7000, lr=1.28673e-05, gnorm=2.625, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54806
2022-05-17 13:58:57 - progress_bar.py[line:272] - INFO: epoch 001:   7022 / 8856 loss=3.121, loss_v1=0, loss_v2=0, nll_loss=0.79, ntokens=760.5, nsentences=64, sample_size=605.5, inner_loss=2.12, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.841, expert1_balance_bottom=21.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=91.1, ups=0.12, wpb=760.5, bsz=64, num_updates=7010, lr=1.28553e-05, gnorm=2.432, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54890
2022-05-17 14:00:21 - progress_bar.py[line:272] - INFO: epoch 001:   7032 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=761.9, nsentences=64, sample_size=606.6, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.009, expert1_balance_bottom=21.478, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=90.6, ups=0.12, wpb=761.9, bsz=64, num_updates=7020, lr=1.28432e-05, gnorm=2.97, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=54974
2022-05-17 14:01:46 - progress_bar.py[line:272] - INFO: epoch 001:   7042 / 8856 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=762.4, nsentences=64, sample_size=606.9, inner_loss=2.193, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.639, expert1_balance_bottom=21.342, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=89.5, ups=0.12, wpb=762.4, bsz=64, num_updates=7030, lr=1.28312e-05, gnorm=2.86, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55059
2022-05-17 14:03:10 - progress_bar.py[line:272] - INFO: epoch 001:   7052 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.889, ntokens=766.1, nsentences=64, sample_size=610.1, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.869, expert1_balance_bottom=21.47, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=91.7, ups=0.12, wpb=766.1, bsz=64, num_updates=7040, lr=1.28192e-05, gnorm=2.432, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55142
2022-05-17 14:04:34 - progress_bar.py[line:272] - INFO: epoch 001:   7062 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=759.4, nsentences=64, sample_size=603.7, inner_loss=2.178, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.913, expert1_balance_bottom=21.503, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.8, ups=0.12, wpb=759.4, bsz=64, num_updates=7050, lr=1.28072e-05, gnorm=2.55, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55226
2022-05-17 14:05:57 - progress_bar.py[line:272] - INFO: epoch 001:   7072 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=764.3, nsentences=64, sample_size=608.4, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.755, expert1_balance_bottom=21.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.8, ups=0.12, wpb=764.3, bsz=64, num_updates=7060, lr=1.27952e-05, gnorm=2.301, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55309
2022-05-17 14:07:19 - progress_bar.py[line:272] - INFO: epoch 001:   7082 / 8856 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=778.3, nsentences=64, sample_size=619.5, inner_loss=2.159, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.387, expert1_balance_bottom=21.588, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=94.4, ups=0.12, wpb=778.3, bsz=64, num_updates=7070, lr=1.27832e-05, gnorm=2.287, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55392
2022-05-17 14:08:44 - progress_bar.py[line:272] - INFO: epoch 001:   7092 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=756.4, nsentences=64, sample_size=601.7, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.252, expert1_balance_bottom=21.263, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.6, ups=0.12, wpb=756.4, bsz=64, num_updates=7080, lr=1.27712e-05, gnorm=2.525, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55476
2022-05-17 14:10:07 - progress_bar.py[line:272] - INFO: epoch 001:   7102 / 8856 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.829, ntokens=753, nsentences=64, sample_size=599.3, inner_loss=2.157, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.735, expert1_balance_bottom=21.769, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.2, ups=0.12, wpb=753, bsz=64, num_updates=7090, lr=1.27592e-05, gnorm=2.595, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55560
2022-05-17 14:11:30 - progress_bar.py[line:272] - INFO: epoch 001:   7112 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=767.1, nsentences=64, sample_size=610.8, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.745, expert1_balance_bottom=21.616, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.9, ups=0.12, wpb=767.1, bsz=64, num_updates=7100, lr=1.27471e-05, gnorm=2.437, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55642
2022-05-17 14:12:54 - progress_bar.py[line:272] - INFO: epoch 001:   7122 / 8856 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=766.3, nsentences=64, sample_size=610.1, inner_loss=2.189, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.921, expert1_balance_bottom=21.328, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.7, ups=0.12, wpb=766.3, bsz=64, num_updates=7110, lr=1.27351e-05, gnorm=2.653, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55727
2022-05-17 14:14:19 - progress_bar.py[line:272] - INFO: epoch 001:   7132 / 8856 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=769.6, nsentences=64, sample_size=612.4, inner_loss=2.141, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.844, expert1_balance_bottom=21.255, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=91.2, ups=0.12, wpb=769.6, bsz=64, num_updates=7120, lr=1.27231e-05, gnorm=2.598, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55811
2022-05-17 14:15:41 - progress_bar.py[line:272] - INFO: epoch 001:   7142 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.904, ntokens=769.9, nsentences=64, sample_size=613, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.961, expert1_balance_bottom=21.284, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=93.6, ups=0.12, wpb=769.9, bsz=64, num_updates=7130, lr=1.27111e-05, gnorm=2.823, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55893
2022-05-17 14:16:58 - progress_bar.py[line:272] - INFO: epoch 001:   7152 / 8856 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=772.7, nsentences=64, sample_size=615.1, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.831, expert1_balance_bottom=21.169, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=99.8, ups=0.13, wpb=772.7, bsz=64, num_updates=7140, lr=1.26991e-05, gnorm=2.668, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=55971
2022-05-17 14:17:37 - progress_bar.py[line:272] - INFO: epoch 001:   7162 / 8856 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=760.2, nsentences=64, sample_size=605.1, inner_loss=2.194, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.855, expert1_balance_bottom=21.449, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=197.8, ups=0.26, wpb=760.2, bsz=64, num_updates=7150, lr=1.26871e-05, gnorm=2.487, loss_scale=128, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56009
2022-05-17 14:18:14 - progress_bar.py[line:272] - INFO: epoch 001:   7172 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.865, ntokens=782, nsentences=64, sample_size=622.4, inner_loss=2.191, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.823, expert1_balance_bottom=21.398, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=207.6, ups=0.27, wpb=782, bsz=64, num_updates=7160, lr=1.26751e-05, gnorm=2.655, loss_scale=128, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56047
2022-05-17 14:18:52 - progress_bar.py[line:272] - INFO: epoch 001:   7182 / 8856 loss=3.128, loss_v1=0, loss_v2=0, nll_loss=0.795, ntokens=781.6, nsentences=64, sample_size=621.7, inner_loss=2.128, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.3, expert1_balance_bottom=21.8, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=208.3, ups=0.27, wpb=781.6, bsz=64, num_updates=7170, lr=1.26631e-05, gnorm=2.119, loss_scale=128, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56084
2022-05-17 14:19:03 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2022-05-17 14:19:33 - progress_bar.py[line:272] - INFO: epoch 001:   7193 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.879, ntokens=779.7, nsentences=64, sample_size=620.4, inner_loss=2.206, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.567, expert1_balance_bottom=21.71, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=187.9, ups=0.24, wpb=779.7, bsz=64, num_updates=7180, lr=1.26511e-05, gnorm=2.295, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56126
2022-05-17 14:20:11 - progress_bar.py[line:272] - INFO: epoch 001:   7203 / 8856 loss=3.245, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=766.2, nsentences=64, sample_size=609.7, inner_loss=2.244, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.731, expert1_balance_bottom=21.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=201.9, ups=0.26, wpb=766.2, bsz=64, num_updates=7190, lr=1.2639e-05, gnorm=2.668, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56164
2022-05-17 14:20:49 - progress_bar.py[line:272] - INFO: epoch 001:   7213 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=764.5, nsentences=64, sample_size=608.3, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.464, expert1_balance_bottom=21.69, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=203.9, ups=0.27, wpb=764.5, bsz=64, num_updates=7200, lr=1.2627e-05, gnorm=2.535, loss_scale=64, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=56201
2022-05-17 14:21:25 - progress_bar.py[line:272] - INFO: epoch 001:   7223 / 8856 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=771, nsentences=64, sample_size=613.7, inner_loss=2.194, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.033, expert1_balance_bottom=21.327, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=210.9, ups=0.27, wpb=771, bsz=64, num_updates=7210, lr=1.2615e-05, gnorm=2.245, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56238
2022-05-17 14:22:04 - progress_bar.py[line:272] - INFO: epoch 001:   7233 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=769.7, nsentences=64, sample_size=612.5, inner_loss=2.169, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.943, expert1_balance_bottom=21.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=200.4, ups=0.26, wpb=769.7, bsz=64, num_updates=7220, lr=1.2603e-05, gnorm=2.343, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56276
2022-05-17 14:22:41 - progress_bar.py[line:272] - INFO: epoch 001:   7243 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=756, nsentences=64, sample_size=601.6, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.885, expert1_balance_bottom=21.534, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=201.4, ups=0.27, wpb=756, bsz=64, num_updates=7230, lr=1.2591e-05, gnorm=2.631, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56314
2022-05-17 14:23:18 - progress_bar.py[line:272] - INFO: epoch 001:   7253 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=761.7, nsentences=64, sample_size=606.1, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.698, expert1_balance_bottom=21.454, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=210.1, ups=0.28, wpb=761.7, bsz=64, num_updates=7240, lr=1.2579e-05, gnorm=2.681, loss_scale=64, train_wall=31, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=56350
2022-05-17 14:23:55 - progress_bar.py[line:272] - INFO: epoch 001:   7263 / 8856 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=760.4, nsentences=64, sample_size=605.3, inner_loss=2.221, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.62, expert1_balance_bottom=21.692, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=201.3, ups=0.26, wpb=760.4, bsz=64, num_updates=7250, lr=1.2567e-05, gnorm=2.669, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56388
2022-05-17 14:25:03 - progress_bar.py[line:272] - INFO: epoch 001:   7273 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=769.4, nsentences=64, sample_size=612.1, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.832, expert1_balance_bottom=21.509, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=113.6, ups=0.15, wpb=769.4, bsz=64, num_updates=7260, lr=1.2555e-05, gnorm=2.657, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56456
2022-05-17 14:26:28 - progress_bar.py[line:272] - INFO: epoch 001:   7283 / 8856 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=766, nsentences=64, sample_size=609.6, inner_loss=2.154, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.558, expert1_balance_bottom=21.347, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.7, ups=0.12, wpb=766, bsz=64, num_updates=7270, lr=1.25429e-05, gnorm=2.569, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56540
2022-05-17 14:27:52 - progress_bar.py[line:272] - INFO: epoch 001:   7293 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=756.9, nsentences=64, sample_size=602.3, inner_loss=2.168, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.959, expert1_balance_bottom=21.261, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=89.4, ups=0.12, wpb=756.9, bsz=64, num_updates=7280, lr=1.25309e-05, gnorm=2.453, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56625
2022-05-17 14:28:25 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-17 14:29:24 - progress_bar.py[line:272] - INFO: epoch 001:   7304 / 8856 loss=3.198, loss_v1=0, loss_v2=0, nll_loss=0.869, ntokens=755.4, nsentences=64, sample_size=601, inner_loss=2.197, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.824, expert1_balance_bottom=21.595, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=82.7, ups=0.11, wpb=755.4, bsz=64, num_updates=7290, lr=1.25189e-05, gnorm=2.457, loss_scale=32, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56716
2022-05-17 14:30:50 - progress_bar.py[line:272] - INFO: epoch 001:   7314 / 8856 loss=3.212, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=761.4, nsentences=64, sample_size=605.8, inner_loss=2.211, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.824, expert1_balance_bottom=21.715, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=88.7, ups=0.12, wpb=761.4, bsz=64, num_updates=7300, lr=1.25069e-05, gnorm=2.475, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56802
2022-05-17 14:32:14 - progress_bar.py[line:272] - INFO: epoch 001:   7324 / 8856 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=760.3, nsentences=64, sample_size=604.5, inner_loss=2.18, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.798, expert1_balance_bottom=21.31, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.7, ups=0.12, wpb=760.3, bsz=64, num_updates=7310, lr=1.24949e-05, gnorm=2.277, loss_scale=32, train_wall=36, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56887
2022-05-17 14:33:38 - progress_bar.py[line:272] - INFO: epoch 001:   7334 / 8856 loss=3.151, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=768.8, nsentences=64, sample_size=611.7, inner_loss=2.15, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.784, expert1_balance_bottom=21.652, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=91.9, ups=0.12, wpb=768.8, bsz=64, num_updates=7320, lr=1.24829e-05, gnorm=2.894, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=56970
2022-05-17 14:35:03 - progress_bar.py[line:272] - INFO: epoch 001:   7344 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=763.2, nsentences=64, sample_size=607.5, inner_loss=2.184, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.004, expert1_balance_bottom=21.129, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.3, ups=0.12, wpb=763.2, bsz=64, num_updates=7330, lr=1.24709e-05, gnorm=2.387, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57055
2022-05-17 14:36:30 - progress_bar.py[line:272] - INFO: epoch 001:   7354 / 8856 loss=3.193, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=756.6, nsentences=64, sample_size=601.9, inner_loss=2.192, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.958, expert1_balance_bottom=21.437, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=86.6, ups=0.11, wpb=756.6, bsz=64, num_updates=7340, lr=1.24589e-05, gnorm=2.511, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57142
2022-05-17 14:37:49 - progress_bar.py[line:272] - INFO: epoch 001:   7364 / 8856 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=766.1, nsentences=64, sample_size=609.3, inner_loss=2.201, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.171, expert1_balance_bottom=21.311, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=97.4, ups=0.13, wpb=766.1, bsz=64, num_updates=7350, lr=1.24468e-05, gnorm=2.503, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57221
2022-05-17 14:38:27 - progress_bar.py[line:272] - INFO: epoch 001:   7374 / 8856 loss=3.19, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=757.8, nsentences=64, sample_size=603, inner_loss=2.189, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.8, expert1_balance_bottom=21.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=199.3, ups=0.26, wpb=757.8, bsz=64, num_updates=7360, lr=1.24348e-05, gnorm=2.328, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57259
2022-05-17 14:39:04 - progress_bar.py[line:272] - INFO: epoch 001:   7384 / 8856 loss=3.159, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=767.8, nsentences=64, sample_size=611, inner_loss=2.158, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.668, expert1_balance_bottom=21.649, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=206.5, ups=0.27, wpb=767.8, bsz=64, num_updates=7370, lr=1.24228e-05, gnorm=2.298, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57296
2022-05-17 14:39:42 - progress_bar.py[line:272] - INFO: epoch 001:   7394 / 8856 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=773.8, nsentences=64, sample_size=615.7, inner_loss=2.174, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.974, expert1_balance_bottom=21.561, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=201.5, ups=0.26, wpb=773.8, bsz=64, num_updates=7380, lr=1.24108e-05, gnorm=2.57, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57335
2022-05-17 14:40:20 - progress_bar.py[line:272] - INFO: epoch 001:   7404 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.918, ntokens=769.6, nsentences=64, sample_size=611.9, inner_loss=2.237, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.956, expert1_balance_bottom=21.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=200.7, ups=0.26, wpb=769.6, bsz=64, num_updates=7390, lr=1.23988e-05, gnorm=2.66, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57373
2022-05-17 14:40:58 - progress_bar.py[line:272] - INFO: epoch 001:   7414 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=762.6, nsentences=64, sample_size=606.9, inner_loss=2.218, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.63, expert1_balance_bottom=21.375, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=202.8, ups=0.27, wpb=762.6, bsz=64, num_updates=7400, lr=1.23868e-05, gnorm=2.631, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57411
2022-05-17 14:41:36 - progress_bar.py[line:272] - INFO: epoch 001:   7424 / 8856 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.823, ntokens=766.9, nsentences=64, sample_size=610.7, inner_loss=2.152, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.829, expert1_balance_bottom=21.545, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=200.6, ups=0.26, wpb=766.9, bsz=64, num_updates=7410, lr=1.23748e-05, gnorm=2.387, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57449
2022-05-17 14:42:13 - progress_bar.py[line:272] - INFO: epoch 001:   7434 / 8856 loss=3.225, loss_v1=0, loss_v2=0, nll_loss=0.903, ntokens=782.3, nsentences=64, sample_size=622.9, inner_loss=2.224, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.917, expert1_balance_bottom=21.354, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=213.3, ups=0.27, wpb=782.3, bsz=64, num_updates=7420, lr=1.23628e-05, gnorm=2.471, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57485
2022-05-17 14:42:51 - progress_bar.py[line:272] - INFO: epoch 001:   7444 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=754.3, nsentences=64, sample_size=600.4, inner_loss=2.172, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.394, expert1_balance_bottom=21.182, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=199.3, ups=0.26, wpb=754.3, bsz=64, num_updates=7430, lr=1.23508e-05, gnorm=2.614, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57523
2022-05-17 14:43:28 - progress_bar.py[line:272] - INFO: epoch 001:   7454 / 8856 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=764.3, nsentences=64, sample_size=608.9, inner_loss=2.177, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.325, expert1_balance_bottom=21.153, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=203, ups=0.27, wpb=764.3, bsz=64, num_updates=7440, lr=1.23387e-05, gnorm=2.522, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57561
2022-05-17 14:44:05 - progress_bar.py[line:272] - INFO: epoch 001:   7464 / 8856 loss=3.206, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=769.8, nsentences=64, sample_size=612.9, inner_loss=2.205, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.066, expert1_balance_bottom=21.364, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=209.2, ups=0.27, wpb=769.8, bsz=64, num_updates=7450, lr=1.23267e-05, gnorm=2.544, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57598
2022-05-17 14:44:44 - progress_bar.py[line:272] - INFO: epoch 001:   7474 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=761, nsentences=64, sample_size=605.5, inner_loss=2.17, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.663, expert1_balance_bottom=21.648, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=197.2, ups=0.26, wpb=761, bsz=64, num_updates=7460, lr=1.23147e-05, gnorm=3.575, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57636
2022-05-17 14:45:21 - progress_bar.py[line:272] - INFO: epoch 001:   7484 / 8856 loss=3.2, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=751.6, nsentences=64, sample_size=598, inner_loss=2.199, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.428, expert1_balance_bottom=21.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=202.5, ups=0.27, wpb=751.6, bsz=64, num_updates=7470, lr=1.23027e-05, gnorm=2.955, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57673
2022-05-17 14:46:14 - progress_bar.py[line:272] - INFO: epoch 001:   7494 / 8856 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.811, ntokens=769.7, nsentences=64, sample_size=612.5, inner_loss=2.141, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.572, expert1_balance_bottom=21.71, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=145.6, ups=0.19, wpb=769.7, bsz=64, num_updates=7480, lr=1.22907e-05, gnorm=2.544, loss_scale=32, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57726
2022-05-17 14:47:38 - progress_bar.py[line:272] - INFO: epoch 001:   7504 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.916, ntokens=766, nsentences=64, sample_size=609.6, inner_loss=2.237, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.823, expert1_balance_bottom=21.297, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=91, ups=0.12, wpb=766, bsz=64, num_updates=7490, lr=1.22787e-05, gnorm=2.844, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57810
2022-05-17 14:49:01 - progress_bar.py[line:272] - INFO: epoch 001:   7514 / 8856 loss=3.129, loss_v1=0, loss_v2=0, nll_loss=0.796, ntokens=764.5, nsentences=64, sample_size=608.3, inner_loss=2.128, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.495, expert1_balance_bottom=21.64, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=92.6, ups=0.12, wpb=764.5, bsz=64, num_updates=7500, lr=1.22667e-05, gnorm=2.401, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=57893
2022-05-17 14:50:24 - progress_bar.py[line:272] - INFO: epoch 001:   7524 / 8856 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=754.2, nsentences=64, sample_size=599.9, inner_loss=2.184, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.895, expert1_balance_bottom=21.524, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.6, ups=0.12, wpb=754.2, bsz=64, num_updates=7510, lr=1.22547e-05, gnorm=2.719, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=57976
2022-05-17 14:51:47 - progress_bar.py[line:272] - INFO: epoch 001:   7534 / 8856 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=758.9, nsentences=64, sample_size=603.9, inner_loss=2.159, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.539, expert1_balance_bottom=21.577, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.6, ups=0.12, wpb=758.9, bsz=64, num_updates=7520, lr=1.22426e-05, gnorm=2.334, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58059
2022-05-17 14:53:10 - progress_bar.py[line:272] - INFO: epoch 001:   7544 / 8856 loss=3.23, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=770, nsentences=64, sample_size=612.9, inner_loss=2.229, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.542, expert1_balance_bottom=21.708, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=92.9, ups=0.12, wpb=770, bsz=64, num_updates=7530, lr=1.22306e-05, gnorm=2.773, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58142
2022-05-17 14:54:33 - progress_bar.py[line:272] - INFO: epoch 001:   7554 / 8856 loss=3.202, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=766, nsentences=64, sample_size=609.6, inner_loss=2.201, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.82, expert1_balance_bottom=21.5, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=91.5, ups=0.12, wpb=766, bsz=64, num_updates=7540, lr=1.22186e-05, gnorm=2.434, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58226
2022-05-17 14:55:56 - progress_bar.py[line:272] - INFO: epoch 001:   7564 / 8856 loss=3.185, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=758.5, nsentences=64, sample_size=603.6, inner_loss=2.184, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.557, expert1_balance_bottom=21.488, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.7, ups=0.12, wpb=758.5, bsz=64, num_updates=7550, lr=1.22066e-05, gnorm=2.348, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58308
2022-05-17 14:57:18 - progress_bar.py[line:272] - INFO: epoch 001:   7574 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.917, ntokens=772.1, nsentences=64, sample_size=614.2, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.942, expert1_balance_bottom=21.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=94, ups=0.12, wpb=772.1, bsz=64, num_updates=7560, lr=1.21946e-05, gnorm=2.524, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58391
2022-05-17 14:58:43 - progress_bar.py[line:272] - INFO: epoch 001:   7584 / 8856 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=756.2, nsentences=64, sample_size=601.7, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.033, expert1_balance_bottom=21.38, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=89.5, ups=0.12, wpb=756.2, bsz=64, num_updates=7570, lr=1.21826e-05, gnorm=2.408, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58475
2022-05-17 15:00:06 - progress_bar.py[line:272] - INFO: epoch 001:   7594 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=776.4, nsentences=64, sample_size=617.9, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.085, expert1_balance_bottom=21.492, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=93.5, ups=0.12, wpb=776.4, bsz=64, num_updates=7580, lr=1.21706e-05, gnorm=2.383, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58558
2022-05-17 15:01:29 - progress_bar.py[line:272] - INFO: epoch 001:   7604 / 8856 loss=3.261, loss_v1=0, loss_v2=0, nll_loss=0.944, ntokens=767.1, nsentences=64, sample_size=611, inner_loss=2.26, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.837, expert1_balance_bottom=21.326, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.92, wps=92, ups=0.12, wpb=767.1, bsz=64, num_updates=7590, lr=1.21586e-05, gnorm=2.73, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58642
2022-05-17 15:02:53 - progress_bar.py[line:272] - INFO: epoch 001:   7614 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=769.1, nsentences=64, sample_size=612.5, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.621, expert1_balance_bottom=21.334, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.5, ups=0.12, wpb=769.1, bsz=64, num_updates=7600, lr=1.21465e-05, gnorm=2.439, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58726
2022-05-17 15:04:16 - progress_bar.py[line:272] - INFO: epoch 001:   7624 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=754.9, nsentences=64, sample_size=601.2, inner_loss=2.172, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.885, expert1_balance_bottom=21.468, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.8, ups=0.12, wpb=754.9, bsz=64, num_updates=7610, lr=1.21345e-05, gnorm=2.923, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58809
2022-05-17 15:05:40 - progress_bar.py[line:272] - INFO: epoch 001:   7634 / 8856 loss=3.16, loss_v1=0, loss_v2=0, nll_loss=0.83, ntokens=764.5, nsentences=64, sample_size=608.5, inner_loss=2.159, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.462, expert1_balance_bottom=21.532, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.3, ups=0.12, wpb=764.5, bsz=64, num_updates=7620, lr=1.21225e-05, gnorm=2.562, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58892
2022-05-17 15:07:03 - progress_bar.py[line:272] - INFO: epoch 001:   7644 / 8856 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=768.2, nsentences=64, sample_size=611.1, inner_loss=2.177, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.998, expert1_balance_bottom=21.747, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92, ups=0.12, wpb=768.2, bsz=64, num_updates=7630, lr=1.21105e-05, gnorm=2.244, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=58976
2022-05-17 15:08:27 - progress_bar.py[line:272] - INFO: epoch 001:   7654 / 8856 loss=3.237, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=774.3, nsentences=64, sample_size=616.1, inner_loss=2.236, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.423, expert1_balance_bottom=21.629, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=92.5, ups=0.12, wpb=774.3, bsz=64, num_updates=7640, lr=1.20985e-05, gnorm=2.546, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=59060
2022-05-17 15:09:51 - progress_bar.py[line:272] - INFO: epoch 001:   7664 / 8856 loss=3.22, loss_v1=0, loss_v2=0, nll_loss=0.898, ntokens=770.3, nsentences=64, sample_size=613.1, inner_loss=2.219, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.476, expert1_balance_bottom=21.777, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=92, ups=0.12, wpb=770.3, bsz=64, num_updates=7650, lr=1.20865e-05, gnorm=2.38, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59143
2022-05-17 15:11:14 - progress_bar.py[line:272] - INFO: epoch 001:   7674 / 8856 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=765.6, nsentences=64, sample_size=609.4, inner_loss=2.193, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.357, expert1_balance_bottom=21.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.5, ups=0.12, wpb=765.6, bsz=64, num_updates=7660, lr=1.20745e-05, gnorm=2.32, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59226
2022-05-17 15:12:37 - progress_bar.py[line:272] - INFO: epoch 001:   7684 / 8856 loss=3.171, loss_v1=0, loss_v2=0, nll_loss=0.845, ntokens=762.3, nsentences=64, sample_size=606.5, inner_loss=2.17, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.719, expert1_balance_bottom=21.77, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.8, ups=0.12, wpb=762.3, bsz=64, num_updates=7670, lr=1.20625e-05, gnorm=2.611, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59309
2022-05-17 15:13:59 - progress_bar.py[line:272] - INFO: epoch 001:   7694 / 8856 loss=3.219, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=777.3, nsentences=64, sample_size=618.8, inner_loss=2.218, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.48, expert1_balance_bottom=21.436, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=94.6, ups=0.12, wpb=777.3, bsz=64, num_updates=7680, lr=1.20505e-05, gnorm=2.9, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59391
2022-05-17 15:15:23 - progress_bar.py[line:272] - INFO: epoch 001:   7704 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.883, ntokens=770.4, nsentences=64, sample_size=613.2, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.654, expert1_balance_bottom=21.473, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.6, ups=0.12, wpb=770.4, bsz=64, num_updates=7690, lr=1.20384e-05, gnorm=2.516, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=59475
2022-05-17 15:16:48 - progress_bar.py[line:272] - INFO: epoch 001:   7714 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=758.5, nsentences=64, sample_size=603.8, inner_loss=2.178, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.407, expert1_balance_bottom=21.675, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.6, ups=0.12, wpb=758.5, bsz=64, num_updates=7700, lr=1.20264e-05, gnorm=2.293, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59560
2022-05-17 15:18:13 - progress_bar.py[line:272] - INFO: epoch 001:   7724 / 8856 loss=3.155, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=763.3, nsentences=64, sample_size=607.2, inner_loss=2.154, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.641, expert1_balance_bottom=21.66, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=89.3, ups=0.12, wpb=763.3, bsz=64, num_updates=7710, lr=1.20144e-05, gnorm=2.222, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59646
2022-05-17 15:19:37 - progress_bar.py[line:272] - INFO: epoch 001:   7734 / 8856 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=764.1, nsentences=64, sample_size=608.4, inner_loss=2.149, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.693, expert1_balance_bottom=21.67, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=90.9, ups=0.12, wpb=764.1, bsz=64, num_updates=7720, lr=1.20024e-05, gnorm=2.309, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59730
2022-05-17 15:21:02 - progress_bar.py[line:272] - INFO: epoch 001:   7744 / 8856 loss=3.158, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=771.6, nsentences=64, sample_size=614.1, inner_loss=2.157, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.514, expert1_balance_bottom=21.583, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.3, ups=0.12, wpb=771.6, bsz=64, num_updates=7730, lr=1.19904e-05, gnorm=2.569, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59814
2022-05-17 15:22:25 - progress_bar.py[line:272] - INFO: epoch 001:   7754 / 8856 loss=3.232, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=773.5, nsentences=64, sample_size=615.5, inner_loss=2.231, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.759, expert1_balance_bottom=21.605, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=92.4, ups=0.12, wpb=773.5, bsz=64, num_updates=7740, lr=1.19784e-05, gnorm=2.426, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59898
2022-05-17 15:23:47 - progress_bar.py[line:272] - INFO: epoch 001:   7764 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=773.7, nsentences=64, sample_size=616, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.329, expert1_balance_bottom=21.654, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=94.3, ups=0.12, wpb=773.7, bsz=64, num_updates=7750, lr=1.19664e-05, gnorm=2.443, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=59980
2022-05-17 15:25:11 - progress_bar.py[line:272] - INFO: epoch 001:   7774 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=756.7, nsentences=64, sample_size=602.1, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.57, expert1_balance_bottom=21.607, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.8, ups=0.12, wpb=756.7, bsz=64, num_updates=7760, lr=1.19544e-05, gnorm=2.423, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60063
2022-05-17 15:26:35 - progress_bar.py[line:272] - INFO: epoch 001:   7784 / 8856 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.832, ntokens=761.3, nsentences=64, sample_size=606, inner_loss=2.16, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.771, expert1_balance_bottom=21.744, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90, ups=0.12, wpb=761.3, bsz=64, num_updates=7770, lr=1.19423e-05, gnorm=2.289, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60148
2022-05-17 15:27:59 - progress_bar.py[line:272] - INFO: epoch 001:   7794 / 8856 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.831, ntokens=768.2, nsentences=64, sample_size=611.5, inner_loss=2.16, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.544, expert1_balance_bottom=21.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=91.6, ups=0.12, wpb=768.2, bsz=64, num_updates=7780, lr=1.19303e-05, gnorm=2.324, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60232
2022-05-17 15:29:24 - progress_bar.py[line:272] - INFO: epoch 001:   7804 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=769.7, nsentences=64, sample_size=612.3, inner_loss=2.202, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.007, expert1_balance_bottom=21.211, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=91.1, ups=0.12, wpb=769.7, bsz=64, num_updates=7790, lr=1.19183e-05, gnorm=2.607, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60316
2022-05-17 15:30:48 - progress_bar.py[line:272] - INFO: epoch 001:   7814 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.844, ntokens=762, nsentences=64, sample_size=606.5, inner_loss=2.169, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.809, expert1_balance_bottom=21.472, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.6, ups=0.12, wpb=762, bsz=64, num_updates=7800, lr=1.19063e-05, gnorm=2.478, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60400
2022-05-17 15:32:12 - progress_bar.py[line:272] - INFO: epoch 001:   7824 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=749.5, nsentences=64, sample_size=596.3, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.526, expert1_balance_bottom=21.63, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=89.4, ups=0.12, wpb=749.5, bsz=64, num_updates=7810, lr=1.18943e-05, gnorm=2.713, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60484
2022-05-17 15:33:33 - progress_bar.py[line:272] - INFO: epoch 001:   7834 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=778.6, nsentences=64, sample_size=619.5, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.685, expert1_balance_bottom=21.52, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=95.5, ups=0.12, wpb=778.6, bsz=64, num_updates=7820, lr=1.18823e-05, gnorm=2.951, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60566
2022-05-17 15:34:57 - progress_bar.py[line:272] - INFO: epoch 001:   7844 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.854, ntokens=777.5, nsentences=64, sample_size=618.8, inner_loss=2.182, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.064, expert1_balance_bottom=21.572, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=92.5, ups=0.12, wpb=777.5, bsz=64, num_updates=7830, lr=1.18703e-05, gnorm=3.282, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60650
2022-05-17 15:36:20 - progress_bar.py[line:272] - INFO: epoch 001:   7854 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.866, ntokens=773.6, nsentences=64, sample_size=615.4, inner_loss=2.191, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.499, expert1_balance_bottom=21.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=92.9, ups=0.12, wpb=773.6, bsz=64, num_updates=7840, lr=1.18583e-05, gnorm=2.532, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60733
2022-05-17 15:37:45 - progress_bar.py[line:272] - INFO: epoch 001:   7864 / 8856 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=770.7, nsentences=64, sample_size=613.3, inner_loss=2.148, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.112, expert1_balance_bottom=21.491, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=91.1, ups=0.12, wpb=770.7, bsz=64, num_updates=7850, lr=1.18462e-05, gnorm=2.677, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60818
2022-05-17 15:39:07 - progress_bar.py[line:272] - INFO: epoch 001:   7874 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=765, nsentences=64, sample_size=608.5, inner_loss=2.188, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.532, expert1_balance_bottom=21.758, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=93.5, ups=0.12, wpb=765, bsz=64, num_updates=7860, lr=1.18342e-05, gnorm=2.591, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=60899
2022-05-17 15:40:29 - progress_bar.py[line:272] - INFO: epoch 001:   7884 / 8856 loss=3.154, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=755.6, nsentences=64, sample_size=601, inner_loss=2.153, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.451, expert1_balance_bottom=21.638, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=92.2, ups=0.12, wpb=755.6, bsz=64, num_updates=7870, lr=1.18222e-05, gnorm=2.806, loss_scale=64, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=60981
2022-05-17 15:41:53 - progress_bar.py[line:272] - INFO: epoch 001:   7894 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.913, ntokens=762.4, nsentences=64, sample_size=606.7, inner_loss=2.23, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.522, expert1_balance_bottom=21.656, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=90.5, ups=0.12, wpb=762.4, bsz=64, num_updates=7880, lr=1.18102e-05, gnorm=2.821, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61066
2022-05-17 15:43:17 - progress_bar.py[line:272] - INFO: epoch 001:   7904 / 8856 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.9, ntokens=768.1, nsentences=64, sample_size=611, inner_loss=2.22, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.93, expert1_balance_bottom=21.259, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=92.1, ups=0.12, wpb=768.1, bsz=64, num_updates=7890, lr=1.17982e-05, gnorm=2.771, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61149
2022-05-17 15:44:40 - progress_bar.py[line:272] - INFO: epoch 001:   7914 / 8856 loss=3.216, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=750.3, nsentences=64, sample_size=596.9, inner_loss=2.215, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.855, expert1_balance_bottom=21.119, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=90.1, ups=0.12, wpb=750.3, bsz=64, num_updates=7900, lr=1.17862e-05, gnorm=2.761, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=61232
2022-05-17 15:46:04 - progress_bar.py[line:272] - INFO: epoch 001:   7924 / 8856 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.81, ntokens=775.4, nsentences=64, sample_size=617.2, inner_loss=2.138, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.589, expert1_balance_bottom=21.481, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=92, ups=0.12, wpb=775.4, bsz=64, num_updates=7910, lr=1.17742e-05, gnorm=2.234, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61317
2022-05-17 15:47:26 - progress_bar.py[line:272] - INFO: epoch 001:   7934 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.853, ntokens=751.3, nsentences=64, sample_size=597.5, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.073, expert1_balance_bottom=21.154, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.3, ups=0.12, wpb=751.3, bsz=64, num_updates=7920, lr=1.17622e-05, gnorm=2.583, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61399
2022-05-17 15:48:48 - progress_bar.py[line:272] - INFO: epoch 001:   7944 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=759.7, nsentences=64, sample_size=604.5, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.717, expert1_balance_bottom=21.689, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.5, ups=0.12, wpb=759.7, bsz=64, num_updates=7930, lr=1.17502e-05, gnorm=2.571, loss_scale=64, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=61481
2022-05-17 15:50:13 - progress_bar.py[line:272] - INFO: epoch 001:   7954 / 8856 loss=3.239, loss_v1=0, loss_v2=0, nll_loss=0.915, ntokens=764.2, nsentences=64, sample_size=608.2, inner_loss=2.238, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.076, expert1_balance_bottom=21.273, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=90.2, ups=0.12, wpb=764.2, bsz=64, num_updates=7940, lr=1.17381e-05, gnorm=2.989, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61566
2022-05-17 15:51:36 - progress_bar.py[line:272] - INFO: epoch 001:   7964 / 8856 loss=3.207, loss_v1=0, loss_v2=0, nll_loss=0.886, ntokens=781.8, nsentences=64, sample_size=622.3, inner_loss=2.206, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.471, expert1_balance_bottom=21.54, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=94, ups=0.12, wpb=781.8, bsz=64, num_updates=7950, lr=1.17261e-05, gnorm=2.585, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61649
2022-05-17 15:53:00 - progress_bar.py[line:272] - INFO: epoch 001:   7974 / 8856 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=762.4, nsentences=64, sample_size=606.9, inner_loss=2.16, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.669, expert1_balance_bottom=21.694, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.7, ups=0.12, wpb=762.4, bsz=64, num_updates=7960, lr=1.17141e-05, gnorm=3.081, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61733
2022-05-17 15:54:24 - progress_bar.py[line:272] - INFO: epoch 001:   7984 / 8856 loss=3.221, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=771.8, nsentences=64, sample_size=614.3, inner_loss=2.219, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.916, expert1_balance_bottom=21.35, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=92.8, ups=0.12, wpb=771.8, bsz=64, num_updates=7970, lr=1.17021e-05, gnorm=2.485, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61816
2022-05-17 15:55:47 - progress_bar.py[line:272] - INFO: epoch 001:   7994 / 8856 loss=3.274, loss_v1=0, loss_v2=0, nll_loss=0.957, ntokens=770, nsentences=64, sample_size=613.2, inner_loss=2.273, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.655, expert1_balance_bottom=21.66, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.94, wps=92.7, ups=0.12, wpb=770, bsz=64, num_updates=7980, lr=1.16901e-05, gnorm=3.014, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61899
2022-05-17 15:57:11 - progress_bar.py[line:272] - INFO: epoch 001:   8004 / 8856 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=755.5, nsentences=64, sample_size=601.4, inner_loss=2.148, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.617, expert1_balance_bottom=21.529, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=89.7, ups=0.12, wpb=755.5, bsz=64, num_updates=7990, lr=1.16781e-05, gnorm=2.681, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=61983
2022-05-17 15:58:34 - progress_bar.py[line:272] - INFO: epoch 001:   8014 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.846, ntokens=778.6, nsentences=64, sample_size=619.7, inner_loss=2.171, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.97, expert1_balance_bottom=21.421, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=93.2, ups=0.12, wpb=778.6, bsz=64, num_updates=8000, lr=1.16661e-05, gnorm=2.499, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62067
2022-05-17 15:58:34 - train.py[line:456] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-17 15:58:36 - train.py[line:466] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-17 15:58:36 - train.py[line:494] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-17 16:05:18 - train.py[line:503] - INFO: valid_step finished
2022-05-17 16:05:18 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 11.643 | loss_v1 0 | loss_v2 0 | nll_loss 9.913 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | inner_loss 10.642 | moe_gate_loss 1 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.38 | expert1_balance_top 27.422 | expert1_balance_bottom 22.64 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 963.97 | cider 1.291 | wps 750.5 | wpb 481.7 | bsz 8 | num_updates 8000 | best_cider 1.291
2022-05-17 16:05:18 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 8000 updates
2022-05-17 16:05:18 - trainer.py[line:450] - INFO: Saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_8000.pt
2022-05-17 16:05:24 - trainer.py[line:460] - INFO: Finished saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_8000.pt
2022-05-17 16:05:34 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_1_8000.pt (epoch 1 @ 8000 updates, score 1.291) (writing took 16.554458126425743 seconds)
2022-05-17 16:06:44 - progress_bar.py[line:272] - INFO: epoch 001:   8024 / 8856 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=766.8, nsentences=64, sample_size=610.4, inner_loss=2.168, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.042, expert1_balance_bottom=21.56, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=15.7, ups=0.02, wpb=766.8, bsz=64, num_updates=8010, lr=1.16541e-05, gnorm=2.567, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62556
2022-05-17 16:08:04 - progress_bar.py[line:272] - INFO: epoch 001:   8034 / 8856 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=768.9, nsentences=64, sample_size=612, inner_loss=2.208, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.634, expert1_balance_bottom=21.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=95.6, ups=0.12, wpb=768.9, bsz=64, num_updates=8020, lr=1.1642e-05, gnorm=2.978, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62636
2022-05-17 16:09:26 - progress_bar.py[line:272] - INFO: epoch 001:   8044 / 8856 loss=3.186, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=762.2, nsentences=64, sample_size=606.2, inner_loss=2.185, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.625, expert1_balance_bottom=21.323, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=93.1, ups=0.12, wpb=762.2, bsz=64, num_updates=8030, lr=1.163e-05, gnorm=2.577, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62718
2022-05-17 16:10:47 - progress_bar.py[line:272] - INFO: epoch 001:   8054 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.881, ntokens=777.6, nsentences=64, sample_size=618.8, inner_loss=2.202, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.947, expert1_balance_bottom=21.504, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=95.6, ups=0.12, wpb=777.6, bsz=64, num_updates=8040, lr=1.1618e-05, gnorm=2.656, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62800
2022-05-17 16:12:09 - progress_bar.py[line:272] - INFO: epoch 001:   8064 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=760.7, nsentences=64, sample_size=605.6, inner_loss=2.197, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.711, expert1_balance_bottom=21.609, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=93.2, ups=0.12, wpb=760.7, bsz=64, num_updates=8050, lr=1.1606e-05, gnorm=2.996, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62881
2022-05-17 16:13:30 - progress_bar.py[line:272] - INFO: epoch 001:   8074 / 8856 loss=3.231, loss_v1=0, loss_v2=0, nll_loss=0.908, ntokens=762.2, nsentences=64, sample_size=606.6, inner_loss=2.23, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.835, expert1_balance_bottom=21.4, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=93.5, ups=0.12, wpb=762.2, bsz=64, num_updates=8060, lr=1.1594e-05, gnorm=2.796, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=62963
2022-05-17 16:14:53 - progress_bar.py[line:272] - INFO: epoch 001:   8084 / 8856 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.874, ntokens=763.3, nsentences=64, sample_size=607.3, inner_loss=2.2, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.492, expert1_balance_bottom=21.607, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=92.3, ups=0.12, wpb=763.3, bsz=64, num_updates=8070, lr=1.1582e-05, gnorm=2.752, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63046
2022-05-17 16:15:37 - progress_bar.py[line:272] - INFO: epoch 001:   8094 / 8856 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.872, ntokens=768.7, nsentences=64, sample_size=611.7, inner_loss=2.193, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.019, expert1_balance_bottom=21.381, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=173.4, ups=0.23, wpb=768.7, bsz=64, num_updates=8080, lr=1.157e-05, gnorm=2.42, loss_scale=64, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63090
2022-05-17 16:16:40 - progress_bar.py[line:272] - INFO: epoch 001:   8104 / 8856 loss=3.238, loss_v1=0, loss_v2=0, nll_loss=0.919, ntokens=777, nsentences=64, sample_size=617.9, inner_loss=2.237, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.712, expert1_balance_bottom=21.671, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.89, wps=125, ups=0.16, wpb=777, bsz=64, num_updates=8090, lr=1.1558e-05, gnorm=2.977, loss_scale=64, train_wall=33, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63152
2022-05-17 16:18:05 - progress_bar.py[line:272] - INFO: epoch 001:   8114 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.862, ntokens=769.9, nsentences=64, sample_size=612.3, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.503, expert1_balance_bottom=21.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.3, ups=0.12, wpb=769.9, bsz=64, num_updates=8100, lr=1.15459e-05, gnorm=2.581, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63237
2022-05-17 16:19:29 - progress_bar.py[line:272] - INFO: epoch 001:   8124 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.864, ntokens=769.3, nsentences=64, sample_size=612.3, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.657, expert1_balance_bottom=21.866, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.3, ups=0.12, wpb=769.3, bsz=64, num_updates=8110, lr=1.15339e-05, gnorm=2.452, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63322
2022-05-17 16:20:53 - progress_bar.py[line:272] - INFO: epoch 001:   8134 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.848, ntokens=774.6, nsentences=64, sample_size=616.4, inner_loss=2.172, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.641, expert1_balance_bottom=21.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=92.4, ups=0.12, wpb=774.6, bsz=64, num_updates=8120, lr=1.15219e-05, gnorm=2.525, loss_scale=64, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63405
2022-05-17 16:22:18 - progress_bar.py[line:272] - INFO: epoch 001:   8144 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.859, ntokens=762, nsentences=64, sample_size=606.5, inner_loss=2.182, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.774, expert1_balance_bottom=21.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.9, ups=0.12, wpb=762, bsz=64, num_updates=8130, lr=1.15099e-05, gnorm=3.429, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63490
2022-05-17 16:23:42 - progress_bar.py[line:272] - INFO: epoch 001:   8154 / 8856 loss=3.142, loss_v1=0, loss_v2=0, nll_loss=0.813, ntokens=758, nsentences=64, sample_size=603.6, inner_loss=2.141, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.46, expert1_balance_bottom=21.827, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=89.7, ups=0.12, wpb=758, bsz=64, num_updates=8140, lr=1.14979e-05, gnorm=2.407, loss_scale=64, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63575
2022-05-17 16:24:50 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2022-05-17 16:25:14 - progress_bar.py[line:272] - INFO: epoch 001:   8165 / 8856 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=766.8, nsentences=64, sample_size=610.2, inner_loss=2.171, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.486, expert1_balance_bottom=21.772, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=83.1, ups=0.11, wpb=766.8, bsz=64, num_updates=8150, lr=1.14859e-05, gnorm=2.509, loss_scale=32, train_wall=38, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63667
2022-05-17 16:26:39 - progress_bar.py[line:272] - INFO: epoch 001:   8175 / 8856 loss=3.18, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=761.4, nsentences=64, sample_size=605.8, inner_loss=2.179, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.588, expert1_balance_bottom=21.716, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=90.4, ups=0.12, wpb=761.4, bsz=64, num_updates=8160, lr=1.14739e-05, gnorm=2.675, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63751
2022-05-17 16:28:03 - progress_bar.py[line:272] - INFO: epoch 001:   8185 / 8856 loss=3.228, loss_v1=0, loss_v2=0, nll_loss=0.909, ntokens=757.2, nsentences=64, sample_size=602.4, inner_loss=2.227, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.586, expert1_balance_bottom=21.594, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=89.5, ups=0.12, wpb=757.2, bsz=64, num_updates=8170, lr=1.14619e-05, gnorm=2.873, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63836
2022-05-17 16:29:29 - progress_bar.py[line:272] - INFO: epoch 001:   8195 / 8856 loss=3.189, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=766.1, nsentences=64, sample_size=609.9, inner_loss=2.188, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.877, expert1_balance_bottom=21.426, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=89.6, ups=0.12, wpb=766.1, bsz=64, num_updates=8180, lr=1.14498e-05, gnorm=2.776, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=63921
2022-05-17 16:30:54 - progress_bar.py[line:272] - INFO: epoch 001:   8205 / 8856 loss=3.243, loss_v1=0, loss_v2=0, nll_loss=0.923, ntokens=776.8, nsentences=64, sample_size=618.6, inner_loss=2.242, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.532, expert1_balance_bottom=21.484, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=91.3, ups=0.12, wpb=776.8, bsz=64, num_updates=8190, lr=1.14378e-05, gnorm=2.446, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64006
2022-05-17 16:32:18 - progress_bar.py[line:272] - INFO: epoch 001:   8215 / 8856 loss=3.184, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=767, nsentences=64, sample_size=610.5, inner_loss=2.183, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.627, expert1_balance_bottom=21.463, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=91.1, ups=0.12, wpb=767, bsz=64, num_updates=8200, lr=1.14258e-05, gnorm=2.377, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64090
2022-05-17 16:33:39 - progress_bar.py[line:272] - INFO: epoch 001:   8225 / 8856 loss=3.163, loss_v1=0, loss_v2=0, nll_loss=0.836, ntokens=760.7, nsentences=64, sample_size=605.4, inner_loss=2.162, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.921, expert1_balance_bottom=21.494, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=94.2, ups=0.12, wpb=760.7, bsz=64, num_updates=8210, lr=1.14138e-05, gnorm=2.533, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64171
2022-05-17 16:35:03 - progress_bar.py[line:272] - INFO: epoch 001:   8235 / 8856 loss=3.215, loss_v1=0, loss_v2=0, nll_loss=0.894, ntokens=778.5, nsentences=64, sample_size=619.4, inner_loss=2.214, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.177, expert1_balance_bottom=21.973, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=91.9, ups=0.12, wpb=778.5, bsz=64, num_updates=8220, lr=1.14018e-05, gnorm=2.356, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64256
2022-05-17 16:36:28 - progress_bar.py[line:272] - INFO: epoch 001:   8245 / 8856 loss=3.169, loss_v1=0, loss_v2=0, nll_loss=0.842, ntokens=764.1, nsentences=64, sample_size=608, inner_loss=2.168, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.53, expert1_balance_bottom=21.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=89.9, ups=0.12, wpb=764.1, bsz=64, num_updates=8230, lr=1.13898e-05, gnorm=2.669, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64341
2022-05-17 16:37:54 - progress_bar.py[line:272] - INFO: epoch 001:   8255 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=761.8, nsentences=64, sample_size=606, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.706, expert1_balance_bottom=21.43, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=89.4, ups=0.12, wpb=761.8, bsz=64, num_updates=8240, lr=1.13778e-05, gnorm=2.425, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64426
2022-05-17 16:39:18 - progress_bar.py[line:272] - INFO: epoch 001:   8265 / 8856 loss=3.227, loss_v1=0, loss_v2=0, nll_loss=0.91, ntokens=759.5, nsentences=64, sample_size=604.2, inner_loss=2.226, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.653, expert1_balance_bottom=21.428, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.88, wps=89.9, ups=0.12, wpb=759.5, bsz=64, num_updates=8250, lr=1.13658e-05, gnorm=2.619, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64511
2022-05-17 16:40:41 - progress_bar.py[line:272] - INFO: epoch 001:   8275 / 8856 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=765.4, nsentences=64, sample_size=609.1, inner_loss=2.166, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.724, expert1_balance_bottom=21.413, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.9, ups=0.12, wpb=765.4, bsz=64, num_updates=8260, lr=1.13538e-05, gnorm=2.586, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64594
2022-05-17 16:42:04 - progress_bar.py[line:272] - INFO: epoch 001:   8285 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=761.2, nsentences=64, sample_size=606.4, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.193, expert1_balance_bottom=21.855, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=92.3, ups=0.12, wpb=761.2, bsz=64, num_updates=8270, lr=1.13417e-05, gnorm=2.375, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64676
2022-05-17 16:43:26 - progress_bar.py[line:272] - INFO: epoch 001:   8295 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=747.8, nsentences=64, sample_size=595.3, inner_loss=2.173, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.744, expert1_balance_bottom=21.552, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.3, ups=0.12, wpb=747.8, bsz=64, num_updates=8280, lr=1.13297e-05, gnorm=2.649, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64758
2022-05-17 16:44:49 - progress_bar.py[line:272] - INFO: epoch 001:   8305 / 8856 loss=3.213, loss_v1=0, loss_v2=0, nll_loss=0.891, ntokens=772.4, nsentences=64, sample_size=614.8, inner_loss=2.212, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.541, expert1_balance_bottom=21.692, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=93.1, ups=0.12, wpb=772.4, bsz=64, num_updates=8290, lr=1.13177e-05, gnorm=2.444, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64841
2022-05-17 16:45:30 - progress_bar.py[line:272] - INFO: epoch 001:   8315 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=770.4, nsentences=64, sample_size=613.1, inner_loss=2.187, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.841, expert1_balance_bottom=21.265, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=187.3, ups=0.24, wpb=770.4, bsz=64, num_updates=8300, lr=1.13057e-05, gnorm=2.312, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64882
2022-05-17 16:46:45 - progress_bar.py[line:272] - INFO: epoch 001:   8325 / 8856 loss=3.149, loss_v1=0, loss_v2=0, nll_loss=0.82, ntokens=760.9, nsentences=64, sample_size=605.6, inner_loss=2.148, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.467, expert1_balance_bottom=21.5, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=101.9, ups=0.13, wpb=760.9, bsz=64, num_updates=8310, lr=1.12937e-05, gnorm=2.412, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=64957
2022-05-17 16:48:09 - progress_bar.py[line:272] - INFO: epoch 001:   8335 / 8856 loss=3.183, loss_v1=0, loss_v2=0, nll_loss=0.856, ntokens=762.8, nsentences=64, sample_size=607.1, inner_loss=2.182, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.751, expert1_balance_bottom=21.734, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.9, ups=0.12, wpb=762.8, bsz=64, num_updates=8320, lr=1.12817e-05, gnorm=2.537, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65042
2022-05-17 16:49:35 - progress_bar.py[line:272] - INFO: epoch 001:   8345 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=777.4, nsentences=64, sample_size=619.1, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.803, expert1_balance_bottom=21.309, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.5, ups=0.12, wpb=777.4, bsz=64, num_updates=8330, lr=1.12697e-05, gnorm=2.888, loss_scale=32, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=65128
2022-05-17 16:51:03 - progress_bar.py[line:272] - INFO: epoch 001:   8355 / 8856 loss=3.109, loss_v1=0, loss_v2=0, nll_loss=0.779, ntokens=768.6, nsentences=64, sample_size=611.8, inner_loss=2.109, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.315, expert1_balance_bottom=21.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.72, wps=87.9, ups=0.11, wpb=768.6, bsz=64, num_updates=8340, lr=1.12577e-05, gnorm=2.466, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65215
2022-05-17 16:52:27 - progress_bar.py[line:272] - INFO: epoch 001:   8365 / 8856 loss=3.168, loss_v1=0, loss_v2=0, nll_loss=0.843, ntokens=767.3, nsentences=64, sample_size=611, inner_loss=2.167, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.996, expert1_balance_bottom=21.294, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91, ups=0.12, wpb=767.3, bsz=64, num_updates=8350, lr=1.12456e-05, gnorm=2.786, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65300
2022-05-17 16:53:52 - progress_bar.py[line:272] - INFO: epoch 001:   8375 / 8856 loss=3.147, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=765.2, nsentences=64, sample_size=609.2, inner_loss=2.147, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.314, expert1_balance_bottom=21.785, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=89.9, ups=0.12, wpb=765.2, bsz=64, num_updates=8360, lr=1.12336e-05, gnorm=2.812, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65385
2022-05-17 16:55:18 - progress_bar.py[line:272] - INFO: epoch 001:   8385 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.861, ntokens=773.6, nsentences=64, sample_size=614.9, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.217, expert1_balance_bottom=21.988, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=90.6, ups=0.12, wpb=773.6, bsz=64, num_updates=8370, lr=1.12216e-05, gnorm=2.455, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65470
2022-05-17 16:56:42 - progress_bar.py[line:272] - INFO: epoch 001:   8395 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=767.6, nsentences=64, sample_size=610.8, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.546, expert1_balance_bottom=21.458, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.5, ups=0.12, wpb=767.6, bsz=64, num_updates=8380, lr=1.12096e-05, gnorm=2.58, loss_scale=32, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=65555
2022-05-17 16:58:08 - progress_bar.py[line:272] - INFO: epoch 001:   8405 / 8856 loss=3.194, loss_v1=0, loss_v2=0, nll_loss=0.867, ntokens=758.5, nsentences=64, sample_size=603.8, inner_loss=2.193, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.68, expert1_balance_bottom=21.587, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=88.2, ups=0.12, wpb=758.5, bsz=64, num_updates=8390, lr=1.11976e-05, gnorm=2.533, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65641
2022-05-17 16:59:32 - progress_bar.py[line:272] - INFO: epoch 001:   8415 / 8856 loss=3.182, loss_v1=0, loss_v2=0, nll_loss=0.855, ntokens=769.7, nsentences=64, sample_size=612.6, inner_loss=2.181, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.621, expert1_balance_bottom=21.68, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=91.9, ups=0.12, wpb=769.7, bsz=64, num_updates=8400, lr=1.11856e-05, gnorm=2.418, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65725
2022-05-17 17:00:57 - progress_bar.py[line:272] - INFO: epoch 001:   8425 / 8856 loss=3.172, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=775.4, nsentences=64, sample_size=617, inner_loss=2.171, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.854, expert1_balance_bottom=21.314, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.1, ups=0.12, wpb=775.4, bsz=64, num_updates=8410, lr=1.11736e-05, gnorm=2.687, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65810
2022-05-17 17:02:22 - progress_bar.py[line:272] - INFO: epoch 001:   8435 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=762.6, nsentences=64, sample_size=606.9, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.737, expert1_balance_bottom=21.177, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=89.7, ups=0.12, wpb=762.6, bsz=64, num_updates=8420, lr=1.11616e-05, gnorm=2.43, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65895
2022-05-17 17:03:47 - progress_bar.py[line:272] - INFO: epoch 001:   8445 / 8856 loss=3.177, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=760.2, nsentences=64, sample_size=605.1, inner_loss=2.176, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.307, expert1_balance_bottom=21.679, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=89.5, ups=0.12, wpb=760.2, bsz=64, num_updates=8430, lr=1.11495e-05, gnorm=2.415, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=65980
2022-05-17 17:05:11 - progress_bar.py[line:272] - INFO: epoch 001:   8455 / 8856 loss=3.175, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=763.5, nsentences=64, sample_size=607.8, inner_loss=2.174, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.334, expert1_balance_bottom=21.932, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.7, ups=0.12, wpb=763.5, bsz=64, num_updates=8440, lr=1.11375e-05, gnorm=2.354, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66064
2022-05-17 17:06:35 - progress_bar.py[line:272] - INFO: epoch 001:   8465 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.841, ntokens=766.3, nsentences=64, sample_size=609.4, inner_loss=2.166, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.46, expert1_balance_bottom=21.696, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.6, ups=0.12, wpb=766.3, bsz=64, num_updates=8450, lr=1.11255e-05, gnorm=2.379, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66148
2022-05-17 17:08:00 - progress_bar.py[line:272] - INFO: epoch 001:   8475 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.837, ntokens=769.4, nsentences=64, sample_size=612.2, inner_loss=2.168, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.863, expert1_balance_bottom=21.423, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.5, ups=0.12, wpb=769.4, bsz=64, num_updates=8460, lr=1.11135e-05, gnorm=2.537, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66233
2022-05-17 17:09:26 - progress_bar.py[line:272] - INFO: epoch 001:   8485 / 8856 loss=3.195, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=778, nsentences=64, sample_size=619, inner_loss=2.194, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.636, expert1_balance_bottom=21.376, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.9, ups=0.12, wpb=778, bsz=64, num_updates=8470, lr=1.11015e-05, gnorm=2.549, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66318
2022-05-17 17:10:50 - progress_bar.py[line:272] - INFO: epoch 001:   8495 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=769.2, nsentences=64, sample_size=612.4, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.747, expert1_balance_bottom=21.489, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.7, ups=0.12, wpb=769.2, bsz=64, num_updates=8480, lr=1.10895e-05, gnorm=2.405, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66402
2022-05-17 17:12:14 - progress_bar.py[line:272] - INFO: epoch 001:   8505 / 8856 loss=3.174, loss_v1=0, loss_v2=0, nll_loss=0.849, ntokens=774.9, nsentences=64, sample_size=616.9, inner_loss=2.173, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.357, expert1_balance_bottom=21.409, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.5, ups=0.12, wpb=774.9, bsz=64, num_updates=8490, lr=1.10775e-05, gnorm=2.485, loss_scale=32, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66487
2022-05-17 17:13:40 - progress_bar.py[line:272] - INFO: epoch 001:   8515 / 8856 loss=3.178, loss_v1=0, loss_v2=0, nll_loss=0.85, ntokens=769.3, nsentences=64, sample_size=611.8, inner_loss=2.177, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.684, expert1_balance_bottom=21.543, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90, ups=0.12, wpb=769.3, bsz=64, num_updates=8500, lr=1.10655e-05, gnorm=2.486, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66572
2022-05-17 17:15:06 - progress_bar.py[line:272] - INFO: epoch 001:   8525 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.871, ntokens=775.2, nsentences=64, sample_size=616.6, inner_loss=2.196, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.6, expert1_balance_bottom=21.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.3, ups=0.12, wpb=775.2, bsz=64, num_updates=8510, lr=1.10535e-05, gnorm=2.504, loss_scale=32, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66658
2022-05-17 17:15:52 - progress_bar.py[line:272] - INFO: epoch 001:   8535 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.896, ntokens=770.1, nsentences=64, sample_size=612.9, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.731, expert1_balance_bottom=21.562, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=165.4, ups=0.21, wpb=770.1, bsz=64, num_updates=8520, lr=1.10414e-05, gnorm=2.773, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66705
2022-05-17 17:16:29 - progress_bar.py[line:272] - INFO: epoch 001:   8545 / 8856 loss=3.165, loss_v1=0, loss_v2=0, nll_loss=0.839, ntokens=773.7, nsentences=64, sample_size=615.8, inner_loss=2.164, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.594, expert1_balance_bottom=21.726, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=209.2, ups=0.27, wpb=773.7, bsz=64, num_updates=8530, lr=1.10294e-05, gnorm=3.03, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66742
2022-05-17 17:17:07 - progress_bar.py[line:272] - INFO: epoch 001:   8555 / 8856 loss=3.203, loss_v1=0, loss_v2=0, nll_loss=0.88, ntokens=770, nsentences=64, sample_size=613.1, inner_loss=2.203, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.584, expert1_balance_bottom=21.574, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=206.7, ups=0.27, wpb=770, bsz=64, num_updates=8540, lr=1.10174e-05, gnorm=2.962, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66779
2022-05-17 17:17:44 - progress_bar.py[line:272] - INFO: epoch 001:   8565 / 8856 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.819, ntokens=774.5, nsentences=64, sample_size=616.5, inner_loss=2.149, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.412, expert1_balance_bottom=21.589, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=207.2, ups=0.27, wpb=774.5, bsz=64, num_updates=8550, lr=1.10054e-05, gnorm=2.213, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66816
2022-05-17 17:18:20 - progress_bar.py[line:272] - INFO: epoch 001:   8575 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.877, ntokens=765.8, nsentences=64, sample_size=609.6, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.497, expert1_balance_bottom=21.887, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=213.1, ups=0.28, wpb=765.8, bsz=64, num_updates=8560, lr=1.09934e-05, gnorm=2.485, loss_scale=32, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66852
2022-05-17 17:18:57 - progress_bar.py[line:272] - INFO: epoch 001:   8585 / 8856 loss=3.209, loss_v1=0, loss_v2=0, nll_loss=0.887, ntokens=762, nsentences=64, sample_size=606.4, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.664, expert1_balance_bottom=21.682, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=204.7, ups=0.27, wpb=762, bsz=64, num_updates=8570, lr=1.09814e-05, gnorm=2.591, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66890
2022-05-17 17:19:33 - progress_bar.py[line:272] - INFO: epoch 001:   8595 / 8856 loss=3.153, loss_v1=0, loss_v2=0, nll_loss=0.825, ntokens=762, nsentences=64, sample_size=606.2, inner_loss=2.152, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.277, expert1_balance_bottom=21.666, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=213.8, ups=0.28, wpb=762, bsz=64, num_updates=8580, lr=1.09694e-05, gnorm=2.768, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66925
2022-05-17 17:20:09 - progress_bar.py[line:272] - INFO: epoch 001:   8605 / 8856 loss=3.181, loss_v1=0, loss_v2=0, nll_loss=0.857, ntokens=774.2, nsentences=64, sample_size=616.4, inner_loss=2.18, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.206, expert1_balance_bottom=21.838, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.81, wps=214.9, ups=0.28, wpb=774.2, bsz=64, num_updates=8590, lr=1.09574e-05, gnorm=2.702, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66961
2022-05-17 17:20:46 - progress_bar.py[line:272] - INFO: epoch 001:   8615 / 8856 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=768.8, nsentences=64, sample_size=611.4, inner_loss=2.2, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.462, expert1_balance_bottom=21.731, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=206.3, ups=0.27, wpb=768.8, bsz=64, num_updates=8600, lr=1.09453e-05, gnorm=2.496, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=66999
2022-05-17 17:21:23 - progress_bar.py[line:272] - INFO: epoch 001:   8625 / 8856 loss=3.214, loss_v1=0, loss_v2=0, nll_loss=0.89, ntokens=762.6, nsentences=64, sample_size=607.2, inner_loss=2.213, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.277, expert1_balance_bottom=21.651, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=209, ups=0.27, wpb=762.6, bsz=64, num_updates=8610, lr=1.09333e-05, gnorm=2.9, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67035
2022-05-17 17:21:59 - progress_bar.py[line:272] - INFO: epoch 001:   8635 / 8856 loss=3.187, loss_v1=0, loss_v2=0, nll_loss=0.863, ntokens=751.6, nsentences=64, sample_size=598.3, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.487, expert1_balance_bottom=21.759, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=204, ups=0.27, wpb=751.6, bsz=64, num_updates=8620, lr=1.09213e-05, gnorm=2.499, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67072
2022-05-17 17:22:36 - progress_bar.py[line:272] - INFO: epoch 001:   8645 / 8856 loss=3.148, loss_v1=0, loss_v2=0, nll_loss=0.822, ntokens=765.7, nsentences=64, sample_size=609.2, inner_loss=2.147, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.983, expert1_balance_bottom=21.424, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=211.1, ups=0.28, wpb=765.7, bsz=64, num_updates=8630, lr=1.09093e-05, gnorm=2.423, loss_scale=32, train_wall=31, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67108
2022-05-17 17:23:27 - trainer.py[line:945] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2022-05-17 17:23:53 - progress_bar.py[line:272] - INFO: epoch 001:   8656 / 8856 loss=3.161, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=770.3, nsentences=64, sample_size=613.1, inner_loss=2.16, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.826, expert1_balance_bottom=21.713, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=99.9, ups=0.13, wpb=770.3, bsz=64, num_updates=8640, lr=1.08973e-05, gnorm=2.418, loss_scale=16, train_wall=37, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67185
2022-05-17 17:25:18 - progress_bar.py[line:272] - INFO: epoch 001:   8666 / 8856 loss=3.192, loss_v1=0, loss_v2=0, nll_loss=0.87, ntokens=769.9, nsentences=64, sample_size=612.5, inner_loss=2.191, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.057, expert1_balance_bottom=21.359, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.2, ups=0.12, wpb=769.9, bsz=64, num_updates=8650, lr=1.08853e-05, gnorm=2.425, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67271
2022-05-17 17:26:43 - progress_bar.py[line:272] - INFO: epoch 001:   8676 / 8856 loss=3.138, loss_v1=0, loss_v2=0, nll_loss=0.807, ntokens=760.1, nsentences=64, sample_size=604.7, inner_loss=2.137, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.76, expert1_balance_bottom=21.525, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.75, wps=89.8, ups=0.12, wpb=760.1, bsz=64, num_updates=8660, lr=1.08733e-05, gnorm=2.681, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=67355
2022-05-17 17:28:06 - progress_bar.py[line:272] - INFO: epoch 001:   8686 / 8856 loss=3.117, loss_v1=0, loss_v2=0, nll_loss=0.787, ntokens=772.7, nsentences=64, sample_size=615.1, inner_loss=2.116, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.582, expert1_balance_bottom=21.839, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.73, wps=92.9, ups=0.12, wpb=772.7, bsz=64, num_updates=8670, lr=1.08613e-05, gnorm=2.278, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67438
2022-05-17 17:29:31 - progress_bar.py[line:272] - INFO: epoch 001:   8696 / 8856 loss=3.222, loss_v1=0, loss_v2=0, nll_loss=0.902, ntokens=759.5, nsentences=64, sample_size=604.3, inner_loss=2.221, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.563, expert1_balance_bottom=21.573, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.87, wps=89.9, ups=0.12, wpb=759.5, bsz=64, num_updates=8680, lr=1.08492e-05, gnorm=2.463, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67523
2022-05-17 17:30:55 - progress_bar.py[line:272] - INFO: epoch 001:   8706 / 8856 loss=3.208, loss_v1=0, loss_v2=0, nll_loss=0.885, ntokens=759.2, nsentences=64, sample_size=604.5, inner_loss=2.207, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.646, expert1_balance_bottom=21.554, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=89.6, ups=0.12, wpb=759.2, bsz=64, num_updates=8690, lr=1.08372e-05, gnorm=2.766, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67608
2022-05-17 17:32:20 - progress_bar.py[line:272] - INFO: epoch 001:   8716 / 8856 loss=3.199, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=756.1, nsentences=64, sample_size=601.5, inner_loss=2.198, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.715, expert1_balance_bottom=21.516, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=88.8, ups=0.12, wpb=756.1, bsz=64, num_updates=8700, lr=1.08252e-05, gnorm=2.487, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67693
2022-05-17 17:33:45 - progress_bar.py[line:272] - INFO: epoch 001:   8726 / 8856 loss=3.17, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=768.5, nsentences=64, sample_size=611.2, inner_loss=2.169, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.452, expert1_balance_bottom=21.7, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.4, ups=0.12, wpb=768.5, bsz=64, num_updates=8710, lr=1.08132e-05, gnorm=2.443, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67778
2022-05-17 17:35:10 - progress_bar.py[line:272] - INFO: epoch 001:   8736 / 8856 loss=3.157, loss_v1=0, loss_v2=0, nll_loss=0.833, ntokens=766.3, nsentences=64, sample_size=610.1, inner_loss=2.156, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.52, expert1_balance_bottom=21.627, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90, ups=0.12, wpb=766.3, bsz=64, num_updates=8720, lr=1.08012e-05, gnorm=2.432, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67863
2022-05-17 17:36:34 - progress_bar.py[line:272] - INFO: epoch 001:   8746 / 8856 loss=3.167, loss_v1=0, loss_v2=0, nll_loss=0.84, ntokens=767.9, nsentences=64, sample_size=611.5, inner_loss=2.166, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.879, expert1_balance_bottom=21.687, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=91.7, ups=0.12, wpb=767.9, bsz=64, num_updates=8730, lr=1.07892e-05, gnorm=2.436, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=67947
2022-05-17 17:37:57 - progress_bar.py[line:272] - INFO: epoch 001:   8756 / 8856 loss=3.152, loss_v1=0, loss_v2=0, nll_loss=0.827, ntokens=773.5, nsentences=64, sample_size=615.3, inner_loss=2.151, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.212, expert1_balance_bottom=21.793, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=92.9, ups=0.12, wpb=773.5, bsz=64, num_updates=8740, lr=1.07772e-05, gnorm=2.545, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=68030
2022-05-17 17:39:22 - progress_bar.py[line:272] - INFO: epoch 001:   8766 / 8856 loss=3.176, loss_v1=0, loss_v2=0, nll_loss=0.852, ntokens=765.6, nsentences=64, sample_size=609.3, inner_loss=2.175, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.462, expert1_balance_bottom=21.857, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.9, ups=0.12, wpb=765.6, bsz=64, num_updates=8750, lr=1.07652e-05, gnorm=2.452, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68114
2022-05-17 17:40:46 - progress_bar.py[line:272] - INFO: epoch 001:   8776 / 8856 loss=3.197, loss_v1=0, loss_v2=0, nll_loss=0.873, ntokens=758.8, nsentences=64, sample_size=603.3, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.587, expert1_balance_bottom=21.869, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=89.5, ups=0.12, wpb=758.8, bsz=64, num_updates=8760, lr=1.07532e-05, gnorm=2.404, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68199
2022-05-17 17:42:12 - progress_bar.py[line:272] - INFO: epoch 001:   8786 / 8856 loss=3.166, loss_v1=0, loss_v2=0, nll_loss=0.838, ntokens=777.4, nsentences=64, sample_size=618.9, inner_loss=2.165, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.731, expert1_balance_bottom=21.668, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.79, wps=90.9, ups=0.12, wpb=777.4, bsz=64, num_updates=8770, lr=1.07411e-05, gnorm=2.435, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68284
2022-05-17 17:43:37 - progress_bar.py[line:272] - INFO: epoch 001:   8796 / 8856 loss=3.196, loss_v1=0, loss_v2=0, nll_loss=0.878, ntokens=780.2, nsentences=64, sample_size=620.6, inner_loss=2.195, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.198, expert1_balance_bottom=21.778, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.84, wps=92.1, ups=0.12, wpb=780.2, bsz=64, num_updates=8780, lr=1.07291e-05, gnorm=2.325, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=68369
2022-05-17 17:45:01 - progress_bar.py[line:272] - INFO: epoch 001:   8806 / 8856 loss=3.136, loss_v1=0, loss_v2=0, nll_loss=0.812, ntokens=774.5, nsentences=64, sample_size=616.6, inner_loss=2.136, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.498, expert1_balance_bottom=21.94, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=91.9, ups=0.12, wpb=774.5, bsz=64, num_updates=8790, lr=1.07171e-05, gnorm=2.909, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68453
2022-05-17 17:46:24 - progress_bar.py[line:272] - INFO: epoch 001:   8816 / 8856 loss=3.179, loss_v1=0, loss_v2=0, nll_loss=0.851, ntokens=760.6, nsentences=64, sample_size=605, inner_loss=2.178, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.725, expert1_balance_bottom=21.571, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=91.4, ups=0.12, wpb=760.6, bsz=64, num_updates=8800, lr=1.07051e-05, gnorm=2.692, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68537
2022-05-17 17:47:49 - progress_bar.py[line:272] - INFO: epoch 001:   8826 / 8856 loss=3.162, loss_v1=0, loss_v2=0, nll_loss=0.835, ntokens=769.6, nsentences=64, sample_size=612.8, inner_loss=2.161, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.603, expert1_balance_bottom=21.45, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.78, wps=90.2, ups=0.12, wpb=769.6, bsz=64, num_updates=8810, lr=1.06931e-05, gnorm=2.415, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68622
2022-05-17 17:49:14 - progress_bar.py[line:272] - INFO: epoch 001:   8836 / 8856 loss=3.205, loss_v1=0, loss_v2=0, nll_loss=0.884, ntokens=758.2, nsentences=64, sample_size=603.5, inner_loss=2.204, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=29.061, expert1_balance_bottom=21.53, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.85, wps=90.1, ups=0.12, wpb=758.2, bsz=64, num_updates=8820, lr=1.06811e-05, gnorm=2.874, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68706
2022-05-17 17:50:37 - progress_bar.py[line:272] - INFO: epoch 001:   8846 / 8856 loss=3.139, loss_v1=0, loss_v2=0, nll_loss=0.815, ntokens=751.2, nsentences=64, sample_size=597.6, inner_loss=2.138, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.167, expert1_balance_bottom=21.979, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.76, wps=90.2, ups=0.12, wpb=751.2, bsz=64, num_updates=8830, lr=1.06691e-05, gnorm=2.478, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68789
2022-05-17 17:51:56 - progress_bar.py[line:272] - INFO: epoch 001:   8856 / 8856 loss=3.173, loss_v1=0, loss_v2=0, nll_loss=0.847, ntokens=714.8, nsentences=60.8, sample_size=568.7, inner_loss=2.172, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.454, expert1_balance_bottom=21.731, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.8, wps=90.7, ups=0.13, wpb=714.8, bsz=60.8, num_updates=8840, lr=1.06571e-05, gnorm=3.135, loss_scale=16, train_wall=32, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=68868
2022-05-17 17:51:56 - train.py[line:456] - INFO: begin validation on "valid" subset on rank 0
slice_id 0 seek offset 0
slice_id 0 seek offset 0
2022-05-17 17:51:57 - train.py[line:466] - INFO: got valid iterator on "valid" subset on rank 0
2022-05-17 17:51:57 - train.py[line:494] - INFO: Begin looping over validation "valid" subset with length "625"
2022-05-17 18:03:36 - train.py[line:503] - INFO: valid_step finished
2022-05-17 18:03:36 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 11.642 | loss_v1 0 | loss_v2 0 | nll_loss 9.914 | ntokens 481.696 | nsentences 8 | sample_size 481.696 | inner_loss 10.642 | moe_gate_loss 1 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.38 | expert1_balance_top 27.329 | expert1_balance_bottom 22.705 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 964.89 | cider 1.289 | wps 431.3 | wpb 481.7 | bsz 8 | num_updates 8840 | best_cider 1.291
2022-05-17 18:03:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 8840 updates
2022-05-17 18:03:36 - trainer.py[line:450] - INFO: Saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_last.pt
2022-05-17 18:03:44 - trainer.py[line:460] - INFO: Finished saving checkpoint to ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_last.pt
2022-05-17 18:03:44 - checkpoint_utils.py[line:133] - INFO: Saved checkpoint ./moe_en_final_layer_stage1_checkpoints/2_0.06_2500_1_2e-5/checkpoint_last.pt (epoch 1 @ 8840 updates, score 1.289) (writing took 8.795113456435502 seconds)
2022-05-17 18:03:44 - train.py[line:330] - INFO: end of epoch 1 (average epoch stats below)
2022-05-17 18:03:44 - progress_bar.py[line:282] - INFO: epoch 001 | loss 3.544 | loss_v1 0 | loss_v2 0 | nll_loss 1.167 | ntokens 765.308 | nsentences 63.996 | sample_size 653.287 | inner_loss 2.541 | moe_gate_loss 1.003 | overflow_expert1 0 | overflow_expert2 0 | entropy_gating 1.38 | expert1_balance_top 29.781 | expert1_balance_bottom 20.678 | unused_expert1_count 0 | expert2_balance_top 0 | expert2_balance_bottom 0 | unused_expert2_count 0 | all_to_all_cpu_time_ms 0 | all_to_all_cuda_time_ms 0 | ppl 2.24 | wps 97.3 | ups 0.13 | wpb 765.3 | bsz 64 | num_updates 8840 | lr 1.06571e-05 | gnorm 2.774 | loss_scale 16 | train_wall 30088 | cuda_gb_allocated 11.1 | cuda_gb_reserved 12 | cuda_gb_free 12.6 | wall 69577
2022-05-17 18:03:44 - trainer.py[line:658] - INFO: loading train data for epoch 2
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../dataset/caption_data/caption_stage1_train.tsv slice_id 0 row count 566747 total row count 566747
slice_id 0 seek offset 0
2022-05-17 18:04:16 - trainer.py[line:722] - INFO: begin training epoch 2
2022-05-17 18:04:16 - train.py[line:303] - INFO: Start iterating over samples
2022-05-17 18:05:44 - progress_bar.py[line:272] - INFO: epoch 002:     10 / 8856 loss=3.188, loss_v1=0, loss_v2=0, nll_loss=0.86, ntokens=764.4, nsentences=64, sample_size=608.8, inner_loss=2.186, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.723, expert1_balance_bottom=21.596, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.82, wps=9.2, ups=0.01, wpb=764.4, bsz=64, num_updates=8850, lr=1.0645e-05, gnorm=2.556, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=69697
2022-05-17 18:07:09 - progress_bar.py[line:272] - INFO: epoch 002:     20 / 8856 loss=3.211, loss_v1=0, loss_v2=0, nll_loss=0.893, ntokens=754.4, nsentences=64, sample_size=600.4, inner_loss=2.21, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.58, expert1_balance_bottom=21.405, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.86, wps=88.6, ups=0.12, wpb=754.4, bsz=64, num_updates=8860, lr=1.0633e-05, gnorm=2.672, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=69782
2022-05-17 18:08:33 - progress_bar.py[line:272] - INFO: epoch 002:     30 / 8856 loss=3.15, loss_v1=0, loss_v2=0, nll_loss=0.826, ntokens=759.9, nsentences=64, sample_size=604.8, inner_loss=2.149, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.52, expert1_balance_bottom=21.526, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.77, wps=90.7, ups=0.12, wpb=759.9, bsz=64, num_updates=8870, lr=1.0621e-05, gnorm=2.565, loss_scale=16, train_wall=34, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=69866
2022-05-17 18:09:59 - progress_bar.py[line:272] - INFO: epoch 002:     40 / 8856 loss=3.242, loss_v1=0, loss_v2=0, nll_loss=0.927, ntokens=768.3, nsentences=64, sample_size=611.7, inner_loss=2.242, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.928, expert1_balance_bottom=21.626, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.9, wps=89.4, ups=0.12, wpb=768.3, bsz=64, num_updates=8880, lr=1.0609e-05, gnorm=2.794, loss_scale=16, train_wall=35, cuda_gb_allocated=11.1, cuda_gb_reserved=12, cuda_gb_free=12.6, wall=69952
2022-05-17 18:11:27 - progress_bar.py[line:272] - INFO: epoch 002:     50 / 8856 loss=3.133, loss_v1=0, loss_v2=0, nll_loss=0.801, ntokens=755, nsentences=64, sample_size=600.4, inner_loss=2.131, moe_gate_loss=1.002, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.562, expert1_balance_bottom=21.48, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.74, wps=86.3, ups=0.11, wpb=755, bsz=64, num_updates=8890, lr=1.0597e-05, gnorm=2.621, loss_scale=16, train_wall=34, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=70039
2022-05-17 18:12:53 - progress_bar.py[line:272] - INFO: epoch 002:     60 / 8856 loss=3.201, loss_v1=0, loss_v2=0, nll_loss=0.876, ntokens=776.6, nsentences=64, sample_size=618.3, inner_loss=2.2, moe_gate_loss=1.001, overflow_expert1=0, overflow_expert2=0, entropy_gating=1.38, expert1_balance_top=28.805, expert1_balance_bottom=21.499, unused_expert1_count=0, expert2_balance_top=0, expert2_balance_bottom=0, unused_expert2_count=0, all_to_all_cpu_time_ms=0, all_to_all_cuda_time_ms=0, ppl=1.83, wps=90.5, ups=0.12, wpb=776.6, bsz=64, num_updates=8900, lr=1.0585e-05, gnorm=2.464, loss_scale=16, train_wall=35, cuda_gb_allocated=11.2, cuda_gb_reserved=12, cuda_gb_free=12.5, wall=70125
